---
layout:     post
title:      è„šæœ¬æŸ¥è¯¢åº“åœ°å€
subtitle:   æ ¹æ®Podfileã€Podfile.lockç½—åˆ—åº“åœ°å€
date:       2026-01-01 10:24:07 GMT+0800
author:     920
header-img: 
catalog: true
stickie: false
tags:
    - sh
    - Pod 
---

#### æ³¨æ„

- è„šæœ¬ã€Podfileã€Podfile.lockè¦æ”¾åˆ°åŒä¸€ç›®å½•ä¸‹

#### è„šæœ¬

```sh
#!/bin/bash
# å¼ºåˆ¶è®¾ç½®UTF-8ç¼–ç ï¼Œè§£å†³ä¹±ç é—®é¢˜
export LC_ALL=en_US.UTF-8
LANG=en_US.UTF-8

# æœ€ç»ˆç”Ÿæˆçš„JSONæ–‡ä»¶å
JSON_FILE="pod_info.json"

# å‡½æ•°ï¼šç»ˆæçº¯å‡€æå–Podåï¼ˆæ¯ä¸ªåº“åé¡¶æ ¼å•è¡Œæ˜¾ç¤ºï¼Œæ— å‰ç½®ç©ºæ ¼ã€æ— å†—ä½™å­—ç¬¦ï¼‰
extract_pod_names() {
    local podfile_path="$1"
    # æ­¥éª¤1ï¼šè¿‡æ»¤æœ‰æ•ˆPodè¡Œï¼ˆä»…ä¿ç•™éæ³¨é‡Šè¡Œï¼Œä¸”åŒ…å« pod 'xxx' æˆ– pod "xxx"ï¼‰
    # æ­¥éª¤2ï¼šå½»åº•åˆ é™¤æ‰€æœ‰"pod"å­—ç¬¦ä¸²ï¼ˆæ— è®ºä½ç½®ï¼Œç¡®ä¿æ— æ®‹ç•™ï¼‰
    # æ­¥éª¤3ï¼šæå–å•/åŒå¼•å·å†…çš„æ ¸å¿ƒåº“åï¼ˆæ’é™¤é€—å·ã€æ–œæ ã€ç©ºæ ¼ç­‰å†—ä½™å†…å®¹ï¼‰
    # æ­¥éª¤4ï¼šå¤„ç†å­specï¼ˆå¦‚A/B/Cåªä¿ç•™Aï¼‰
    # æ­¥éª¤5ï¼šå»é‡ã€è¿‡æ»¤ç©ºè¡Œã€è¿‡æ»¤æ®‹ç•™pod
    # æ­¥éª¤6ï¼šæ ¸å¿ƒä¼˜åŒ–ï¼šå‰”é™¤æ¯ä¸ªPodåå‰çš„æ‰€æœ‰å‰ç½®ç©ºæ ¼ï¼Œå®ç°é¡¶æ ¼æ˜¾ç¤º
    grep -E '^[[:space:]]*[^#]*pod\s+['\''"]' "$podfile_path" | \
    sed -E 's/pod//g' | \
    sed -E 's/['\''"]([^'\''",\/[:space:]]+)[^'\''"]*['\''"].*/\1/g' | \
    sed -E 's/\/.*//g' | \
    sort -u | \
    grep -v '^$' | \
    grep -v '^[[:space:]]*$' | \
    grep -v 'pod' | \
    sed -E 's/^[[:space:]]+//g'  # å‰”é™¤æ¯è¡Œå¼€å¤´çš„æ‰€æœ‰å‰ç½®ç©ºæ ¼ï¼Œé¡¶æ ¼æ˜¾ç¤º
}

# å‡½æ•°ï¼šæŸ¥è¯¢å•ä¸ªPodçš„GitHubåœ°å€å’Œå®˜ç½‘åœ°å€ï¼ˆè§£å†³å¡ä½é—®é¢˜ï¼Œå¿«é€Ÿéé˜»å¡ï¼‰
query_pod_info() {
    local pod_name="$1"
    local git_url="æœªæ‰¾åˆ°"
    local homepage="æœªæ‰¾åˆ°"

    # è·³è¿‡ç©ºçš„åº“åæˆ–podå…³é”®å­—ï¼ˆåŒé‡ä¿é™©ï¼‰
    if [ -z "$pod_name" ] || [ "$pod_name" = "pod" ]; then
        echo "$git_url $homepage"
        return 1
    fi

    # æ ¸å¿ƒä¼˜åŒ–ï¼šè§£å†³pod searchå¡ä½é—®é¢˜
    # 1. æ·»åŠ --simpleå‚æ•°ï¼šç®€åŒ–è¾“å‡ºï¼Œå¤§å¹…æå‡æŸ¥è¯¢é€Ÿåº¦ï¼Œé¿å…é˜»å¡
    # 2. ä¸¥æ ¼é™åˆ¶è¾“å‡ºè¡Œæ•°ï¼šhead -n 20ï¼Œé¿å…å†—ä½™å†…å®¹å¤„ç†
    # 3. å½»åº•å±è”½æ‰€æœ‰æ— å…³æŠ¥é”™å’Œäº¤äº’æç¤ºï¼Œåå°æ‰§è¡Œä¸é˜»å¡
    local pod_search_info
    pod_search_info=$(pod search "$pod_name" --simple 2>/dev/null | head -n 20)
    if [ -n "$pod_search_info" ]; then
        # æå–GitHubåœ°å€ï¼ˆåŒ¹é…Source: åé¢çš„å†…å®¹ï¼Œå…¼å®¹é¡¶æ ¼/ç¼©è¿›ï¼‰
        local source_line
        source_line=$(echo "$pod_search_info" | grep -E '^[[:space:]]*- Source:[[:space:]]*' | head -n 1)
        if [ -n "$source_line" ]; then
            git_url=$(echo "$source_line" | sed -E 's/^[[:space:]]*- Source:[[:space:]]*//g')
        fi

        # æå–å®˜ç½‘åœ°å€ï¼ˆåŒ¹é…Homepage: åé¢çš„å†…å®¹ï¼Œå…¼å®¹é¡¶æ ¼/ç¼©è¿›ï¼‰
        local homepage_line
        homepage_line=$(echo "$pod_search_info" | grep -E '^[[:space:]]*- Homepage:[[:space:]]*' | head -n 1)
        if [ -n "$homepage_line" ]; then
            homepage=$(echo "$homepage_line" | sed -E 's/^[[:space:]]*- Homepage:[[:space:]]*//g')
        fi
    fi

    # å¤‡ç”¨æ–¹æ¡ˆï¼šè‹¥pod searchä»å¤±è´¥ï¼Œå°è¯•pod spec catï¼ˆåŒé‡ä¿éšœï¼Œé¿å…å¡ä½ï¼‰
    if [ "$git_url" = "æœªæ‰¾åˆ°" ] && [ "$homepage" = "æœªæ‰¾åˆ°" ]; then
        local pod_spec_info=$(pod spec cat "$pod_name" 2>/dev/null | head -n 50)
        if [ -n "$pod_spec_info" ]; then
            git_url=$(echo "$pod_spec_info" | grep -o '"git": "[^"]*' | sed 's/"git": "//' | head -n 1)
            homepage=$(echo "$pod_spec_info" | grep -o '"homepage": "[^"]*' | sed 's/"homepage": "//' | head -n 1)
            # è¡¥å…¨é»˜è®¤å€¼
            [ -z "$git_url" ] && git_url="æœªæ‰¾åˆ°"
            [ -z "$homepage" ] && homepage="æœªæ‰¾åˆ°"
        fi
    fi

    # è¿”å›ä¸¤ä¸ªåœ°å€ï¼ˆç”¨ç©ºæ ¼åˆ†éš”ï¼Œåç»­æ‹†åˆ†ï¼‰
    echo "$git_url $homepage"
    return 0
}

# å‡½æ•°ï¼šç”Ÿæˆæ ‡å‡†JSONæ–‡ä»¶ï¼ˆå¸¦ç¼©è¿›ï¼Œæ ¼å¼ç¾è§‚ï¼‰
generate_json_file() {
    local pod_names="$1"
    # ç»Ÿè®¡Podæ€»æ•°ï¼ˆæŒ‰è¡Œç»Ÿè®¡ï¼Œç²¾å‡†æ— è¯¯å·®ï¼‰
    local total_pod=$(echo "$pod_names" | wc -l | sed -E 's/^[[:space:]]*//g')
    local current_count=0 # å½“å‰æŸ¥è¯¢è®¡æ•°å™¨

    # 1. åˆå§‹åŒ–JSONå†…å®¹
    local json_content="["
    local first_item=1 # æ ‡è®°ç¬¬ä¸€ä¸ªJSONå…ƒç´ 
    local pod_list=()   # å­˜å‚¨Podååˆ—è¡¨ï¼Œç”¨äºå¾ªç¯

    # å°†åˆ†è¡Œçš„Podåå­˜å…¥æ•°ç»„ï¼ˆå»ç©ºï¼‰
    while read -r pod; do
        if [ -n "$pod" ] && [ "$pod" != "pod" ]; then
            pod_list+=("$pod")
        fi
    done <<< "$pod_names"

    # 2. å¾ªç¯éå†æ¯ä¸ªPodï¼Œæ‹¼æ¥JSONå¯¹è±¡ï¼ˆéé˜»å¡ï¼Œè¿›åº¦æµç•…ï¼‰
    for pod in "${pod_list[@]}"; do
        # æ›´æ–°è®¡æ•°å™¨ï¼Œè¾“å‡ºè¿›åº¦æç¤º
        current_count=$((current_count + 1))
        echo "ğŸ” æ­£åœ¨æŸ¥è¯¢ [$current_count/$total_pod]ï¼š$pod"

        # æŸ¥è¯¢GitHubå’Œå®˜ç½‘åœ°å€ï¼ˆå¿«é€Ÿè¿”å›ï¼Œä¸é˜»å¡ï¼‰
        pod_info=$(query_pod_info "$pod")
        git_url=$(echo "$pod_info" | awk '{print $1;}')
        # å¤„ç†å®˜ç½‘åœ°å€åŒ…å«ç©ºæ ¼çš„æƒ…å†µ
        homepage=$(echo "$pod_info" | awk '{for(i=2;i<=NF;i++) printf "%s ",$i; print ""}' | sed -E 's/ $//g')

        # æ‹¼æ¥JSONå¯¹è±¡
        if [ $first_item -eq 1 ]; then
            json_content="${json_content}"$'\n  {'
            first_item=0
        else
            json_content="${json_content},"$'\n  {'
        fi
        json_content="${json_content}"$'\n    "name": "'"$pod"'",'
        json_content="${json_content}"$'\n    "github": "'"$git_url"'",'
        json_content="${json_content}"$'\n    "site": "'"$homepage"'"'
        json_content="${json_content}"$'\n  }'
    done

    # 3. è¡¥å……JSONç»“å°¾
    json_content="${json_content}"$'\n]'

    # 4. æ ¼å¼åŒ–JSON
    if command -v jq &> /dev/null; then
        echo "$json_content" | jq '.' > "$JSON_FILE"
    else
        echo "$json_content" > "$JSON_FILE"
    fi

    echo -e "\nâœ… JSONæ–‡ä»¶å·²ç”Ÿæˆï¼š$(pwd)/$JSON_FILE"
    return 0
}

# ä¸»ç¨‹åºå…¥å£
main() {
    local podfile_path="Podfile"
    # 1. åˆ¤æ–­Podfileæ˜¯å¦å­˜åœ¨
    if [ ! -f "$podfile_path" ]; then
        echo "âŒ é”™è¯¯ï¼šå½“å‰ç›®å½•æœªæ‰¾åˆ°Podfileæ–‡ä»¶ï¼"
        exit 1
    fi

    # 2. æå–ç»å¯¹çº¯å‡€çš„Podåï¼ˆé¡¶æ ¼å•è¡Œï¼Œæ— å‰ç½®ç©ºæ ¼ï¼‰
    echo "========== å¼€å§‹æå–Podfileä¸­çš„ä¸‰æ–¹åº“ =========="
    local pod_names=$(extract_pod_names "$podfile_path")
    if [ -z "$pod_names" ]; then
        echo "â„¹ï¸  æç¤ºï¼šæœªæå–åˆ°æœ‰æ•ˆä¸‰æ–¹åº“ï¼Œè¯·æ£€æŸ¥Podfileé…ç½®ï¼"
        exit 0
    fi
    local total_pod=$(echo "$pod_names" | wc -l | sed -E 's/^[[:space:]]*//g')
    echo "âœ… æå–å®Œæˆï¼Œå…±æ‰¾åˆ° $total_pod ä¸ªçº¯å‡€ä¸‰æ–¹åº“ï¼š"
    # é¡¶æ ¼å•è¡Œæ‰“å°Podåï¼Œæ’ç‰ˆæ•´æ´
    echo "$pod_names"
    echo -e "\n========== å¼€å§‹æŸ¥è¯¢åœ°å€å¹¶ç”ŸæˆJSONæ–‡ä»¶ ==========\n"

    # 3. ç”ŸæˆJSONæ–‡ä»¶ï¼ˆå¿«é€Ÿéé˜»å¡ï¼‰
    generate_json_file "$pod_names"

    echo -e "\n========== æ‰€æœ‰æ“ä½œæ‰§è¡Œå®Œæˆ =========="
}

# æ‰§è¡Œä¸»ç¨‹åº
main
```


#### æ—¥å¿—
```sh
~/Desktop/play_pod/pod2 % chmod +x pod_query_url.sh
~/Desktop/play_pod/pod2 % ./pod_query_url.sh       
========== å¼€å§‹æå–Podfileä¸­çš„ä¸‰æ–¹åº“ ==========
âœ… æå–å®Œæˆï¼Œå…±æ‰¾åˆ° 29 ä¸ªçº¯å‡€ä¸‰æ–¹åº“ï¼š
AFNetworking
AliPay
AWSS3
Bugly
CWStatusBarNotification
DZNEmptyDataSet
HPGrowingTextView
IQKeyboardManager
JKCategories
lottie-ios
Masonry
MBProgressHUD
MJRefresh
mob_sharesdk
OpenSSL-for-iOS
PayPalCheckout
Qiniu
SDCycleScrollView
SDWebImage
SharetraceSDK
Socket.IO-Client-Swift
SVGAPlayer
TXIMSDK_Plus_iOS
TXLiteAVSDK_Live
TXLiteAVSDK_Professional
TZImagePickerController
YYText
YYWebImage
ZFPlayer

========== å¼€å§‹æŸ¥è¯¢åœ°å€å¹¶ç”ŸæˆJSONæ–‡ä»¶ ==========

ğŸ” æ­£åœ¨æŸ¥è¯¢ [1/29]ï¼šAFNetworking
ğŸ” æ­£åœ¨æŸ¥è¯¢ [2/29]ï¼šAliPay
ğŸ” æ­£åœ¨æŸ¥è¯¢ [3/29]ï¼šAWSS3
ğŸ” æ­£åœ¨æŸ¥è¯¢ [4/29]ï¼šBugly
ğŸ” æ­£åœ¨æŸ¥è¯¢ [5/29]ï¼šCWStatusBarNotification
ğŸ” æ­£åœ¨æŸ¥è¯¢ [6/29]ï¼šDZNEmptyDataSet
ğŸ” æ­£åœ¨æŸ¥è¯¢ [7/29]ï¼šHPGrowingTextView
ğŸ” æ­£åœ¨æŸ¥è¯¢ [8/29]ï¼šIQKeyboardManager
ğŸ” æ­£åœ¨æŸ¥è¯¢ [9/29]ï¼šJKCategories
ğŸ” æ­£åœ¨æŸ¥è¯¢ [10/29]ï¼šlottie-ios
ğŸ” æ­£åœ¨æŸ¥è¯¢ [11/29]ï¼šMasonry
ğŸ” æ­£åœ¨æŸ¥è¯¢ [12/29]ï¼šMBProgressHUD
ğŸ” æ­£åœ¨æŸ¥è¯¢ [13/29]ï¼šMJRefresh
ğŸ” æ­£åœ¨æŸ¥è¯¢ [14/29]ï¼šmob_sharesdk
ğŸ” æ­£åœ¨æŸ¥è¯¢ [15/29]ï¼šOpenSSL-for-iOS
ğŸ” æ­£åœ¨æŸ¥è¯¢ [16/29]ï¼šPayPalCheckout
ğŸ” æ­£åœ¨æŸ¥è¯¢ [17/29]ï¼šQiniu
ğŸ” æ­£åœ¨æŸ¥è¯¢ [18/29]ï¼šSDCycleScrollView
ğŸ” æ­£åœ¨æŸ¥è¯¢ [19/29]ï¼šSDWebImage
ğŸ” æ­£åœ¨æŸ¥è¯¢ [20/29]ï¼šSharetraceSDK
ğŸ” æ­£åœ¨æŸ¥è¯¢ [21/29]ï¼šSocket.IO-Client-Swift
ğŸ” æ­£åœ¨æŸ¥è¯¢ [22/29]ï¼šSVGAPlayer
ğŸ” æ­£åœ¨æŸ¥è¯¢ [23/29]ï¼šTXIMSDK_Plus_iOS
ğŸ” æ­£åœ¨æŸ¥è¯¢ [24/29]ï¼šTXLiteAVSDK_Live
ğŸ” æ­£åœ¨æŸ¥è¯¢ [25/29]ï¼šTXLiteAVSDK_Professional
ğŸ” æ­£åœ¨æŸ¥è¯¢ [26/29]ï¼šTZImagePickerController
ğŸ” æ­£åœ¨æŸ¥è¯¢ [27/29]ï¼šYYText
ğŸ” æ­£åœ¨æŸ¥è¯¢ [28/29]ï¼šYYWebImage
ğŸ” æ­£åœ¨æŸ¥è¯¢ [29/29]ï¼šZFPlayer

âœ… JSONæ–‡ä»¶å·²ç”Ÿæˆï¼š/Users/yunbao02/Desktop/play_pod/pod2/pod_info.json

========== æ‰€æœ‰æ“ä½œæ‰§è¡Œå®Œæˆ ==========
```

##### æµ‹è¯•è¿‡ç¨‹ï¼šä¸ªåˆ«æ‰¾ä¸åˆ°
```sh
#!/bin/bash
# å¼ºåˆ¶è®¾ç½®UTF-8ç¼–ç ï¼Œè§£å†³ä¹±ç é—®é¢˜
export LC_ALL=en_US.UTF-8
LANG=en_US.UTF-8

# æœ€ç»ˆç”Ÿæˆçš„JSONæ–‡ä»¶å
JSON_FILE="pod_info.json"

# å‡½æ•°ï¼šç»ˆæçº¯å‡€æå–Podåï¼ˆå½»åº•å‰”é™¤podå…³é”®å­—ã€å¼•å·ã€ç‰ˆæœ¬å·ã€å­specã€æ³¨é‡Šã€ç©ºè¡Œï¼‰
extract_pod_names() {
    local podfile_path="$1"
    # æ­¥éª¤1ï¼šè¿‡æ»¤æœ‰æ•ˆPodè¡Œï¼ˆä»…ä¿ç•™éæ³¨é‡Šè¡Œï¼Œä¸”åŒ…å« pod 'xxx' æˆ– pod "xxx"ï¼‰
    # æ­¥éª¤2ï¼šå½»åº•åˆ é™¤æ‰€æœ‰"pod"å­—ç¬¦ä¸²ï¼ˆæ— è®ºä½ç½®ï¼Œç¡®ä¿æ— æ®‹ç•™ï¼‰
    # æ­¥éª¤3ï¼šæå–å•/åŒå¼•å·å†…çš„æ ¸å¿ƒåº“åï¼ˆæ’é™¤é€—å·ã€æ–œæ ã€ç©ºæ ¼ç­‰å†—ä½™å†…å®¹ï¼‰
    # æ­¥éª¤4ï¼šå¤„ç†å­specï¼ˆå¦‚A/B/Cåªä¿ç•™Aï¼‰
    # æ­¥éª¤5ï¼šå»é‡ã€è¿‡æ»¤ç©ºè¡Œã€è¿‡æ»¤çº¯ç‰¹æ®Šå­—ç¬¦è¡Œã€è¿‡æ»¤æ®‹ç•™pod
    grep -E '^[[:space:]]*[^#]*pod\s+['\''"]' "$podfile_path" | \
    sed -E 's/pod//g' | \
    sed -E 's/['\''"]([^'\''",\/[:space:]]+)[^'\''"]*['\''"].*/\1/g' | \
    sed -E 's/\/.*//g' | \
    sort -u | \
    grep -v '^$' | \
    grep -v '^[[:space:]]*$' | \
    grep -v 'pod'
}

# å‡½æ•°ï¼šæŸ¥è¯¢å•ä¸ªPodçš„GitHubåœ°å€å’Œå®˜ç½‘åœ°å€ï¼ˆè¿”å›ä¸¤ä¸ªå€¼ï¼šgithubåœ°å€ å®˜ç½‘åœ°å€ï¼‰
query_pod_info() {
    local pod_name="$1"
    local git_url=""
    local homepage=""

    # è·³è¿‡ç©ºçš„åº“åæˆ–podå…³é”®å­—ï¼ˆåŒé‡ä¿é™©ï¼‰
    if [ -z "$pod_name" ] || [ "$pod_name" = "pod" ]; then
        echo "$git_url $homepage"
        return 1
    fi

    # ç”¨pod spec catè·å–Podå®Œæ•´ä¿¡æ¯ï¼ˆä¼˜å…ˆæœ¬åœ°ç¼“å­˜ï¼Œæ— ç½‘ç»œä¹Ÿå¯æŸ¥ï¼‰
    local pod_spec_info=$(pod spec cat "$pod_name" 2>/dev/null)
    if [ -n "$pod_spec_info" ]; then
        # ç²¾å‡†æå–GitHubåœ°å€ï¼ˆåªå–ç¬¬ä¸€ä¸ªæœ‰æ•ˆåœ°å€ï¼‰
        git_url=$(echo "$pod_spec_info" | grep -o '"git": "[^"]*' | sed 's/"git": "//' | head -n 1)
        # ç²¾å‡†æå–å®˜ç½‘åœ°å€ï¼ˆåªå–ç¬¬ä¸€ä¸ªæœ‰æ•ˆåœ°å€ï¼‰
        homepage=$(echo "$pod_spec_info" | grep -o '"homepage": "[^"]*' | sed 's/"homepage": "//' | head -n 1)
    fi

    # è‹¥æœªæå–åˆ°ï¼Œèµ‹å€¼ä¸º"æœªæ‰¾åˆ°"
    [ -z "$git_url" ] && git_url="æœªæ‰¾åˆ°"
    [ -z "$homepage" ] && homepage="æœªæ‰¾åˆ°"

    # è¿”å›ä¸¤ä¸ªåœ°å€ï¼ˆç”¨ç©ºæ ¼åˆ†éš”ï¼Œåç»­æ‹†åˆ†ï¼‰
    echo "$git_url $homepage"
    return 0
}

# å‡½æ•°ï¼šç”Ÿæˆæ ‡å‡†JSONæ–‡ä»¶ï¼ˆå¸¦ç¼©è¿›ï¼Œæ ¼å¼ç¾è§‚ï¼‰
generate_json_file() {
    local pod_names="$1"
    # 1. åˆå§‹åŒ–JSONå†…å®¹ï¼ˆå¼€å¤´æ•°ç»„ç¬¦å·ï¼Œåç»­æ‹¼æ¥å…ƒç´ ï¼‰
    local json_content="["
    local first_item=1 # æ ‡è®°æ˜¯å¦æ˜¯ç¬¬ä¸€ä¸ªJSONå…ƒç´ ï¼Œç”¨äºå¤„ç†é€—å·

    # 2. å¾ªç¯éå†æ¯ä¸ªPodï¼Œæ‹¼æ¥JSONå¯¹è±¡
    for pod in $pod_names; do
        # è·³è¿‡æ— æ•ˆåº“å
        if [ -z "$pod" ] || [ "$pod" = "pod" ]; then
            continue
        fi

        # æŸ¥è¯¢GitHubå’Œå®˜ç½‘åœ°å€
        pod_info=$(query_pod_info "$pod")
        git_url=$(echo "$pod_info" | awk '{print $1;}')
        # å¤„ç†å®˜ç½‘åœ°å€åŒ…å«ç©ºæ ¼çš„æƒ…å†µï¼ˆawkå–ä»ç¬¬2åˆ—å¼€å§‹çš„æ‰€æœ‰å†…å®¹ï¼‰
        homepage=$(echo "$pod_info" | awk '{for(i=2;i<=NF;i++) printf "%s ",$i; print ""}' | sed -E 's/ $//g')

        # æ‹¼æ¥JSONå¯¹è±¡ï¼ˆå¸¦ç¼©è¿›ï¼Œç¬¦åˆå®¡ç¾ï¼‰
        if [ $first_item -eq 1 ]; then
            # ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå‰é¢ä¸åŠ é€—å·
            json_content="${json_content}"$'\n  {'
            first_item=0
        else
            # éç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå‰é¢åŠ é€—å·
            json_content="${json_content},"$'\n  {'
        fi
        json_content="${json_content}"$'\n    "name": "'"$pod"'",'
        json_content="${json_content}"$'\n    "github": "'"$git_url"'",'
        json_content="${json_content}"$'\n    "site": "'"$homepage"'"'
        json_content="${json_content}"$'\n  }'
    done

    # 3. è¡¥å……JSONç»“å°¾ï¼Œå®Œæˆæ•°ç»„æ‹¼æ¥
    json_content="${json_content}"$'\n]'

    # 4. æ ¼å¼åŒ–JSONï¼ˆä¼˜å…ˆç”¨jqå·¥å…·ï¼Œæ— jqåˆ™ç›´æ¥å†™å…¥ï¼Œä¿è¯æ ¼å¼åŸºæœ¬ç¾è§‚ï¼‰
    if command -v jq &> /dev/null; then
        # ç”¨jqæ ¼å¼åŒ–ï¼Œç¼©è¿›2ä¸ªç©ºæ ¼ï¼Œæ›´ç¾è§‚
        echo "$json_content" | jq '.' > "$JSON_FILE"
    else
        # æ— jqï¼Œç›´æ¥å†™å…¥ç¼©è¿›åçš„å†…å®¹ï¼Œæ ¼å¼ä»åˆè§„
        echo "$json_content" > "$JSON_FILE"
    fi

    echo "JSONæ–‡ä»¶å·²ç”Ÿæˆï¼š$(pwd)/$JSON_FILE"
    return 0
}

# ä¸»ç¨‹åºå…¥å£
main() {
    local podfile_path="Podfile"
    # 1. åˆ¤æ–­Podfileæ˜¯å¦å­˜åœ¨
    if [ ! -f "$podfile_path" ]; then
        echo "é”™è¯¯ï¼šå½“å‰ç›®å½•æœªæ‰¾åˆ°Podfileæ–‡ä»¶ï¼"
        exit 1
    fi

    # 2. æå–ç»å¯¹çº¯å‡€çš„Podå
    echo "========== æ­£åœ¨æå–Podfileä¸­çš„ä¸‰æ–¹åº“ =========="
    local pod_names=$(extract_pod_names "$podfile_path")
    if [ -z "$pod_names" ]; then
        echo "æç¤ºï¼šæœªæå–åˆ°æœ‰æ•ˆä¸‰æ–¹åº“ï¼Œè¯·æ£€æŸ¥Podfileé…ç½®ï¼"
        exit 0
    fi
    echo "æå–åˆ°çš„çº¯å‡€ä¸‰æ–¹åº“ï¼š$pod_names"
    echo -e "\n========== å¼€å§‹æŸ¥è¯¢åœ°å€å¹¶ç”ŸæˆJSONæ–‡ä»¶ ==========\n"

    # 3. ç”ŸæˆJSONæ–‡ä»¶
    generate_json_file "$pod_names"

    echo -e "\n========== æ“ä½œå®Œæˆ =========="
}

# æ‰§è¡Œä¸»ç¨‹åº
main
```

##### æµ‹è¯•è¿‡ç¨‹ï¼šç›´æ¥å‘½ä»¤è¡Œè¾“å‡º

```sh
#!/bin/bash
# å¼ºåˆ¶è®¾ç½®UTF-8ç¼–ç ï¼Œè§£å†³ä¹±ç é—®é¢˜
export LC_ALL=en_US.UTF-8
LANG=en_US.UTF-8

# å‡½æ•°ï¼šç»ˆæçº¯å‡€æå–Podåï¼ˆå½»åº•å‰”é™¤podå…³é”®å­—ã€å¼•å·ã€ç‰ˆæœ¬å·ã€å­specã€æ³¨é‡Šã€ç©ºè¡Œï¼‰
extract_pod_names() {
    local podfile_path="$1"
    # æ­¥éª¤1ï¼šè¿‡æ»¤æœ‰æ•ˆPodè¡Œï¼ˆä»…ä¿ç•™éæ³¨é‡Šè¡Œï¼Œä¸”åŒ…å« pod 'xxx' æˆ– pod "xxx"ï¼‰
    # æ­¥éª¤2ï¼šå½»åº•åˆ é™¤æ‰€æœ‰"pod"å­—ç¬¦ä¸²ï¼ˆæ— è®ºä½ç½®ï¼Œç¡®ä¿æ— æ®‹ç•™ï¼‰
    # æ­¥éª¤3ï¼šæå–å•/åŒå¼•å·å†…çš„æ ¸å¿ƒåº“åï¼ˆæ’é™¤é€—å·ã€æ–œæ ã€ç©ºæ ¼ç­‰å†—ä½™å†…å®¹ï¼‰
    # æ­¥éª¤4ï¼šå¤„ç†å­specï¼ˆå¦‚A/B/Cåªä¿ç•™Aï¼‰
    # æ­¥éª¤5ï¼šå»é‡ã€è¿‡æ»¤ç©ºè¡Œã€è¿‡æ»¤çº¯ç‰¹æ®Šå­—ç¬¦è¡Œ
    # æ­¥éª¤6ï¼šæœ€ç»ˆè¿‡æ»¤æ‰å¯èƒ½æ®‹ç•™çš„"pod"ï¼ˆåŒé‡ä¿é™©ï¼‰
    grep -E '^[[:space:]]*[^#]*pod\s+['\''"]' "$podfile_path" | \
    sed -E 's/pod//g' | \
    sed -E 's/['\''"]([^'\''",\/[:space:]]+)[^'\''"]*['\''"].*/\1/g' | \
    sed -E 's/\/.*//g' | \
    sort -u | \
    grep -v '^$' | \
    grep -v '^[[:space:]]*$' | \
    grep -v 'pod'
}

# å‡½æ•°ï¼šæŸ¥è¯¢å•ä¸ªPodçš„GitHubåœ°å€å’Œå®˜æ–¹æ–‡æ¡£åœ°å€
query_pod_info() {
    local pod_name="$1"
    # è·³è¿‡ç©ºçš„åº“åï¼ˆåŒé‡ä¿é™©ï¼‰
    if [ -z "$pod_name" ] || [ "$pod_name" = "pod" ]; then
        return 1
    fi

    # ç”¨pod spec catè·å–Podå®Œæ•´ä¿¡æ¯ï¼ˆä¼˜å…ˆæœ¬åœ°ç¼“å­˜ï¼Œæ— ç½‘ç»œä¹Ÿå¯æŸ¥ï¼‰
    local pod_spec_info=$(pod spec cat "$pod_name" 2>/dev/null)
    if [ -z "$pod_spec_info" ]; then
        echo "  GitHubåœ°å€ï¼šæœªæ‰¾åˆ°ï¼ˆç§æœ‰Pod/éå…¬å¼€Podï¼‰"
        echo "  å®˜æ–¹æ–‡æ¡£ï¼šæœªæ‰¾åˆ°ï¼ˆç§æœ‰Pod/éå…¬å¼€Podï¼‰"
        return 1
    fi

    # ç²¾å‡†æå–GitHubåœ°å€ï¼ˆåªå–ç¬¬ä¸€ä¸ªæœ‰æ•ˆåœ°å€ï¼‰
    local git_url=$(echo "$pod_spec_info" | grep -o '"git": "[^"]*' | sed 's/"git": "//' | head -n 1)
    # ç²¾å‡†æå–å®˜æ–¹æ–‡æ¡£åœ°å€ï¼ˆåªå–ç¬¬ä¸€ä¸ªæœ‰æ•ˆåœ°å€ï¼‰
    local homepage=$(echo "$pod_spec_info" | grep -o '"homepage": "[^"]*' | sed 's/"homepage": "//' | head -n 1)

    # è¾“å‡ºç»“æœ
    if [ -z "$git_url" ]; then
        echo "  GitHubåœ°å€ï¼šæœªå…¬å¼€"
    else
        echo "  GitHubåœ°å€ï¼š$git_url"
    fi

    if [ -z "$homepage" ]; then
        echo "  å®˜æ–¹æ–‡æ¡£ï¼šæœªå…¬å¼€"
    else
        echo "  å®˜æ–¹æ–‡æ¡£ï¼š$homepage"
    fi
    return 0
}

# ä¸»ç¨‹åºå…¥å£
main() {
    local podfile_path="Podfile"
    # 1. åˆ¤æ–­Podfileæ˜¯å¦å­˜åœ¨
    if [ ! -f "$podfile_path" ]; then
        echo "é”™è¯¯ï¼šå½“å‰ç›®å½•æœªæ‰¾åˆ°Podfileæ–‡ä»¶ï¼"
        exit 1
    fi

    # 2. æå–ç»å¯¹çº¯å‡€çš„Podå
    echo "========== æ­£åœ¨æå–Podfileä¸­çš„ä¸‰æ–¹åº“ =========="
    local pod_names=$(extract_pod_names "$podfile_path")
    if [ -z "$pod_names" ]; then
        echo "æç¤ºï¼šæœªæå–åˆ°æœ‰æ•ˆä¸‰æ–¹åº“ï¼Œè¯·æ£€æŸ¥Podfileé…ç½®ï¼"
        exit 0
    fi
    echo "æå–åˆ°çš„çº¯å‡€ä¸‰æ–¹åº“ï¼š$pod_names"
    echo -e "\n========== å¼€å§‹æŸ¥è¯¢GitHub/å®˜æ–¹æ–‡æ¡£åœ°å€ ==========\n"

    # 3. å¾ªç¯æŸ¥è¯¢æ¯ä¸ªçº¯å‡€Podçš„ä¿¡æ¯ï¼ˆè·³è¿‡æ— æ•ˆåç§°ï¼‰
    for pod in $pod_names; do
        # è·³è¿‡podå…³é”®å­—å’Œç©ºåç§°ï¼ˆæœ€ç»ˆä¿é™©ï¼‰
        if [ "$pod" = "pod" ] || [ -z "$pod" ]; then
            continue
        fi
        echo "åº“åï¼š$pod"
        query_pod_info "$pod"
        echo "--------------------------------------------------"
    done

    echo "========== æŸ¥è¯¢å®Œæˆ =========="
}

# æ‰§è¡Œä¸»ç¨‹åº
main
```



