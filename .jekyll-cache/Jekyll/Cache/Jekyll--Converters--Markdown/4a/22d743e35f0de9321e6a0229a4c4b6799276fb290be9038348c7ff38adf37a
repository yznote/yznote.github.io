I"Ò<h4 id="å–æ²™ç›’æ—¥å¿—çš„æ–¹æ³•">å–æ²™ç›’æ—¥å¿—çš„æ–¹æ³•</h4>

<p>1.æ‰‹æœºè¿æ¥<code class="language-plaintext highlighter-rouge">Mac</code>ç”µè„‘ï¼Œæ‰“å¼€<code class="language-plaintext highlighter-rouge">Xcode</code>ã€‚</p>

<p>2.é€‰æ‹©é¡¶æ çš„ <code class="language-plaintext highlighter-rouge">Windows</code> ä¸‹çš„ <code class="language-plaintext highlighter-rouge">Devices</code>ã€‚</p>

<p>3.åœ¨ <code class="language-plaintext highlighter-rouge">Devices</code> æ ä¸‹å…ˆé€‰æ‹©å½“å‰è¿æ¥çš„æ‰‹æœºè®¾å¤‡ã€‚</p>

<p>4.åœ¨ <code class="language-plaintext highlighter-rouge">Installed Apps</code> æ ä¸‹é€‰æ‹©ä½ å¼€å‘çš„<code class="language-plaintext highlighter-rouge">Appï¼ˆéœ€è¦å–æ²™ç›’æ–‡ä»¶çš„Appï¼‰</code>ã€‚</p>

<p>5.ç‚¹å‡»åº•éƒ¨ <code class="language-plaintext highlighter-rouge">é½¿è½®å›¾æ¡ˆ</code> çš„æŒ‰é’®ï¼Œé€‰æ‹© <code class="language-plaintext highlighter-rouge">Download Containerâ€¦</code></p>

<h4 id="å°†è¾“å‡ºæ—¥å¿—nslogå†™å…¥æ²™ç›’æ–‡ä»¶">å°†è¾“å‡ºæ—¥å¿—(NSLog)å†™å…¥æ²™ç›’æ–‡ä»¶</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#pragma mark - è‡ªå®šä¹‰æ–¹æ³•,å°†nslogçš„è¾“å‡ºä¿¡æ¯å†™å…¥åˆ°NSLog.txtæ–‡ä»¶ä¸­
</span><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">nslogToFile</span> <span class="p">{</span>
    <span class="n">NSArray</span> <span class="o">*</span><span class="n">paths</span> <span class="o">=</span> <span class="n">NSSearchPathForDirectoriesInDomains</span><span class="p">(</span><span class="n">NSDocumentDirectory</span><span class="p">,</span> <span class="n">NSUserDomainMask</span><span class="p">,</span> <span class="nb">YES</span><span class="p">);</span>
    
    <span class="n">NSString</span> <span class="o">*</span><span class="n">documentDirectory</span> <span class="o">=</span> <span class="p">[</span><span class="n">paths</span> <span class="nf">objectAtIndex</span><span class="p">:</span><span class="mi">0</span><span class="p">];</span>
    <span class="n">NSString</span> <span class="o">*</span><span class="n">fileName</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="s">@"NSLog.txt"</span><span class="p">];</span><span class="c1">// æ³¨æ„ä¸æ˜¯NSData!</span>
    
    <span class="n">NSString</span> <span class="o">*</span><span class="n">logFilePath</span> <span class="o">=</span> <span class="p">[</span><span class="n">documentDirectory</span> <span class="nf">stringByAppendingPathComponent</span><span class="p">:</span><span class="n">fileName</span><span class="p">];</span>
    <span class="c1">// å…ˆåˆ é™¤å·²ç»å­˜åœ¨çš„æ–‡ä»¶</span>
    <span class="n">NSFileManager</span> <span class="o">*</span><span class="n">defaultManager</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSFileManager</span> <span class="nf">defaultManager</span><span class="p">];</span>
    <span class="p">[</span><span class="n">defaultManager</span> <span class="nf">removeItemAtPath</span><span class="p">:</span><span class="n">logFilePath</span> <span class="nf">error</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
    
    <span class="c1">// å°†logè¾“å…¥åˆ°æ–‡ä»¶</span>
    <span class="n">freopen</span><span class="p">([</span><span class="n">logFilePath</span> <span class="nf">cStringUsingEncoding</span><span class="p">:</span><span class="n">NSASCIIStringEncoding</span><span class="p">],</span> <span class="s">"a+"</span><span class="p">,</span> <span class="n">stdout</span><span class="p">);</span>
    
    <span class="n">freopen</span><span class="p">([</span><span class="n">logFilePath</span> <span class="nf">cStringUsingEncoding</span><span class="p">:</span><span class="n">NSASCIIStringEncoding</span><span class="p">],</span> <span class="s">"a+"</span><span class="p">,</span> <span class="n">stderr</span><span class="p">);</span>
    
<span class="p">}</span>
</code></pre></div></div>

<h4 id="è¡¥å……2021-8-4-log-å†™å…¥æ–‡ä»¶æ­¤æ–¹å¼æ§åˆ¶å°æ‰“å°æ§åˆ¶å°è¾“å‡º">è¡¥å……[2021-8-4] <code class="language-plaintext highlighter-rouge">Log</code> å†™å…¥æ–‡ä»¶ã€æ­¤æ–¹å¼æ§åˆ¶å°æ‰“å°+æ§åˆ¶å°è¾“å‡ºã€‘</h4>

<p>ä¸Šè¿°<code class="language-plaintext highlighter-rouge">nslogToFile</code>è°ƒç”¨å,æ§åˆ¶å°å°†ä¸èƒ½æ‰“å°ç›¸å…³æ—¥å¿—:</p>

<p><strong>æ³¨æ„å¼•å…¥å¤´æ–‡ä»¶</strong> <code class="language-plaintext highlighter-rouge">#import &lt;sys/time.h&gt;</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
+(void)writeToFile:(NSString *)name andInfo:(id )info {
    RKWriteToFile(name, info);
}

void RKWriteToFile(NSString *name, NSString *format, ...) {
    va_list L;
    va_start(L, format);
    NSString *message = [[NSString alloc] initWithFormat:format arguments:L];
    message = [name stringByAppendingFormat:@" =&gt; %@",message];
    NSLog(@"%@", message);
    // å¼€å¯å¼‚æ­¥å­çº¿ç¨‹ï¼Œå°†æ‰“å°å†™å…¥æ–‡ä»¶
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        NSFileHandle *output = RKLogFileHandle();
        if (output != nil) {
            time_t rawtime;
            struct tm timeinfo;
            char buffer[64];
            time(&amp;rawtime);
            localtime_r(&amp;rawtime, &amp;timeinfo);
            struct timeval curTime;
            gettimeofday(&amp;curTime, NULL);
            int milliseconds = curTime.tv_usec / 1000;
            strftime(buffer, 64, "%Y-%m-%d %H:%M", &amp;timeinfo);
            char fullBuffer[128] = { 0 };
            snprintf(fullBuffer, 128, "%s:%2d.%.3d ", buffer, timeinfo.tm_sec, milliseconds);
            [output writeData:[[[NSString alloc] initWithCString:fullBuffer encoding:NSASCIIStringEncoding] dataUsingEncoding:NSUTF8StringEncoding]];
            [output writeData:[message dataUsingEncoding:NSUTF8StringEncoding]];
            static NSData *returnData = nil;
            if (returnData == nil)
                returnData = [@"\n" dataUsingEncoding:NSUTF8StringEncoding];
            [output writeData:returnData];
        }
    });
    va_end(L);
}
static NSFileHandle *RKLogFileHandle(){
    static NSFileHandle *fileHandle = nil;
    static dispatch_once_t onceToken;
    dispatch_once(&amp;onceToken, ^{
        NSFileManager *fileManager = [[NSFileManager alloc] init];
        
        NSString *documentsDirectory = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];;
        NSString *currentFilePath = [documentsDirectory stringByAppendingPathComponent:@"application-0.log"];
        NSString *oldestFilePath = [documentsDirectory stringByAppendingPathComponent:@"application-60.log"];
        
        //60æ–‡ä»¶å­˜åœ¨ï¼Œåˆ é™¤
        if ([fileManager fileExistsAtPath:oldestFilePath]){
            [fileManager removeItemAtPath:oldestFilePath error:nil];
        }
        //éå†æ–‡ä»¶ï¼Œå°†æ–‡ä»¶ç¼–å·å¾€åç§»åŠ¨ï¼Œæ–°å¢ç¬¬0çš„ä¸€ä¸ªæ–‡ä»¶
        for (int i = 60 - 1; i &gt;= 0; i--) {
            NSString *filePath = [documentsDirectory stringByAppendingPathComponent:[NSString stringWithFormat:@"application-%d.log", i]];
            NSString *nextFilePath = [documentsDirectory stringByAppendingPathComponent:[NSString stringWithFormat:@"application-%d.log", i + 1]];
            if ([fileManager fileExistsAtPath:filePath]) {
                [fileManager moveItemAtPath:filePath toPath:nextFilePath error:nil];
            }
        }
        [fileManager createFileAtPath:currentFilePath contents:nil attributes:nil];
        fileHandle = [NSFileHandle fileHandleForWritingAtPath:currentFilePath];
        [fileHandle truncateFileAtOffset:0];
    });
    return fileHandle;
}
</code></pre></div></div>

:ET