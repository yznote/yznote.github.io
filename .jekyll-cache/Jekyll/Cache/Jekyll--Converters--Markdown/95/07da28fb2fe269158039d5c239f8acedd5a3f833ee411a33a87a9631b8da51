I"‹W<p>æœ€è¿‘åœ¨åšä¸€ä¸ªappï¼Œå†…å®¹ä¸»è¦æ˜¯ ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">table view</code> çš„ <code class="language-plaintext highlighter-rouge">cell</code> ä¸­æœ‰ä¸€å¼ å®½åº¦ä¸€å®šé«˜åº¦ä¸ä¸€å®šçš„å›¾ç‰‡å’Œä¸ä¸€æ ·é«˜åº¦çš„æ–‡å­—ã€‚æ¯æ¬¡ä»æœåŠ¡å™¨æ¥¼æ•°æ®ä¼šè¿”å›å›¾ç‰‡çš„ <code class="language-plaintext highlighter-rouge">URL</code> åœ°å€å’Œæ–‡å­—ç­‰å†…å®¹ï¼Œä½†åªæœ‰å›¾ç‰‡ä¸‹è½½å®Œæˆåæ‰èƒ½çŸ¥é“å›¾ç‰‡çš„å¤§å°ã€‚æ–‡å­—å¯ä»¥é€šè¿‡ä¸€äº› <code class="language-plaintext highlighter-rouge">API</code> è®¡ç®—å›ºå®šå®½åº¦åçš„é«˜åº¦ï¼Œä½†æ˜¯å›¾ç‰‡åœ¨ä¸ä¸‹è½½å®Œæˆåæ˜¯ä¸çŸ¥é“å›¾ç‰‡çš„å®½é«˜çš„ã€‚æˆ‘ä»¬â€œå¾ˆç¡¬â€çš„åå°æ²¡æœ‰æä¾›ç›¸å…³çš„æ¥å£ã€‚å› ä¸ºé¡¹ç›®æ¯”è¾ƒç´§ï¼Œä¸¤ä¸ªæ˜ŸæœŸå®Œæˆä¸€ä¸ª APPâ€¦</p>

<p>å¥½äº†è¨€å½’æ­£ä¼ ï¼Œäº¤ä»£äº†èƒŒæ™¯ï¼Œå†ä»‹ç»ä¸‹æˆ‘é‡åˆ°çš„é—®é¢˜ï¼š <br />
1ã€åœ¨ä¸çŸ¥é“å›¾ç‰‡å®½é«˜çš„æƒ…å†µä¸‹å¦‚ä½•åŠ¨æ€é€‚é… <code class="language-plaintext highlighter-rouge">cell</code> ä¸­çš„é«˜åº¦ã€‚ <br />
2ã€åœ¨æˆ‘é‡å†™ <code class="language-plaintext highlighter-rouge">cell</code> æ—¶å› ä¸ºåœ¨ <code class="language-plaintext highlighter-rouge">cell</code> åº•éƒ¨æœ‰å¯ä»¥ç‚¹å‡»çš„<code class="language-plaintext highlighter-rouge">button</code>ï¼Œä½†æ˜¯çªç„¶åœ¨æŸä¸€å¤©æ— æ³•ç‚¹å‡»äº†ï¼Œæ‰¾äº†åŠå¤©ä¹Ÿæ²¡æœ‰æ‰¾åˆ°åŸå› ã€‚</p>

<p>å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œé¦–å…ˆå…ˆä»‹ç»ä¸‹ <code class="language-plaintext highlighter-rouge">Table view</code> çš„åŠ è½½æµç¨‹ï¼Œä¸»è¦çš„å°± 3 æ­¥ï¼š 
1ã€é€šè¿‡ä»£ç†è·å¾—ä¸€å…±æœ‰å¤šå°‘ä¸ª <code class="language-plaintext highlighter-rouge">cell</code> <br />
2ã€é€šè¿‡ä»£ç†è·å¾—æ¯ä¸ª <code class="language-plaintext highlighter-rouge">cell</code> çš„é«˜åº¦<br />
3ã€é€šè¿‡ä»£ç†å¡«å……å½“å‰æ˜¾ç¤ºçš„ <code class="language-plaintext highlighter-rouge">cell</code> ä¸­çš„å†…å®¹ã€‚<code class="language-plaintext highlighter-rouge">table view</code> ä¼šåœ¨ <code class="language-plaintext highlighter-rouge">layoutSubviews</code> ä¸­åšè¿™ä¸‰ä»¶äº‹ï¼Œè€Œ <code class="language-plaintext highlighter-rouge">layoutSubviews</code> æ–¹æ³•é™¤äº†åœ¨ <code class="language-plaintext highlighter-rouge">frame</code> æ”¹å˜åè°ƒç”¨è¿˜ä¼šåœ¨ <code class="language-plaintext highlighter-rouge">scroll view</code> æ»šåŠ¨æ—¶è°ƒç”¨ï¼Œ æ¯æ¬¡æ»šåŠ¨æ—¶ !</p>

<p>ä¸€å¼€å§‹çš„åšæ³•æ¯”è¾ƒç³™ï¼Œç›´æ¥ç”¨ <code class="language-plaintext highlighter-rouge">SDWebImage</code> çš„å¼‚æ­¥åŠ è½½å›¾ç‰‡çš„æ–¹æ³•ï¼Œåœ¨å›¾ç‰‡åŠ è½½å®Œåå›¾ç‰‡çš„é«˜åº¦å˜äº†ï¼Œ<code class="language-plaintext highlighter-rouge">cell</code> éå¸¸æ¶å¿ƒã€‚ã€‚ã€‚è„‘è¡¥ä¸‹å§ã€‚ æ–¹æ³•ç›´æ¥ <code class="language-plaintext highlighter-rouge">pass</code> äº†ã€‚ 
ç„¶åæˆ‘æ”¹è¿›äº†åšæ³•ï¼Œå‡†å¤‡ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">dictionary</code> è®°å½•æ¯ä¸ª <code class="language-plaintext highlighter-rouge">cell</code> çš„é«˜åº¦ï¼ˆä¸ºä»€ä¹ˆä¸ç”¨ <code class="language-plaintext highlighter-rouge">array</code> åé¢å†è°ˆï¼‰ï¼Œ åœ¨ <code class="language-plaintext highlighter-rouge">configure cell</code> æ—¶ä¸‹è½½å›¾ç‰‡ï¼Œç„¶ååœ¨ä¸‹è½½å®Œæˆçš„å›è°ƒé‡Œè®°å½•ä¸‹å½“å‰è¡Œçš„è¡Œé«˜ï¼Œç„¶å <code class="language-plaintext highlighter-rouge">reload table cell at indexPaths â€¦</code>ï¼Œ è¿™æ ·åšçš„åæœæ˜¯æ ·å¼æ¯”ä¸Šä¸€ç§æ–¹æ³•å¥½ç‚¹äº†ï¼Œä½†æ˜¯åœ¨æŸä¸€åˆ»ï¼Œå®ƒå±…ç„¶å´©æºƒäº†ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚åˆ·çš„å¤ªå¿«äº†ã€‚ã€‚ã€‚ã€‚</p>

<p>æœ€åå‚è€ƒè‹¹æœçš„ç¤ºä¾‹ç¨‹åº <code class="language-plaintext highlighter-rouge">LazyTable</code> å®ç°äº†ç°åœ¨å¾ˆæ»¡æ„çš„æ•ˆæœã€‚ä»¥ä¸‹å…³é”®æ•°æ®å’Œåç§°å·²æ›¿æ¢ï¼Œä½†ä¸å½±å“é˜…è¯»ã€‚</p>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#pragma mark - Table view datasource and delegate
</span><span class="k">-</span> <span class="p">(</span><span class="n">NSInteger</span><span class="p">)</span><span class="nf">tableView</span><span class="p">:(</span><span class="n">UITableView</span> <span class="o">*</span><span class="p">)</span><span class="nv">tableView</span> <span class="nf">numberOfRowsInSection</span><span class="p">:(</span><span class="n">NSInteger</span><span class="p">)</span><span class="nv">section</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">aArray</span> <span class="nf">count</span><span class="p">];</span>  <span class="c1">// aArray ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œä¿ç•™æ¯ä¸ª cell å¯¹åº”çš„ model</span>
<span class="p">}</span>

<span class="k">-</span> <span class="p">(</span><span class="n">CGFloat</span><span class="p">)</span><span class="nf">tableView</span><span class="p">:(</span><span class="n">UITableView</span> <span class="o">*</span><span class="p">)</span><span class="nv">tableView</span> <span class="nf">heightForRowAtIndexPath</span><span class="p">:(</span><span class="n">NSIndexPath</span> <span class="o">*</span><span class="p">)</span><span class="nv">indexPath</span> <span class="p">{</span>
    <span class="c1">// å…ˆä»ç¼“å­˜ä¸­æŸ¥æ‰¾å›¾ç‰‡</span>
    <span class="n">UIImage</span> <span class="o">*</span><span class="n">img</span> <span class="o">=</span> <span class="p">[[</span><span class="n">SDImageCache</span> <span class="nf">sharedImageCache</span><span class="p">]</span> <span class="nf">imageFromDiskCacheForKey</span><span class="p">:</span> <span class="n">imgKey</span> <span class="p">];</span>

    <span class="c1">// æ²¡æœ‰æ‰¾åˆ°å·²ä¸‹è½½çš„å›¾ç‰‡å°±ä½¿ç”¨é»˜è®¤çš„å ä½å›¾ï¼Œå½“ç„¶é«˜åº¦ä¹Ÿæ˜¯é»˜è®¤çš„é«˜åº¦äº†ï¼Œé™¤äº†é«˜åº¦ä¸å›ºå®šçš„æ–‡å­—éƒ¨åˆ†ã€‚</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">img</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">CachedImage</span><span class="p">(</span> <span class="n">placeholder</span> <span class="n">name</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">CGFloat</span> <span class="n">height</span> <span class="o">=</span> <span class="p">[</span><span class="n">MyCustomCell</span> <span class="nf">heightWithImage</span><span class="p">:</span><span class="n">img</span> <span class="nf">text</span><span class="p">:</span><span class="n">text</span><span class="p">];</span> <span class="c1">// æ ¹æ®ä¼ å…¥çš„åŠ¨æ€å†…å®¹è®¡ç®— cell çš„é«˜åº¦</span>
    <span class="k">return</span> <span class="n">height</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">-</span> <span class="p">(</span><span class="n">UITableViewCell</span> <span class="o">*</span><span class="p">)</span><span class="nf">tableView</span><span class="p">:(</span><span class="n">UITableView</span> <span class="o">*</span><span class="p">)</span><span class="nv">tableView</span> <span class="nf">cellForRowAtIndexPath</span><span class="p">:(</span><span class="n">NSIndexPath</span> <span class="o">*</span><span class="p">)</span><span class="nv">indexPath</span> <span class="p">{</span>
    <span class="k">static</span> <span class="n">NSString</span> <span class="o">*</span><span class="n">identifier</span> <span class="o">=</span> <span class="s">@"Cell Identifier"</span><span class="p">;</span>
    <span class="n">MyCustomCell</span> <span class="o">*</span><span class="n">cell</span> <span class="o">=</span> <span class="p">[</span><span class="n">tableView</span> <span class="nf">dequeueReusableCellWithIdentifier</span><span class="p">:</span><span class="n">identifier</span><span class="p">];</span>

    <span class="c1">// å¦‚æœæ²¡æœ‰å¯ä»¥å¤ç”¨çš„ cell å°±æ–°å»ºä¸€ä¸ª</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">cell</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="p">[[</span><span class="n">MyCustomCell</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithStyle</span><span class="p">:</span><span class="n">UITableViewCellStyleDefault</span>
                                     <span class="nl">reuseIdentifier:</span><span class="n">identifier</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="c1">// é…ç½® cell</span>
    <span class="p">[</span><span class="n">self</span> <span class="nf">configureCell</span><span class="p">:</span><span class="n">cell</span> <span class="nf">atIndexPath</span><span class="p">:</span><span class="n">indexPath</span><span class="p">];</span>

    <span class="k">return</span> <span class="n">cell</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">configureCell</span><span class="p">:(</span><span class="n">MyCustomCell</span> <span class="o">*</span><span class="p">)</span><span class="nv">cell</span> <span class="nf">atIndexPath</span><span class="p">:(</span><span class="n">NSIndexPath</span> <span class="o">*</span><span class="p">)</span><span class="nv">indexPath</span> <span class="p">{</span>
    <span class="c1">// æ­£å¸¸çš„è®¾ç½®æ–‡å­—å’Œå…¶ä»–å†…å®¹</span>

    <span class="c1">// å¼€å§‹åŠ è½½å›¾ç‰‡</span>
    <span class="n">NSString</span> <span class="o">*</span><span class="n">imgURL</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">aArray</span><span class="p">[</span><span class="n">indexPath</span><span class="p">.</span><span class="nf">row</span><span class="p">]</span> <span class="nf">valueForKey</span><span class="p">:</span> <span class="n">imgKey</span> <span class="p">];</span>    <span class="c1">// å›¾ç‰‡ url</span>
    <span class="n">UIImage</span> <span class="o">*</span><span class="n">cachedImage</span> <span class="o">=</span> <span class="p">[[</span><span class="n">SDImageCache</span> <span class="nf">sharedImageCache</span><span class="p">]</span> <span class="nf">imageFromDiskCacheForKey</span><span class="p">:</span><span class="n">imgURL</span><span class="p">];</span>

    <span class="c1">// æ²¡æœ‰å·²ç»ä¸‹è½½å¥½çš„å›¾ç‰‡</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">cachedImage</span> <span class="p">)</span> <span class="p">{</span>
        <span class="c1">// è¦æ˜¯å½“å‰ table view æ²¡æœ‰åœ¨è¢«æ‹–åŠ¨æˆ–è€…è‡ªç”±æ»‘è¡Œ</span>
        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">self</span><span class="p">.</span><span class="n">tableView</span><span class="p">.</span><span class="n">dragging</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">self</span><span class="p">.</span><span class="n">tableView</span><span class="p">.</span><span class="n">decelerating</span> <span class="p">)</span> <span class="p">{</span>
            <span class="c1">// ä¸‹è½½å½“å‰ cell ä¸­çš„å›¾ç‰‡</span>
            <span class="p">[</span><span class="n">self</span> <span class="nf">downloadImage</span><span class="p">:</span><span class="n">imgURL</span> <span class="nf">forIndexPath</span><span class="p">:</span><span class="n">indexPath</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="c1">// cell ä¸­å›¾ç‰‡å…ˆç”¨ç¼“å­˜çš„å ä½å›¾ä»£æ›¿</span>
        <span class="p">[</span><span class="n">cell</span> <span class="nf">setSpitslotImage</span><span class="p">:</span><span class="n">CachedImage</span><span class="p">(</span><span class="s">@"placeholder"</span><span class="p">)];</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// æ‰¾åˆ°äº†ç¼“å­˜çš„å›¾ç‰‡ï¼Œç›´æ¥æ’ç¼“å­˜çš„å›¾ç‰‡</span>
        <span class="p">[</span><span class="n">cell</span> <span class="nf">setSpitslotImage</span><span class="p">:</span><span class="n">cachedImage</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">downloadImage</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">imageURL</span> <span class="nf">forIndexPath</span><span class="p">:(</span><span class="n">NSIndexPath</span> <span class="o">*</span><span class="p">)</span><span class="nv">indexPath</span> <span class="p">{</span>
    <span class="n">__weak</span> <span class="n">typeof</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="n">target</span> <span class="o">=</span> <span class="n">self</span><span class="p">;</span>

    <span class="c1">// åˆ©ç”¨ SDWebImage æ¡†æ¶æä¾›çš„åŠŸèƒ½ä¸‹è½½å›¾ç‰‡</span>
    <span class="p">[[</span><span class="n">SDWebImageDownloader</span> <span class="nf">sharedDownloader</span><span class="p">]</span> <span class="nf">downloadImageWithURL</span><span class="p">:</span><span class="n">URLFromString</span><span class="p">(</span><span class="n">imageURL</span><span class="p">)</span>
    <span class="nl">options:</span><span class="n">SDWebImageDownloaderUseNSURLCache</span>
    <span class="nl">progress:</span><span class="o">^</span><span class="p">(</span><span class="n">NSUInteger</span> <span class="n">receivedSize</span><span class="p">,</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">expectedSize</span><span class="p">)</span> <span class="p">{</span>
     <span class="c1">// Do nothing</span>
    <span class="p">}</span>
    <span class="nl">completed:</span><span class="o">^</span><span class="p">(</span><span class="n">UIImage</span> <span class="o">*</span><span class="n">image</span><span class="p">,</span> <span class="n">NSData</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">,</span> <span class="n">BOOL</span> <span class="n">finished</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// ä¿å­˜å›¾ç‰‡</span>
    <span class="p">[[</span><span class="n">SDImageCache</span> <span class="nf">sharedImageCache</span><span class="p">]</span> <span class="nf">storeImage</span><span class="p">:</span><span class="n">image</span> <span class="nf">forKey</span><span class="p">:</span><span class="n">imageURL</span> <span class="n">toDisk</span><span class="o">:</span><span class="nb">YES</span><span class="p">];</span> <span class="c1">// åˆ«å¿˜äº†ä¿å­˜åˆ°ç£ç›˜ä¸Š</span>

    <span class="c1">// å»¶è¿Ÿåœ¨ä¸»çº¿ç¨‹æ›´æ–° cell çš„é«˜åº¦</span>
    <span class="p">[</span><span class="n">target</span> <span class="nf">performSelectorOnMainThread</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="nf">reloadCellAtIndexPath</span><span class="p">:)</span>       <span class="c1">// è‡³äºè¿™æ­¥çš„åŸå› æ˜¯ä¸ºäº†é˜²æ­¢åˆ·çš„å¤ªå¿«äº†å´©æºƒ</span>
                             <span class="nl">withObject:</span><span class="n">indexPath</span> <span class="n">waitUntilDone</span><span class="o">:</span><span class="nb">NO</span><span class="p">];</span>            <span class="c1">// è¿™æ­¥ä¼šæŠŠ selector çš„è°ƒç”¨æ”¾åˆ°ä¸»çº¿ç¨‹çš„ run loop é‡Œæ’é˜Ÿ</span>
    <span class="p">}];</span>                                                                         <span class="c1">// é£é™©å°±æ˜¯è¦æ˜¯è¿™ä¸ªé˜Ÿåˆ—é‡Œæ’é˜Ÿçš„æ¯”è¾ƒå¤šï¼Œ</span>
                                                                                <span class="c1">// è¿™ä¸ªåæ’å…¥çš„æ–¹æ³•æ‰§è¡Œä¼šè¢«å»¶è¿Ÿ</span>
<span class="p">}</span>

<span class="c1">// è¿™ä¸ªæ–¹æ³•æ²¡ä»€ä¹ˆå¥½è§£é‡Šçš„äº†</span>
<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">loadImageForOnScreenRows</span> <span class="p">{</span>
    <span class="n">NSArray</span> <span class="o">*</span><span class="n">visiableIndexPathes</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">tableView</span> <span class="nf">indexPathsForVisibleRows</span><span class="p">];</span>

    <span class="k">for</span><span class="p">(</span><span class="n">NSInteger</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">[</span><span class="n">visiableIndexPathes</span> <span class="nf">count</span><span class="p">];</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">NSString</span> <span class="o">*</span><span class="n">imgURL</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">aArray</span><span class="p">[</span><span class="nf">i</span><span class="p">]</span> <span class="nf">valueForKey</span><span class="p">:</span> <span class="n">imgKey</span> <span class="p">];</span>
        <span class="p">[</span><span class="n">self</span> <span class="nf">downloadImage</span><span class="p">:</span><span class="n">imgURL</span> <span class="nf">forIndexPath</span><span class="p">:</span><span class="n">visiableIndexPathes</span><span class="p">[</span><span class="nf">i</span><span class="p">]];</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// æ–¹æ³•åä¸ºä»€ä¹ˆå«è¿™ä¸ªã€‚ã€‚ã€‚ã€‚æ˜¯æˆ‘å¤ªæ‡’äº†ï¼Œä¹‹å‰å†™çš„æ˜¯åˆ·æ–°æŸä¸€è¡Œçš„æ•°æ®ï¼Œç„¶åå‘ç°æ•ˆç‡ä¸é«˜ï¼Œè¿˜å®¹æ˜“å´©æºƒ</span>
<span class="c1">// æœ€åç›´æ¥åˆ·æ–°å…¨éƒ¨æ•°æ®äº†ã€‚ã€‚</span>
<span class="c1">// ä½†æ˜¯åˆ«è®¤ä¸ºè°ƒç”¨ table view çš„ reloadData æ•ˆç‡å°±ä¸é«˜ï¼Œå›é¡¾ä¸‹ä¸Šé¢çš„æ­¥éª¤</span>
<span class="c1">// reloadData å®é™…ä¸Šå°±æ˜¯å‘ä»£ç†è¦è¡Œæ•°ï¼Œè¦è¡Œé«˜ï¼Œå¯¹**æ˜¾ç¤ºå‡ºæ¥**çš„ cell å¡«å……æ•°æ®</span>
<span class="c1">// æˆ‘çš„é‚£ä»½ä»£ç çš„ç“¶é¢ˆå°±æ˜¯ è®¡ç®—è¡Œé«˜å’Œå¡«å……æ•°æ®ï¼Œä¸è¿‡ç°åœ¨çœ‹æ¥æ²¡ä»€ä¹ˆä¸æµç•…çš„ï¼Œæ‰€ä»¥å°±æ²¡ä»€ä¹ˆé—®é¢˜</span>
<span class="c1">// å…¶å®ï¼Œä¸ºäº†æ€§èƒ½è€ƒè™‘ï¼Œè¿˜æ˜¯æœ€å¥½æœåŠ¡å™¨è¿”å› æ¯ä¸ª cell ä¸­çš„å›¾ç‰‡çš„å®½é«˜ï¼Œç°åœ¨çš„åšæ³•åªæ˜¯ä¸´æ—¶è§£å†³åå°xxçš„é—®é¢˜ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span>
<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">reloadCellAtIndexPath</span><span class="p">:(</span><span class="n">NSIndexPath</span> <span class="o">*</span><span class="p">)</span><span class="nv">indexPath</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">tableView</span> <span class="nf">reloadData</span><span class="p">];</span>
<span class="p">}</span>

<span class="cp">#pragma mark - Scroll view delegate
</span><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">scrollViewDidEndDragging</span><span class="p">:(</span><span class="n">UIScrollView</span> <span class="o">*</span><span class="p">)</span><span class="nv">scrollView</span> <span class="nf">willDecelerate</span><span class="p">:(</span><span class="n">BOOL</span><span class="p">)</span><span class="nv">decelerate</span> <span class="p">{</span>   
    <span class="c1">// table view åœæ­¢æ‹–åŠ¨äº†</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">decelerate</span><span class="p">)</span> <span class="p">{</span>
        <span class="p">[</span><span class="n">self</span> <span class="nf">loadImageForOnScreenRows</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">scrollViewDidEndDecelerating</span><span class="p">:(</span><span class="n">UIScrollView</span> <span class="o">*</span><span class="p">)</span><span class="nv">scrollView</span> <span class="p">{</span>
    <span class="c1">// table view åœæ­¢æ»šåŠ¨äº†</span>
    <span class="p">[</span><span class="n">self</span> <span class="nf">loadImageForOnScreenRows</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div></div>
<p>ç°åœ¨æ¥è§£é‡Šä¸‹ä¸ºä»€ä¹ˆæˆ‘ä¿å­˜ <code class="language-plaintext highlighter-rouge">cell</code> é«˜åº¦ç”¨å­—å…¸æ–‡ä»¶ä¸ç”¨ <code class="language-plaintext highlighter-rouge">array</code>ã€‚ å› ä¸ºã€‚ã€‚ã€‚ã€‚ã€‚ã€‚æˆ‘æ‡’ã€‚ç”¨ <code class="language-plaintext highlighter-rouge">array</code>ä¿å­˜ï¼Œæ¯ä¸ªæ²¡æœ‰æ•°æ®çš„é¡¹è¦å¡«å……é»˜è®¤æ•°æ®ï¼Œå¦åˆ™è„‘è¡¥ä¸‹ã€‚è€Œå­—å…¸æ–‡ä»¶æ²¡æœ‰ç‰©ç†ä¸Šçš„é¡ºåºæ€§ï¼Œå¯ä»¥è„‘è¡¥å‡ºä¸€ä¸ªé€»è¾‘ä¸Šçš„é¡ºåºæ€§ï¼Œé€šè¿‡è‡ªå®šä¹‰ <code class="language-plaintext highlighter-rouge">key</code>ã€‚</p>

<p>ç°åœ¨è°ˆè°ˆç¬¬äºŒä¸ªé—®é¢˜ï¼š è‡ªå®šä¹‰çš„ <code class="language-plaintext highlighter-rouge">cell</code> ä¸­çš„çš„ <code class="language-plaintext highlighter-rouge">button</code> éƒ½æ²¡æ³•ç‚¹å‡»äº†ï¼Œæˆ‘é‡å†™äº† <code class="language-plaintext highlighter-rouge">hit test</code> æ–¹æ³•ï¼Œå¼ºåˆ¶è¿”å›é‚£ä¸ª <code class="language-plaintext highlighter-rouge">button</code>ï¼Œé‡å†™äº† <code class="language-plaintext highlighter-rouge">touch began</code>, <code class="language-plaintext highlighter-rouge">touch end</code> å¼ºåˆ¶å‘ä¸‹ä¸€ä¸ªå“åº”è€…å‘é€äº‹ä»¶ï¼Œæ²¡ç”¨ã€‚ã€‚ã€‚ã€‚å‘çˆ¹å•Šã€‚æœ€åæˆ‘è°ƒæ•´ <code class="language-plaintext highlighter-rouge">button</code> çš„ä½ç½®ï¼ŒåŸç‚¹ç§»åŠ¨åˆ°äº† ï¼ˆ0,0ï¼‰ å¯ä»¥ç‚¹å‡»äº†ï¼ï¼ï¼ï¼ ç»™ <code class="language-plaintext highlighter-rouge">contentView</code> è¡¥äº†ä¸ªè‰²ï¼Œå°¼ç›æ€ä¹ˆè¿˜æ˜¯é»˜è®¤é«˜åº¦ï¼ï¼ï¼ï¼ï¼ï¼ï¼åŸæ¥åœ¨é‡å†™ <code class="language-plaintext highlighter-rouge">layoutSubviews</code> æ–¹æ³•ä¸­æˆ‘åªé¡¾ç€è°ƒæ•´æˆ‘è‡ªå·±çš„å­ <code class="language-plaintext highlighter-rouge">view</code> çš„ä½ç½®äº†ï¼Œå¿˜äº†è°ƒæ•´ <code class="language-plaintext highlighter-rouge">content view</code>ã€‚åœ¨æ–¹æ³•å¼€å¤´è¡¥ä¸Š</p>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">super</span> <span class="nf">layoutSubviews</span><span class="p">];</span>
</code></pre></div></div>

:ET