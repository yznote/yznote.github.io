I"ߘ<h4 id="置顶">置顶</h4>

<p><strong>iOS15</strong><br />
UITableView分组高度显示异常:</p>
<blockquote>
  <p>只处理当前页面:</p>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if (@available(iOS 15.0, *)) {
    _tableView.sectionHeaderTopPadding = 0;
}
</code></pre></div>  </div>
  <p>全局处理:</p>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if (@available(iOS 15.0, *)) {
    [UITableView appearance].sectionHeaderTopPadding = 0;
}
</code></pre></div>  </div>
</blockquote>

<p><strong>iOS15导航边透明</strong>
<code class="language-plaintext highlighter-rouge">放到改变tabbar字体或者tintcolor之后</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if (@available(iOS 15.0, *)) {
    UITabBarAppearance * appearance = [[UITabBarAppearance alloc] init];
    [appearance configureWithOpaqueBackground];
    appearance.backgroundColor = UIColor.whiteColor;
    [UITabBar appearance].scrollEdgeAppearance = appearance;
    [UITabBar appearance].standardAppearance = appearance;
}
[UITabBar appearance].backgroundColor = UIColor.whiteColor;
</code></pre></div></div>

<p><strong>横竖屏幕适配(安全距离)</strong></p>

<p>在控制器中重写以下方法其中<code class="language-plaintext highlighter-rouge">self.viewTop self.viewLeft self.viewRight self.viewBottom</code> 分别为子UIView距离四边约束，旋转屏幕可以完全适配。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- (void)viewDidLayoutSubviews{

    [super viewDidLayoutSubviews];
    
    UIEdgeInsets safeAreaInsets = UIEdgeInsetsZero;
    if (@available(iOS 11.0, *)) {
        safeAreaInsets = self.view.safeAreaInsets;
    }
    
    self.viewTop.constant = safeAreaInsets.top;
    self.viewLeft.constant = safeAreaInsets.left;
    self.viewRight.constant = safeAreaInsets.right;
    self.viewBottom.constant = safeAreaInsets.bottom;
}
</code></pre></div></div>

<p><strong>控件重叠、坐标转换</strong></p>

<p><a href="https://www.jianshu.com/p/ced04a958e8c">超链接</a></p>

<p><strong>iOS13</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>UITextField *textField ;
if (@available(iOS 13.0,*)) {
    textField = _searchBar.searchTextField;
    textField.attributedPlaceholder = [[NSAttributedString alloc] initWithString:_searchBar.placeholder attributes:@{NSForegroundColorAttributeName:RGB_COLOR(@"#323232", 0.5),NSFontAttributeName:[UIFont systemFontOfSize:16]}];
}else {
    textField = [_searchBar valueForKey:@"_searchField"];
    [textField setValue:RGB_COLOR(@"#323232", 0.5) forKeyPath:@"_placeholderLabel.textColor"];
    [textField setValue:[UIFont systemFontOfSize:16] forKeyPath:@"_placeholderLabel.font"];
}

//searchbar 取消按钮
- (UIButton *)cancleButton {
    self.showsCancelButton = YES;
    for (UIView *view in [[self.subviews lastObject] subviews]) {
        if ([view isKindOfClass:[UIButton class]]) {
            _cancleButton = (UIButton *)view;
        }
    }
    if (@available(iOS 13.0,*)) {
        [self setShowsCancelButton:YES animated:YES];
        for (UIView *view in [[self.subviews lastObject] subviews]) {
            for (UIView *buttonView in view.subviews) {
                if ([buttonView isKindOfClass:[UIButton class]]) {
                    _cancleButton = (UIButton *)buttonView;
                }
            }
        }
    }
    return _cancleButton;
}

</code></pre></div></div>

<p><strong>Url转换</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>url = [url stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
url = [url stringByAddingPercentEncodingWithAllowedCharacters:[NSCharacterSet URLQueryAllowedCharacterSet]];
</code></pre></div></div>

<p><strong>按钮</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[_coverBtn.imageView setContentMode:UIViewContentModeScaleAspectFill];
_coverBtn.contentHorizontalAlignment = UIControlContentHorizontalAlignmentFill;
_coverBtn.contentVerticalAlignment = UIControlContentVerticalAlignmentFill;
</code></pre></div></div>

<p><strong>版本判断</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    if (@available(iOS 10.0,*)) {
        NSLog(@"10+");
    }else {
        NSLog(@"10-");
    }
    if (@available(iOS 11.0,*)) {
        self.tableView.contentInsetAdjustmentBehavior = UIScrollViewContentInsetAdjustmentNever;
    }else {
        self.automaticallyAdjustsScrollViewInsets = NO;
    }
</code></pre></div></div>

<p><strong>系统照片选择器</strong></p>

<p>//选择(present)前</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    if (@available(iOS 11, *)) {
        UIScrollView.appearance.contentInsetAdjustmentBehavior = UIScrollViewContentInsetAdjustmentAutomatic;
    }
</code></pre></div></div>

<p>//完成选择(finish)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    if (@available(iOS 11, *)) {
        UIScrollView.appearance.contentInsetAdjustmentBehavior = UIScrollViewContentInsetAdjustmentNever;
    }
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">present</code>: <code class="language-plaintext highlighter-rouge">[UIApplication sharedApplication].statusBarHidden=YES;</code> <br />
<code class="language-plaintext highlighter-rouge">dismiss</code>: <code class="language-plaintext highlighter-rouge">[UIApplication sharedApplication].statusBarHidden=NO;</code></p>

<p>//相册取消按钮不能点击</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- (void)navigationController:(UINavigationController *)navigationController didShowViewController:(UIViewController *)viewController animated:(BOOL)animated {
    if ([UIDevice currentDevice].systemVersion.floatValue &lt; 11) {
        return;
    }
    if ([viewController isKindOfClass:NSClassFromString(@"PUPhotoPickerHostViewController")]) {
        [viewController.view.subviews enumerateObjectsUsingBlock:^(__kindof UIView * _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) {
            if (obj.frame.size.width &lt; 42) {
                [viewController.view sendSubviewToBack:obj];
                *stop = YES;
            }
        }];
    }
}
</code></pre></div></div>

<p><strong>时间倒序</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>options.sortDescriptors = @[[NSSortDescriptor sortDescriptorWithKey:@"creationDate" ascending:NO]];
</code></pre></div></div>

<p><strong>tableview回弹</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> _tableView.estimatedRowHeight =0;
 _tableView.estimatedSectionHeaderHeight =0;
 _tableView.estimatedSectionFooterHeight =0;
</code></pre></div></div>

<h4 id="一贝塞尔曲线画圆角">一、贝塞尔曲线画圆角</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">UIBezierPath</span> <span class="o">*</span><span class="n">maskPath</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIBezierPath</span> <span class="nf">bezierPathWithRoundedRect</span><span class="p">:</span><span class="n">litleNav</span><span class="p">.</span><span class="n">bounds</span>  <span class="nf">byRoundingCorners</span><span class="p">:</span><span class="n">UIRectCornerTopRight</span><span class="o">|</span><span class="n">UIRectCornerTopLeft</span> <span class="n">cornerRadii</span><span class="o">:</span><span class="n">CGSizeMake</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)];</span>
    <span class="n">CAShapeLayer</span> <span class="o">*</span><span class="n">maskLayer</span> <span class="o">=</span> <span class="p">[[</span><span class="n">CAShapeLayer</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
    <span class="n">maskLayer</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">litleNav</span><span class="p">.</span><span class="n">bounds</span><span class="p">;</span>
    <span class="n">maskLayer</span><span class="p">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">maskPath</span><span class="p">.</span><span class="n">CGPath</span><span class="p">;</span>
    <span class="n">litleNav</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">maskLayer</span><span class="p">;</span>
    
    <span class="c1">//延伸:(segment items底部圆角)</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">_segmentC</span><span class="p">.</span><span class="n">subviews</span><span class="p">.</span><span class="n">count</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">CGFloat</span> <span class="n">ww</span> <span class="o">=</span> <span class="n">_window_width</span><span class="o">/</span><span class="n">_segmentC</span><span class="p">.</span><span class="n">subviews</span><span class="p">.</span><span class="n">count</span><span class="p">;</span>
        <span class="n">CGRect</span> <span class="n">srect</span> <span class="o">=</span> <span class="n">CGRectMake</span><span class="p">(</span><span class="n">ww</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="mi">64</span><span class="o">+</span><span class="n">statusbarHeight</span><span class="o">+</span><span class="n">_window_width</span><span class="o">/</span><span class="mi">4</span><span class="p">.</span><span class="mi">3</span><span class="p">,</span> <span class="n">ww</span><span class="p">,</span> <span class="mi">40</span><span class="p">);</span>
        <span class="n">UIView</span> <span class="o">*</span><span class="n">subView</span> <span class="o">=</span> <span class="n">_segmentC</span><span class="p">.</span><span class="n">subviews</span><span class="p">[</span><span class="nf">i</span><span class="p">];</span>
        <span class="n">subView</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">srect</span><span class="p">;</span>
        <span class="n">UIBezierPath</span> <span class="o">*</span><span class="n">maskPath</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIBezierPath</span> <span class="nf">bezierPathWithRoundedRect</span><span class="p">:</span><span class="n">subView</span><span class="p">.</span><span class="n">bounds</span>    <span class="nf">byRoundingCorners</span><span class="p">:</span><span class="n">UIRectCornerBottomRight</span><span class="o">|</span><span class="n">UIRectCornerBottomLeft</span> <span class="n">cornerRadii</span><span class="o">:</span><span class="n">CGSizeMake</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)];</span>
        <span class="n">CAShapeLayer</span> <span class="o">*</span><span class="n">maskLayer</span> <span class="o">=</span> <span class="p">[[</span><span class="n">CAShapeLayer</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
        <span class="n">maskLayer</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">subView</span><span class="p">.</span><span class="n">bounds</span><span class="p">;</span>
        <span class="n">maskLayer</span><span class="p">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">maskPath</span><span class="p">.</span><span class="n">CGPath</span><span class="p">;</span>
        <span class="n">_segmentC</span><span class="p">.</span><span class="n">subviews</span><span class="p">[</span><span class="nf">i</span><span class="p">].</span><span class="n">layer</span><span class="p">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">maskLayer</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">//图片切割: maskImage = [maskImage resizableImageWithCapInsets:UIEdgeInsetsMake(30, 20, 30, 20)];</span>
</code></pre></div></div>

<h4 id="二富文本">二、富文本</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span> <span class="nf">convertToInt</span><span class="p">:</span><span class="n">amountL</span><span class="p">.</span><span class="n">text</span><span class="p">];</span>
    <span class="n">NSMutableAttributedString</span> <span class="o">*</span><span class="n">attStr</span><span class="o">=</span><span class="p">[[</span><span class="n">NSMutableAttributedString</span> <span class="nf">alloc</span><span class="p">]</span><span class="nf">initWithString</span><span class="p">:</span><span class="n">amountL</span><span class="p">.</span><span class="n">text</span><span class="p">];</span>
    <span class="p">[</span><span class="n">attStr</span> <span class="nf">addAttribute</span><span class="p">:</span><span class="n">NSFontAttributeName</span> <span class="nf">value</span><span class="p">:[</span><span class="n">UIFont</span> <span class="nf">systemFontOfSize</span><span class="p">:</span><span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">]</span> <span class="n">range</span><span class="o">:</span><span class="n">NSMakeRange</span><span class="p">(</span><span class="n">length</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)];</span>
    <span class="n">amountL</span><span class="p">.</span><span class="n">attributedText</span> <span class="o">=</span> <span class="n">attStr</span><span class="p">;</span>

<span class="k">-</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="nf">convertToInt</span><span class="p">:(</span><span class="n">NSString</span><span class="o">*</span><span class="p">)</span><span class="nv">strtemp</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">strlength</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span> <span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="p">[</span><span class="n">strtemp</span> <span class="nf">lengthOfBytesUsingEncoding</span><span class="p">:</span><span class="n">NSUnicodeStringEncoding</span><span class="p">]</span> <span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">strlength</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">strlength</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>


    <span class="c1">//段落样式</span>
    <span class="n">NSMutableParagraphStyle</span> <span class="o">*</span><span class="n">paragraph</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSMutableParagraphStyle</span> <span class="nf">alloc</span><span class="p">]</span><span class="nf">init</span><span class="p">];</span>
    <span class="c1">//行间距</span>
    <span class="n">paragraph</span><span class="p">.</span><span class="n">lineSpacing</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="c1">//添加段落设置</span>
    <span class="p">[</span><span class="n">text</span> <span class="nf">addAttribute</span><span class="p">:</span><span class="n">NSParagraphStyleAttributeName</span> <span class="nf">value</span><span class="p">:</span><span class="n">paragraph</span> <span class="n">range</span><span class="o">:</span><span class="n">NSMakeRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">text</span><span class="p">.</span><span class="n">length</span><span class="p">)];</span>

</code></pre></div></div>

<h4 id="三文本计算">三、文本计算</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//计算字符串应该占有的大小</span>
<span class="k">-</span><span class="p">(</span><span class="n">CGSize</span><span class="p">)</span><span class="nf">sizeWithString</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">string</span> <span class="nf">andFont</span><span class="p">:(</span><span class="n">UIFont</span> <span class="o">*</span><span class="p">)</span><span class="nv">font</span> <span class="p">{</span>
    <span class="n">CGSize</span> <span class="n">size</span> <span class="o">=</span> <span class="p">[</span><span class="n">string</span> <span class="nf">sizeWithAttributes</span><span class="p">:[</span><span class="n">NSDictionary</span> <span class="nf">dictionaryWithObjectsAndKeys</span><span class="p">:</span><span class="n">font</span><span class="p">,</span><span class="n">NSFontAttributeName</span><span class="p">,</span> <span class="nb">nil</span><span class="p">]];</span>
    <span class="k">return</span> <span class="n">size</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">//计算文本内容占有的大小</span>
<span class="k">-</span><span class="p">(</span><span class="n">CGRect</span><span class="p">)</span><span class="nf">rectWithString</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">string</span> <span class="nf">andFont</span><span class="p">:(</span><span class="n">UIFont</span> <span class="o">*</span><span class="p">)</span><span class="nv">font</span> <span class="nf">andWidth</span><span class="p">:(</span><span class="n">CGFloat</span><span class="p">)</span><span class="nv">width</span> <span class="p">{</span>
    <span class="n">CGRect</span> <span class="n">rect</span> <span class="o">=</span> <span class="p">[</span><span class="n">string</span> <span class="nf">boundingRectWithSize</span><span class="p">:</span><span class="n">CGSizeMake</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">CGFLOAT_MAX</span><span class="p">)</span> <span class="nf">options</span><span class="p">:</span><span class="n">NSStringDrawingUsesLineFragmentOrigin</span> <span class="n">attributes</span><span class="o">:</span><span class="p">[</span><span class="n">NSDictionary</span> <span class="nf">dictionaryWithObjectsAndKeys</span><span class="p">:</span><span class="n">font</span><span class="p">,</span><span class="n">NSFontAttributeName</span><span class="p">,</span> <span class="nb">nil</span><span class="p">]</span> <span class="n">context</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span>
    <span class="k">return</span> <span class="n">rect</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="四网址正则判断">四、网址正则判断</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">//NSString *pattern = @"http(s)?://([\\w-]+\\.)+[\\w-]+(/[\\w- ./?%&amp;=]*)?";</span>
    <span class="n">NSString</span> <span class="o">*</span><span class="n">pattern</span> <span class="o">=</span> <span class="s">@"(http://|ftp://|https://|www){0,1}[^\u4e00-\u9fa5</span><span class="se">\\</span><span class="s">s]*?</span><span class="se">\\</span><span class="s">.(com|net|cn|me|tw|fr)[^\u4e00-\u9fa5</span><span class="se">\\</span><span class="s">s]*"</span><span class="p">;</span>
    <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
    <span class="n">NSRegularExpression</span> <span class="o">*</span><span class="n">regex</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSRegularExpression</span> <span class="nf">regularExpressionWithPattern</span><span class="p">:</span><span class="n">pattern</span> <span class="nf">options</span><span class="p">:</span><span class="n">NSRegularExpressionCaseInsensitive</span> <span class="n">error</span><span class="o">:&amp;</span><span class="n">error</span><span class="p">];</span>
    <span class="n">NSArray</span><span class="o">&lt;</span><span class="n">NSTextCheckingResult</span> <span class="o">*&gt;</span> <span class="o">*</span><span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">regex</span> <span class="nf">matchesInString</span><span class="p">:</span><span class="n">keyField</span><span class="p">.</span><span class="n">text</span> <span class="nf">options</span><span class="p">:</span><span class="mi">0</span> <span class="n">range</span><span class="o">:</span><span class="n">NSMakeRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">keyField</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">length</span><span class="p">)];</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">result</span><span class="p">.</span><span class="n">count</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">NSTextCheckingResult</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="nf">i</span><span class="p">];</span>
            <span class="n">NSLog</span><span class="p">(</span><span class="s">@"str == %@"</span><span class="p">,</span> <span class="p">[</span><span class="n">keyField</span><span class="p">.</span><span class="n">text</span> <span class="nf">substringWithRange</span><span class="p">:</span><span class="n">res</span><span class="p">.</span><span class="n">range</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">@"error == %@"</span><span class="p">,</span><span class="n">error</span><span class="p">.</span><span class="n">description</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">//补充：数字字母正则</span>
    <span class="k">-</span><span class="p">(</span><span class="n">BOOL</span><span class="p">)</span><span class="nf">judgePassWordLegal</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">pass</span> <span class="p">{</span>
        <span class="n">BOOL</span> <span class="n">result</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">([</span><span class="n">pass</span> <span class="nf">length</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">8</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// 判断长度大于8位后再接着判断是否同时包含数字和字符</span>
            <span class="n">NSString</span> <span class="o">*</span> <span class="n">regex</span> <span class="o">=</span> <span class="s">@"^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{8,100}$"</span><span class="p">;</span>
            <span class="n">NSPredicate</span> <span class="o">*</span><span class="n">pred</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSPredicate</span> <span class="nf">predicateWithFormat</span><span class="p">:</span><span class="s">@"SELF MATCHES %@"</span><span class="p">,</span> <span class="n">regex</span><span class="p">];</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">pred</span> <span class="nf">evaluateWithObject</span><span class="p">:</span><span class="n">pass</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="cm">/**
     * 手机号码
     * 移动：134[0-8],135,136,137,138,139,150,151,157,158,159,182,187,188,1705
     * 联通：130,131,132,152,155,156,185,186,1709
     * 电信：133,1349,153,180,189,1700
     */</span>
    <span class="c1">//    NSString * MOBILE = @"^1((3//d|5[0-35-9]|8[025-9])//d|70[059])\\d{7}$";//总况</span>
    
    <span class="cm">/**
     10         * 中国移动：China Mobile
     11         * 134[0-8],135,136,137,138,139,150,151,157,158,159,182,187,188，1705
     12         */</span>
    <span class="n">NSString</span> <span class="o">*</span> <span class="n">CM</span> <span class="o">=</span> <span class="s">@"^1(34[0-8]|(3[5-9]|5[017-9]|8[278])</span><span class="se">\\</span><span class="s">d|705)</span><span class="se">\\</span><span class="s">d{7}$"</span><span class="p">;</span>
    <span class="cm">/**
     15         * 中国联通：China Unicom
     16         * 130,131,132,152,155,156,185,186,1709
     17         */</span>
    <span class="n">NSString</span> <span class="o">*</span> <span class="n">CU</span> <span class="o">=</span> <span class="s">@"^1((3[0-2]|5[256]|8[56])</span><span class="se">\\</span><span class="s">d|709)</span><span class="se">\\</span><span class="s">d{7}$"</span><span class="p">;</span>
    <span class="cm">/**
     20         * 中国电信：China Telecom
     21         * 133,1349,153,180,189,1700
     22         */</span>
    <span class="n">NSString</span> <span class="o">*</span> <span class="n">CT</span> <span class="o">=</span> <span class="s">@"^1((33|53|8[09])</span><span class="se">\\</span><span class="s">d|349|700)</span><span class="se">\\</span><span class="s">d{7}$"</span><span class="p">;</span>
    
    
    <span class="cm">/**
     25         * 大陆地区固话及小灵通
     26         * 区号：010,020,021,022,023,024,025,027,028,029
     27         * 号码：七位或八位
     28         */</span>
    <span class="n">NSString</span> <span class="o">*</span> <span class="n">PHS</span> <span class="o">=</span> <span class="s">@"^0(10|2[0-5789]|</span><span class="se">\\</span><span class="s">d{3})</span><span class="se">\\</span><span class="s">d{7,8}$"</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="五禁止右滑返回">五、禁止右滑返回</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    self.navigationController.interactivePopGestureRecognizer.enabled = NO;
    self.navigationController.navigationBarHidden = YES;
    self.navigationController.interactivePopGestureRecognizer.delegate =nil;

注:手势排除点击范围
#pragma mark - UIGestureRecognizerDelegate
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch {
    if( [touch.view isDescendantOfView:_agreementOrPrivacy])
        return NO;
    return YES;
}
</code></pre></div></div>

<h4 id="六获取视频第一帧">六、获取视频第一帧</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- (UIImage*) getVideoPreViewImageWithPath:(NSURL *)videoPath {
    AVURLAsset *asset = [[AVURLAsset alloc] initWithURL:videoPath options:nil];
    AVAssetImageGenerator *gen = [[AVAssetImageGenerator alloc] initWithAsset:asset];
    gen.appliesPreferredTrackTransform = YES;
    CMTime time   = CMTimeMakeWithSeconds(0.0, 600);
    NSError *error  = nil;
    CMTime actualTime;
    CGImageRef image = [gen copyCGImageAtTime:time actualTime:&amp;actualTime error:&amp;error];
    UIImage *img   = [[UIImage alloc] initWithCGImage:image];
    return img;
}
</code></pre></div></div>

<h4 id="七textview">七、textView</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 	<span class="n">_desTV</span><span class="p">.</span><span class="n">editable</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
    <span class="n">_desTV</span><span class="p">.</span><span class="n">bounces</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
    <span class="n">_desTV</span><span class="p">.</span><span class="n">selectable</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
    <span class="n">_desTV</span><span class="p">.</span><span class="n">showsVerticalScrollIndicator</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
    <span class="n">_desTV</span><span class="p">.</span><span class="n">textContainerInset</span> <span class="o">=</span> <span class="n">UIEdgeInsetsMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    
    <span class="c1">//扩展textView横向滚动</span>
    <span class="n">_desTV</span><span class="p">.</span><span class="n">textContainer</span><span class="p">.</span><span class="n">lineBreakMode</span> <span class="o">=</span> <span class="n">NSLineBreakByTruncatingHead</span><span class="p">;</span>
    <span class="n">_desTV</span><span class="p">.</span> <span class="n">textContainer</span><span class="p">.</span><span class="n">maximumNumberOfLines</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c1">//自定义textfield：</span>
<span class="k">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">drawPlaceholderInRect</span><span class="p">:(</span><span class="n">CGRect</span><span class="p">)</span><span class="nv">rect</span> <span class="p">{</span>
    <span class="c1">// 设置富文本属性</span>
    <span class="n">NSMutableDictionary</span> <span class="o">*</span><span class="n">dictM</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSMutableDictionary</span> <span class="nf">dictionary</span><span class="p">];</span>
    <span class="n">dictM</span><span class="p">[</span><span class="nf">NSFontAttributeName</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">font</span><span class="p">;</span>
    <span class="n">dictM</span><span class="p">[</span><span class="nf">NSForegroundColorAttributeName</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIColor</span> <span class="nf">whiteColor</span><span class="p">];</span>
    <span class="n">CGPoint</span> <span class="n">point</span> <span class="o">=</span> <span class="n">CGPointMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">rect</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">self</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">lineHeight</span><span class="p">)</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">);</span>
    <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">placeholder</span> <span class="nf">drawAtPoint</span><span class="p">:</span><span class="n">point</span> <span class="nf">withAttributes</span><span class="p">:</span><span class="n">dictM</span><span class="p">];</span>
<span class="p">}</span>

    <span class="c1">//textfield placeholder 居中并改变颜色</span>
    <span class="n">NSMutableParagraphStyle</span> <span class="o">*</span><span class="n">style</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSMutableParagraphStyle</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
    <span class="n">style</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">NSTextAlignmentCenter</span><span class="p">;</span>
    <span class="n">NSAttributedString</span> <span class="o">*</span><span class="n">attri</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSAttributedString</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithString</span><span class="p">:</span><span class="s">@"输入提现金额"</span>              <span class="nf">attributes</span><span class="p">:@{</span><span class="n">NSForegroundColorAttributeName</span><span class="o">:</span><span class="n">RGB_COLOR</span><span class="p">(</span><span class="s">@"#8c8c8c"</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span><span class="n">NSFontAttributeName</span><span class="o">:</span><span class="n">SYS_Font</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>      <span class="n">NSParagraphStyleAttributeName</span><span class="o">:</span><span class="n">style</span><span class="p">}];</span>
    <span class="n">_cyConView</span><span class="p">.</span><span class="n">cyWantTF</span><span class="p">.</span><span class="n">attributedPlaceholder</span> <span class="o">=</span> <span class="n">attri</span><span class="p">;</span>

</code></pre></div></div>

<h4 id="八键盘">八、键盘</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="p">[</span><span class="n">IQKeyboardManager</span> <span class="nf">sharedManager</span><span class="p">].</span><span class="n">enable</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
    <span class="p">[</span><span class="n">IQKeyboardManager</span> <span class="nf">sharedManager</span><span class="p">].</span><span class="n">shouldResignOnTouchOutside</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
    <span class="p">[</span><span class="n">IQKeyboardManager</span> <span class="nf">sharedManager</span><span class="p">].</span><span class="n">enableAutoToolbar</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="九刷新">九、刷新</h4>

<p><code class="language-plaintext highlighter-rouge">MJRefreshNormalHeader</code>、<code class="language-plaintext highlighter-rouge">MJRefreshBackNormalFooter</code></p>

<h4 id="十打印字体">十、打印字体</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">NSArray</span> <span class="o">*</span> <span class="n">fontArrays</span> <span class="o">=</span> <span class="p">[[</span><span class="n">UIFont</span> <span class="nf">familyNames</span><span class="p">]</span> <span class="nf">sortedArrayUsingComparator</span><span class="p">:</span><span class="o">^</span><span class="n">NSComparisonResult</span><span class="p">(</span><span class="n">id</span>  <span class="n">_Nonnull</span> <span class="n">obj1</span><span class="p">,</span> <span class="n">id</span>  <span class="n">_Nonnull</span> <span class="n">obj2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">NSString</span> <span class="o">*</span><span class="n">str1</span> <span class="o">=</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">obj1</span><span class="p">;</span>
        <span class="n">NSString</span> <span class="o">*</span><span class="n">str2</span> <span class="o">=</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">obj2</span><span class="p">;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">str1</span> <span class="nf">compare</span><span class="p">:</span><span class="n">str2</span><span class="p">];</span>
    <span class="p">}];</span>
    <span class="k">for</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">fontfamilyname</span> <span class="k">in</span> <span class="n">fontArrays</span><span class="p">){</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">@"family:'%@'"</span><span class="p">,</span><span class="n">fontfamilyname</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">fontName</span> <span class="k">in</span> <span class="p">[</span><span class="n">UIFont</span> <span class="nf">fontNamesForFamilyName</span><span class="p">:</span><span class="n">fontfamilyname</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="n">NSLog</span><span class="p">(</span><span class="s">@"</span><span class="se">\t</span><span class="s">font:'%@'"</span><span class="p">,</span><span class="n">fontName</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">@"-------------"</span><span class="p">);</span>
    <span class="p">}</span>
</code></pre></div></div>

<h4 id="十一元素替换">十一、元素替换</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">NSMutableDictionary</span> <span class="o">*</span><span class="n">needReloadDic</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSMutableDictionary</span> <span class="nf">dictionaryWithDictionary</span><span class="p">:</span><span class="n">_dataArray</span><span class="p">[</span><span class="n">btn</span><span class="p">.</span><span class="n">tag</span> <span class="o">-</span> <span class="mi">202</span><span class="p">]];</span>
    <span class="p">[</span><span class="n">needReloadDic</span> <span class="nf">setValue</span><span class="p">:</span><span class="n">isAtt</span> <span class="nf">forKey</span><span class="p">:</span><span class="s">@"isAttention"</span><span class="p">];</span>
    <span class="n">NSMutableArray</span> <span class="o">*</span><span class="n">m_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSMutableArray</span> <span class="nf">arrayWithArray</span><span class="p">:</span><span class="n">_dataArray</span><span class="p">];</span>
    <span class="p">[</span><span class="n">m_arr</span> <span class="nf">replaceObjectAtIndex</span><span class="p">:(</span><span class="n">btn</span><span class="p">.</span><span class="n">tag</span> <span class="o">-</span> <span class="mi">202</span><span class="p">)</span> <span class="nf">withObject</span><span class="p">:</span><span class="n">needReloadDic</span><span class="p">];</span>
    <span class="n">_dataArray</span> <span class="o">=</span> <span class="p">[</span><span class="n">m_arr</span> <span class="nf">mutableCopy</span><span class="p">];</span>
    <span class="n">NSIndexPath</span> <span class="o">*</span><span class="n">indexPath</span><span class="o">=</span><span class="p">[</span><span class="n">NSIndexPath</span> <span class="nf">indexPathForRow</span><span class="p">:(</span><span class="n">btn</span><span class="p">.</span><span class="n">tag</span> <span class="o">-</span> <span class="mi">202</span><span class="p">)</span> <span class="nf">inSection</span><span class="p">:</span><span class="mi">0</span><span class="p">];</span>
    <span class="p">[</span><span class="n">_tableView</span> <span class="nf">reloadRowsAtIndexPaths</span><span class="p">:[</span><span class="n">NSArray</span> <span class="nf">arrayWithObjects</span><span class="p">:</span><span class="n">indexPath</span><span class="p">,</span><span class="nb">nil</span><span class="p">]</span> <span class="nf">withRowAnimation</span><span class="p">:</span><span class="n">UITableViewRowAnimationNone</span><span class="p">];</span>
</code></pre></div></div>

<h4 id="十二url转换">十二、url转换</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">//1.数据请求时URL含有中文，需要转码为UTF8</span>
    <span class="n">NSString</span> <span class="o">*</span> <span class="n">encodingString</span> <span class="o">=</span> <span class="p">[</span><span class="n">urlString</span> <span class="nf">stringByAddingPercentEscapesUsingEncoding</span><span class="p">:</span><span class="n">NSUTF8StringEncoding</span><span class="p">];</span>
    <span class="c1">//2.数据请求时，得到的URL有中文乱码，可以按如下方式转码 </span>
    <span class="n">NSString</span> <span class="o">*</span><span class="n">decodeString</span> <span class="o">=</span> <span class="p">[</span><span class="n">urlString</span> <span class="nf">stringByReplacingPercentEscapesUsingEncoding</span><span class="p">:</span><span class="n">NSUTF8StringEncoding</span><span class="p">];</span>
</code></pre></div></div>

<h4 id="十三按钮上图下文字">十三、按钮上图下文字</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">CGFloat</span> <span class="n">totalH</span> <span class="o">=</span> <span class="n">_ruleBtn</span><span class="p">.</span><span class="n">imageView</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span> <span class="k">+</span> <span class="n">_ruleBtn</span><span class="p">.</span><span class="n">titleLabel</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="p">;</span>
    <span class="n">CGFloat</span> <span class="n">spaceH</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="c1">//设置按钮图片偏移</span>
    <span class="p">[</span><span class="n">_ruleBtn</span> <span class="nf">setImageEdgeInsets</span><span class="p">:</span><span class="n">UIEdgeInsetsMake</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">totalH</span> <span class="o">-</span> <span class="n">_ruleBtn</span><span class="p">.</span><span class="n">imageView</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="p">),</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">_ruleBtn</span><span class="p">.</span><span class="n">titleLabel</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">)];</span>
    <span class="c1">//设置按钮标题偏移</span>
    <span class="p">[</span><span class="n">_ruleBtn</span> <span class="nf">setTitleEdgeInsets</span><span class="p">:</span><span class="n">UIEdgeInsetsMake</span><span class="p">(</span><span class="n">spaceH</span><span class="p">,</span> <span class="o">-</span><span class="n">_ruleBtn</span><span class="p">.</span><span class="n">imageView</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">totalH</span> <span class="o">-</span> <span class="n">_ruleBtn</span><span class="p">.</span><span class="n">titleLabel</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="p">),</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">)];</span>
</code></pre></div></div>

<h4 id="十四监听输入变化">十四、监听输入变化</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#pragma mark - textfield 监听字数变化
</span><span class="k">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">textFiledEditChanged</span><span class="p">:(</span><span class="n">NSNotification</span> <span class="o">*</span><span class="p">)</span><span class="nv">noti</span> <span class="p">{</span>
    <span class="n">MyTextField</span> <span class="o">*</span><span class="n">textField</span> <span class="o">=</span> <span class="p">(</span><span class="n">MyTextField</span> <span class="o">*</span><span class="p">)</span><span class="n">noti</span><span class="p">.</span><span class="n">object</span><span class="p">;</span>
    <span class="n">NSString</span> <span class="o">*</span><span class="n">toBeString</span> <span class="o">=</span> <span class="n">textField</span><span class="p">.</span><span class="n">text</span><span class="p">;</span>
    <span class="n">NSString</span> <span class="o">*</span><span class="n">lang</span> <span class="o">=</span> <span class="p">[[[</span><span class="n">UITextInputMode</span> <span class="nf">activeInputModes</span><span class="p">]</span><span class="nf">firstObject</span><span class="p">]</span> <span class="nf">primaryLanguage</span><span class="p">];</span> <span class="c1">// 键盘输入模式</span>
    <span class="k">if</span> <span class="p">([</span><span class="n">lang</span> <span class="nf">isEqualToString</span><span class="p">:</span><span class="s">@"zh-Hans"</span><span class="p">])</span> <span class="p">{</span> <span class="c1">// 简体中文输入，包括简体拼音，健体五笔，简体手写</span>
        <span class="n">UITextRange</span> <span class="o">*</span><span class="n">selectedRange</span> <span class="o">=</span> <span class="p">[</span><span class="n">textField</span> <span class="nf">markedTextRange</span><span class="p">];</span><span class="c1">//获取高亮部分</span>
        <span class="n">UITextPosition</span> <span class="o">*</span><span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="n">textField</span> <span class="nf">positionFromPosition</span><span class="p">:</span><span class="n">selectedRange</span><span class="p">.</span><span class="n">start</span> <span class="nf">offset</span><span class="p">:</span><span class="mi">0</span><span class="p">];</span>
        <span class="c1">//没有高亮选择的字，则对已输入的文字进行字数统计和限制</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">position</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">toBeString</span><span class="p">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">textField</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="n">toBeString</span> <span class="nf">substringToIndex</span><span class="p">:</span><span class="mi">20</span><span class="p">];</span>
                <span class="n">signature_num</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="s">@"%lu/20"</span><span class="p">,(</span><span class="mi">20</span><span class="o">-</span><span class="n">textField</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">length</span><span class="p">)];</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                <span class="n">signature_num</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="s">@"%lu/20"</span><span class="p">,(</span><span class="mi">20</span><span class="o">-</span><span class="n">toBeString</span><span class="p">.</span><span class="n">length</span><span class="p">)];</span>
            <span class="p">}</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="c1">//有高亮选择的字符串，则暂不对文字进行统计和限制</span>
        <span class="p">}</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="c1">// 中文输入法以外的直接对其统计限制即可，不考虑其他语种情况</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">toBeString</span><span class="p">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">textField</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="n">toBeString</span> <span class="nf">substringToIndex</span><span class="p">:</span><span class="mi">20</span><span class="p">];</span>
            <span class="n">signature_num</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="s">@"%lu/20"</span><span class="p">,(</span><span class="mi">20</span><span class="o">-</span><span class="n">textField</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">length</span><span class="p">)];</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">signature_num</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="s">@"%lu/20"</span><span class="p">,(</span><span class="mi">20</span><span class="o">-</span><span class="n">toBeString</span><span class="p">.</span><span class="n">length</span><span class="p">)];</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="十五json转化">十五、json转化</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">NSData</span> <span class="o">*</span><span class="n">jsonData</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSJSONSerialization</span> <span class="nf">dataWithJSONObject</span><span class="p">:</span><span class="n">mix</span> <span class="nf">options</span><span class="p">:</span><span class="n">NSJSONWritingPrettyPrinted</span> <span class="n">error</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span>
    <span class="n">NSString</span> <span class="o">*</span><span class="n">jsonStr</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSString</span> <span class="nf">alloc</span><span class="p">]</span><span class="nf">initWithData</span><span class="p">:</span><span class="n">jsonData</span> <span class="nf">encoding</span><span class="p">:</span><span class="n">NSUTF8StringEncoding</span><span class="p">];</span>
    <span class="c1">//去除空格、回车</span>
    <span class="n">jsonStr</span> <span class="o">=</span> <span class="p">[</span><span class="n">jsonStr</span> <span class="nf">stringByTrimmingCharactersInSet</span><span class="p">:[</span><span class="n">NSCharacterSet</span> <span class="nf">whitespaceAndNewlineCharacterSet</span><span class="p">]];</span>
    <span class="n">jsonStr</span> <span class="o">=</span> <span class="p">[</span><span class="n">jsonStr</span> <span class="nf">stringByReplacingOccurrencesOfString</span><span class="p">:</span><span class="s">@" "</span> <span class="nf">withString</span><span class="p">:</span><span class="s">@""</span><span class="p">];</span>
    <span class="n">jsonStr</span> <span class="o">=</span> <span class="p">[</span><span class="n">jsonStr</span> <span class="nf">stringByReplacingOccurrencesOfString</span><span class="p">:</span><span class="s">@"</span><span class="se">\n</span><span class="s">"</span> <span class="nf">withString</span><span class="p">:</span><span class="s">@""</span><span class="p">];</span>
    
    <span class="n">NSData</span> <span class="o">*</span><span class="n">mix_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">locationContent</span><span class="p">.</span><span class="n">address</span> <span class="nf">dataUsingEncoding</span><span class="p">:</span><span class="n">NSUTF8StringEncoding</span><span class="p">];</span>
    <span class="n">NSDictionary</span> <span class="o">*</span><span class="n">mix_dic</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSJSONSerialization</span> <span class="nf">JSONObjectWithData</span><span class="p">:</span><span class="n">mix_data</span> <span class="nf">options</span><span class="p">:</span><span class="n">NSJSONReadingAllowFragments</span> <span class="n">error</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span>
</code></pre></div></div>

<h4 id="十六手势冲突解决">十六、手势冲突解决</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#pragma mark - 左右滑动拦截处理
</span><span class="k">-</span><span class="p">(</span><span class="n">BOOL</span><span class="p">)</span><span class="nf">gestureRecognizerShouldBegin</span><span class="p">:(</span><span class="n">UIGestureRecognizer</span> <span class="o">*</span><span class="p">)</span><span class="nv">gestureRecognizer</span> <span class="p">{</span>
    
    <span class="k">if</span> <span class="p">([</span><span class="n">gestureRecognizer</span> <span class="nf">isKindOfClass</span><span class="p">:[</span><span class="n">UISwipeGestureRecognizer</span> <span class="nf">class</span><span class="p">]])</span> <span class="p">{</span>
        <span class="n">UISwipeGestureRecognizer</span> <span class="o">*</span><span class="n">swipG</span> <span class="o">=</span> <span class="p">(</span><span class="n">UISwipeGestureRecognizer</span> <span class="o">*</span><span class="p">)</span><span class="n">gestureRecognizer</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">swipG</span><span class="p">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">UISwipeGestureRecognizerDirectionLeft</span> <span class="o">&amp;&amp;</span> <span class="p">[[</span><span class="n">Config</span> <span class="nf">getLeftSlip</span><span class="p">]</span> <span class="nf">isEqual</span><span class="p">:</span><span class="s">@"1"</span><span class="p">])</span> <span class="p">{</span>
            <span class="n">_backScrollView</span><span class="p">.</span><span class="n">scrollEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
            <span class="p">[</span><span class="n">Config</span> <span class="nf">saveLeftSlip</span><span class="p">:</span><span class="s">@"0"</span><span class="p">];</span>
            <span class="c1">//向左</span>
            <span class="p">[</span><span class="n">PublicView</span> <span class="nf">showLeftSilpCancel</span><span class="p">:</span><span class="nb">nil</span> <span class="nf">Sure</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">type</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">_backScrollView</span><span class="p">.</span><span class="n">scrollEnabled</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
            <span class="p">}];</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">swipG</span><span class="p">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">UISwipeGestureRecognizerDirectionRight</span> <span class="o">&amp;&amp;</span> <span class="p">[[</span><span class="n">Config</span> <span class="nf">getRightSlip</span><span class="p">]</span> <span class="nf">isEqual</span><span class="p">:</span><span class="s">@"1"</span><span class="p">]){</span>
            <span class="n">_backScrollView</span><span class="p">.</span><span class="n">scrollEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
            <span class="p">[</span><span class="n">Config</span> <span class="nf">saveRightSlip</span><span class="p">:</span><span class="s">@"0"</span><span class="p">];</span>
            <span class="c1">//向右</span>
            <span class="p">[</span><span class="n">PublicView</span> <span class="nf">showRightSilpCancel</span><span class="p">:</span><span class="nb">nil</span> <span class="nf">Sure</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">type</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">_backScrollView</span><span class="p">.</span><span class="n">scrollEnabled</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
            <span class="p">}];</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nb">NO</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">_backScrollView</span><span class="p">.</span><span class="n">scrollEnabled</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
    <span class="k">return</span> <span class="nb">YES</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">-</span><span class="p">(</span><span class="n">BOOL</span><span class="p">)</span><span class="nf">gestureRecognizer</span><span class="p">:(</span><span class="n">UIGestureRecognizer</span><span class="o">*</span><span class="p">)</span> <span class="n">gestureRecognizer</span> <span class="n">shouldRecognizeSimultaneouslyWithGestureRecognizer</span><span class="o">:</span><span class="p">(</span><span class="n">UIGestureRecognizer</span><span class="o">*</span><span class="p">)</span><span class="nv">otherGestureRecognizer</span><span class="p">{</span>
    <span class="k">if</span> <span class="p">([</span><span class="n">otherGestureRecognizer</span><span class="p">.</span><span class="n">view</span> <span class="nf">isKindOfClass</span><span class="p">:[</span><span class="n">self</span><span class="p">.</span><span class="n">view</span> <span class="nf">class</span><span class="p">]])</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">otherGestureRecognizer</span><span class="p">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">UIGestureRecognizerStateBegan</span> <span class="o">&amp;&amp;</span><span class="p">[</span><span class="n">_censhi</span> <span class="nf">isEqual</span><span class="p">:</span><span class="s">@"1"</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">YES</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">_backScrollView</span><span class="p">.</span><span class="n">scrollEnabled</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
    <span class="k">return</span> <span class="nb">NO</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="十七按钮下划线">十七、按钮下划线</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">NSMutableAttributedString</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSMutableAttributedString</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithString</span><span class="p">:</span><span class="s">@"等级说明?"</span><span class="p">];</span>
    <span class="n">NSRange</span> <span class="n">strRange</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,[</span><span class="n">str</span> <span class="nf">length</span><span class="p">]};</span>
    <span class="c1">//    [str addAttribute:NSUnderlineStyleAttributeName value:[NSNumber numberWithInteger:NSUnderlineStyleSingle] range:strRange];</span>
    <span class="p">[</span><span class="n">str</span> <span class="nf">addAttributes</span><span class="p">:[</span><span class="n">NSDictionary</span> <span class="nf">dictionaryWithObjectsAndKeys</span><span class="p">:[</span><span class="n">NSNumber</span> <span class="nf">numberWithInteger</span><span class="p">:</span><span class="n">NSUnderlineStyleSingle</span><span class="p">],</span><span class="n">NSUnderlineStyleAttributeName</span><span class="p">,</span><span class="n">RGB</span><span class="p">(</span><span class="mi">170</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">NSForegroundColorAttributeName</span><span class="p">,</span><span class="nb">nil</span><span class="p">]</span> <span class="nf">range</span><span class="p">:</span><span class="n">strRange</span><span class="p">];</span>
    <span class="p">[</span><span class="n">_privateBtn</span> <span class="nf">setAttributedTitle</span><span class="p">:</span><span class="n">str</span> <span class="nf">forState</span><span class="p">:</span><span class="n">UIControlStateNormal</span><span class="p">];</span>
    <span class="p">[</span><span class="n">_privateBtn</span> <span class="nf">setTitleColor</span><span class="p">:</span><span class="n">RGB</span><span class="p">(</span><span class="mi">170</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="nf">forState</span><span class="p">:</span><span class="mi">0</span><span class="p">];</span>
</code></pre></div></div>

<h4 id="十八导航">十八、导航</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="p">[[</span><span class="n">UINavigationBar</span> <span class="nf">appearance</span><span class="p">]</span> <span class="nf">setBarTintColor</span><span class="p">:</span><span class="n">UIColor</span><span class="p">.</span><span class="n">blackColor</span><span class="p">];</span>
    <span class="p">[[</span><span class="n">UINavigationBar</span> <span class="nf">appearance</span><span class="p">]</span> <span class="nf">setTintColor</span><span class="p">:[</span><span class="n">UIColor</span> <span class="nf">whiteColor</span><span class="p">]];</span>
    <span class="p">[[</span><span class="n">UINavigationBar</span> <span class="nf">appearance</span><span class="p">]</span> <span class="nf">setTitleTextAttributes</span><span class="p">:@{</span><span class="n">NSFontAttributeName</span><span class="o">:</span><span class="p">[</span><span class="n">UIFont</span> <span class="nf">systemFontOfSize</span><span class="p">:</span><span class="mi">18</span><span class="p">],</span><span class="n">NSForegroundColorAttributeName</span><span class="o">:</span><span class="p">[</span><span class="n">UIColor</span> <span class="nf">whiteColor</span><span class="p">]}];</span>
    <span class="p">[[</span><span class="n">UINavigationBar</span> <span class="nf">appearance</span><span class="p">]</span> <span class="nf">setBackgroundImage</span><span class="p">:[</span><span class="n">UIImage</span> <span class="nf">imageNamed</span><span class="p">:</span><span class="s">@"transparent.png"</span><span class="p">]</span> <span class="nf">forBarMetrics</span><span class="p">:</span><span class="n">UIBarMetricsDefault</span><span class="p">];</span>
    <span class="p">[[</span><span class="n">UINavigationBar</span> <span class="nf">appearance</span><span class="p">]</span> <span class="nf">setShadowImage</span><span class="p">:[</span><span class="n">UIImage</span> <span class="nf">new</span><span class="p">]];</span>
</code></pre></div></div>

<h4 id="十九横竖屏">十九、横竖屏</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#pragma mark - 进入全屏
</span><span class="k">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">EnterFullScreen</span> <span class="p">{</span>
    
    <span class="n">CGFloat</span> <span class="n">full_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">_window_height</span><span class="o">-</span><span class="n">_window_width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="n">videoView</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">CGRectMake</span><span class="p">(</span><span class="o">-</span><span class="n">full_y</span><span class="p">,</span> <span class="n">full_y</span><span class="p">,</span> <span class="n">_window_height</span><span class="p">,</span> <span class="n">_window_width</span><span class="p">);</span>
    <span class="n">_exitScreenBtn</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">CGRectMake</span><span class="p">(</span><span class="n">_window_height</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="n">_window_width</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">);</span>
    <span class="p">[</span><span class="n">_player</span><span class="p">.</span><span class="n">view</span> <span class="nf">setFrame</span><span class="p">:</span> <span class="n">videoView</span><span class="p">.</span><span class="n">bounds</span><span class="p">];</span>
    <span class="n">_fullScreenBtn</span><span class="p">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
    <span class="p">[</span><span class="n">UIView</span> <span class="nf">animateWithDuration</span><span class="p">:</span><span class="mi">0</span><span class="p">.</span><span class="mi">25</span> <span class="nf">animations</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
        <span class="n">videoView</span><span class="p">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">CGAffineTransformMakeRotation</span><span class="p">(</span><span class="n">M_PI_2</span><span class="p">);</span>
    <span class="p">}</span> <span class="n">completion</span><span class="o">:^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">finished</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_isGameFull</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
        <span class="n">_exitScreenBtn</span><span class="p">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
        <span class="p">[</span><span class="n">self</span> <span class="nf">setNeedsStatusBarAppearanceUpdate</span><span class="p">];</span>
        <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">view</span> <span class="nf">bringSubviewToFront</span><span class="p">:</span><span class="n">videoView</span><span class="p">];</span>
        <span class="p">[</span><span class="n">videoView</span> <span class="nf">bringSubviewToFront</span><span class="p">:</span><span class="n">_exitScreenBtn</span><span class="p">];</span>
    <span class="p">}];</span>
<span class="p">}</span>
<span class="cp">#pragma mark - 退出p全屏
</span><span class="k">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">exitFullScreen</span> <span class="p">{</span>
    
    <span class="p">[</span><span class="n">UIView</span> <span class="nf">animateWithDuration</span><span class="p">:</span><span class="mi">0</span><span class="p">.</span><span class="mi">25</span> <span class="nf">animations</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
        <span class="n">videoView</span><span class="p">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">CGAffineTransformIdentity</span><span class="p">;</span>
        <span class="n">videoView</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">CGRectMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">_window_width</span><span class="p">,</span> <span class="n">_window_height</span><span class="p">);</span>
        <span class="p">[</span><span class="n">_player</span><span class="p">.</span><span class="n">view</span> <span class="nf">setFrame</span><span class="p">:</span> <span class="n">videoView</span><span class="p">.</span><span class="n">bounds</span><span class="p">];</span>
    <span class="p">}</span> <span class="n">completion</span><span class="o">:^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">finished</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_isGameFull</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
        <span class="n">_fullScreenBtn</span><span class="p">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
        <span class="n">_exitScreenBtn</span><span class="p">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
        <span class="p">[</span><span class="n">self</span> <span class="nf">setNeedsStatusBarAppearanceUpdate</span><span class="p">];</span>
        <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">view</span> <span class="nf">sendSubviewToBack</span><span class="p">:</span><span class="n">videoView</span><span class="p">];</span>
        <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">view</span> <span class="nf">sendSubviewToBack</span><span class="p">:</span><span class="n">_pkBackImgView</span><span class="p">];</span>
    <span class="p">}];</span>
<span class="p">}</span>
<span class="k">-</span> <span class="p">(</span><span class="n">BOOL</span><span class="p">)</span><span class="n">prefersStatusBarHidden</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">_isGameFull</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="二十图片加文字">二十、图片加文字</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1.将文字添加到图片上;imageName 图片名字， text 需画的字体</span>
<span class="k">-</span> <span class="p">(</span><span class="n">UIImage</span> <span class="o">*</span><span class="p">)</span><span class="nf">createShareImage</span><span class="p">:(</span><span class="n">UIImage</span> <span class="o">*</span><span class="p">)</span><span class="nv">tImage</span> <span class="nf">Context</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">text</span> <span class="p">{</span>
    <span class="n">UIImage</span> <span class="o">*</span><span class="n">sourceImage</span> <span class="o">=</span> <span class="n">tImage</span><span class="p">;</span>
    <span class="n">CGSize</span> <span class="n">imageSize</span><span class="p">;</span> <span class="c1">//画的背景 大小</span>
    <span class="n">imageSize</span> <span class="o">=</span> <span class="p">[</span><span class="n">sourceImage</span> <span class="nf">size</span><span class="p">];</span>
    <span class="n">UIGraphicsBeginImageContextWithOptions</span><span class="p">(</span><span class="n">imageSize</span><span class="p">,</span> <span class="nb">NO</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">[</span><span class="n">sourceImage</span> <span class="nf">drawAtPoint</span><span class="p">:</span><span class="n">CGPointMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)];</span>
    <span class="c1">//获得 图形上下文</span>
    <span class="n">CGContextRef</span> <span class="n">context</span><span class="o">=</span><span class="n">UIGraphicsGetCurrentContext</span><span class="p">();</span>
    <span class="n">CGContextDrawPath</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">kCGPathStroke</span><span class="p">);</span>
    <span class="n">CGFloat</span> <span class="n">nameFont</span> <span class="o">=</span> <span class="mi">8</span><span class="p">.</span><span class="n">f</span><span class="p">;</span>
    <span class="c1">//画 自己想要画的内容</span>
    <span class="n">NSDictionary</span> <span class="o">*</span><span class="n">attributes</span> <span class="o">=</span> <span class="p">@{</span><span class="n">NSFontAttributeName</span><span class="o">:</span><span class="p">[</span><span class="n">UIFont</span> <span class="nf">systemFontOfSize</span><span class="p">:</span><span class="n">nameFont</span><span class="p">]};</span>
    <span class="n">CGRect</span> <span class="n">sizeToFit</span> <span class="o">=</span> <span class="p">[</span><span class="n">text</span> <span class="nf">boundingRectWithSize</span><span class="p">:</span><span class="n">CGSizeMake</span><span class="p">(</span><span class="n">CGFLOAT_MAX</span><span class="p">,</span> <span class="n">nameFont</span><span class="p">)</span> <span class="nf">options</span><span class="p">:</span><span class="n">NSStringDrawingUsesDeviceMetrics</span> <span class="n">attributes</span><span class="o">:</span><span class="n">attributes</span> <span class="n">context</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"图片: %f %f"</span><span class="p">,</span><span class="n">imageSize</span><span class="p">.</span><span class="n">width</span><span class="p">,</span><span class="n">imageSize</span><span class="p">.</span><span class="n">height</span><span class="p">);</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"sizeToFit: %f %f"</span><span class="p">,</span><span class="n">sizeToFit</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">,</span><span class="n">sizeToFit</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="p">);</span>
    <span class="n">CGContextSetFillColorWithColor</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="p">[</span><span class="n">UIColor</span> <span class="nf">blackColor</span><span class="p">].</span><span class="n">CGColor</span><span class="p">);</span>
    <span class="p">[</span><span class="n">text</span> <span class="nf">drawAtPoint</span><span class="p">:</span><span class="n">CGPointMake</span><span class="p">((</span><span class="n">imageSize</span><span class="p">.</span><span class="n">width</span><span class="o">-</span><span class="n">sizeToFit</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="nf">withAttributes</span><span class="p">:@{</span><span class="n">NSFontAttributeName</span><span class="o">:</span><span class="p">[</span><span class="n">UIFont</span> <span class="nf">systemFontOfSize</span><span class="p">:</span><span class="n">nameFont</span><span class="p">]}];</span>
    <span class="c1">//返回绘制的新图形</span>
    
    <span class="n">UIImage</span> <span class="o">*</span><span class="n">newImage</span><span class="o">=</span><span class="n">UIGraphicsGetImageFromCurrentImageContext</span><span class="p">();</span>
    
    <span class="n">UIGraphicsEndImageContext</span><span class="p">();</span>
    <span class="k">return</span> <span class="n">newImage</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="二十一根据视频地址获取封面">二十一、根据视频地址获取封面</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">-</span><span class="p">(</span><span class="kt">void</span> <span class="p">)</span><span class="nf">getImageWithTime</span><span class="p">:(</span><span class="n">CMTime</span><span class="p">)</span><span class="nv">time</span> <span class="p">{</span>
    <span class="c1">//NSURL *videoUrl = [[NSBundle mainBundle] URLForResource:@"hubblecast.m4v" withExtension:nil];</span>
    <span class="n">NSURL</span> <span class="o">*</span><span class="n">videoUrl</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSURL</span> <span class="nf">URLWithString</span><span class="p">:</span><span class="s">@"https://dspdemo-1258629649.cos.ap-shanghai.myqcloud.com/13629_IOS_20190218170618.mp4"</span><span class="p">];</span>
    <span class="n">AVAsset</span> <span class="o">*</span><span class="n">videoAsset</span> <span class="o">=</span> <span class="p">[</span><span class="n">AVAsset</span> <span class="nf">assetWithURL</span><span class="p">:</span><span class="n">videoUrl</span><span class="p">];</span>
    
    <span class="n">AVAssetImageGenerator</span> <span class="o">*</span><span class="n">imageGenerator</span> <span class="o">=</span> <span class="p">[</span><span class="n">AVAssetImageGenerator</span> <span class="nf">assetImageGeneratorWithAsset</span><span class="p">:</span><span class="n">videoAsset</span><span class="p">];</span>
    <span class="n">imageGenerator</span><span class="p">.</span><span class="n">maximumSize</span> <span class="o">=</span> <span class="n">CGSizeMake</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span><span class="c1">//按比例生成， 不指定会默认视频原来的格式大小</span>
    <span class="n">CMTime</span> <span class="n">actualTime</span><span class="p">;</span><span class="c1">//获取到图片确切的时间</span>
    <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
    <span class="n">CGImageRef</span> <span class="n">CGImage</span> <span class="o">=</span> <span class="p">[</span><span class="n">imageGenerator</span> <span class="nf">copyCGImageAtTime</span><span class="p">:</span><span class="n">time</span> <span class="nf">actualTime</span><span class="p">:</span><span class="o">&amp;</span><span class="n">actualTime</span> <span class="n">error</span><span class="o">:&amp;</span><span class="n">error</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
        
        <span class="n">UIImage</span> <span class="o">*</span><span class="n">image</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIImage</span> <span class="nf">imageWithCGImage</span><span class="p">:</span><span class="n">CGImage</span><span class="p">];</span>
        <span class="n">CMTimeShow</span><span class="p">(</span><span class="n">actualTime</span><span class="p">);</span>   <span class="c1">//{111600/90000 = 1.240}</span>
        <span class="n">CMTimeShow</span><span class="p">(</span><span class="n">time</span><span class="p">);</span> <span class="c1">// {1/1 = 1.000}</span>
        
        <span class="n">UIImageView</span> <span class="o">*</span><span class="n">imgIV</span> <span class="o">=</span> <span class="p">[[</span><span class="n">UIImageView</span> <span class="nf">alloc</span><span class="p">]</span><span class="nf">initWithFrame</span><span class="p">:</span><span class="n">CGRectMake</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="n">_window_width</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">)];</span>
        <span class="n">imgIV</span><span class="p">.</span><span class="n">contentMode</span> <span class="o">=</span> <span class="n">UIViewContentModeScaleAspectFill</span><span class="p">;</span>
        <span class="n">imgIV</span><span class="p">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="p">;</span>
        <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">view</span> <span class="nf">addSubview</span><span class="p">:</span><span class="n">imgIV</span><span class="p">];</span>  
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="二十二外放">二十二、外放</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">UInt32</span> <span class="n">sessionCategory</span> <span class="o">=</span> <span class="n">kAudioSessionCategory_MediaPlayback</span><span class="p">;</span>
    <span class="n">AudioSessionSetProperty</span><span class="p">(</span><span class="n">kAudioSessionProperty_AudioCategory</span><span class="p">,</span>
                            <span class="k">sizeof</span><span class="p">(</span><span class="n">sessionCategory</span><span class="p">),</span>
                            <span class="o">&amp;</span><span class="n">sessionCategory</span><span class="p">);</span>
    
    <span class="n">UInt32</span> <span class="n">audioRouteOverride</span> <span class="o">=</span> <span class="n">kAudioSessionOverrideAudioRoute_Speaker</span><span class="p">;</span>
    <span class="n">AudioSessionSetProperty</span> <span class="p">(</span><span class="n">kAudioSessionProperty_OverrideAudioRoute</span><span class="p">,</span>
                             <span class="k">sizeof</span> <span class="p">(</span><span class="n">audioRouteOverride</span><span class="p">),</span>
                             <span class="o">&amp;</span><span class="n">audioRouteOverride</span><span class="p">);</span>
    
    <span class="n">AVAudioSession</span> <span class="o">*</span><span class="n">audioSession</span> <span class="o">=</span> <span class="p">[</span><span class="n">AVAudioSession</span> <span class="nf">sharedInstance</span><span class="p">];</span>
    <span class="c1">//默认情况下扬声器播放</span>
    <span class="p">[</span><span class="n">audioSession</span> <span class="nf">setCategory</span><span class="p">:</span><span class="n">AVAudioSessionCategoryPlayback</span> <span class="nf">error</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
    <span class="p">[</span><span class="n">audioSession</span> <span class="nf">setActive</span><span class="p">:</span><span class="nb">YES</span> <span class="nf">error</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</code></pre></div></div>

<h4 id="二十三延时">二十三、延时</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">//设置延时</span>
    <span class="p">[</span><span class="n">self</span> <span class="nf">performSelector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="nf">doRotation</span><span class="p">:)</span> <span class="n">withObject</span><span class="o">:</span><span class="nb">nil</span> <span class="n">afterDelay</span><span class="o">:</span><span class="mi">17</span><span class="p">.</span><span class="mi">0</span><span class="p">];</span>
    <span class="c1">//取消延时</span>
    <span class="p">[</span><span class="n">NSObject</span> <span class="nf">cancelPreviousPerformRequestsWithTarget</span><span class="p">:</span><span class="n">self</span> <span class="nf">selector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">doRotation</span><span class="o">:</span><span class="p">)</span> <span class="n">object</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span>
</code></pre></div></div>

<h4 id="二十四存储沙盒">二十四、存储沙盒</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">nslogToFile</span> <span class="p">{</span>
    <span class="n">NSArray</span> <span class="o">*</span><span class="n">paths</span> <span class="o">=</span> <span class="n">NSSearchPathForDirectoriesInDomains</span><span class="p">(</span><span class="n">NSDocumentDirectory</span><span class="p">,</span> <span class="n">NSUserDomainMask</span><span class="p">,</span> <span class="nb">YES</span><span class="p">);</span>
    <span class="n">NSString</span> <span class="o">*</span><span class="n">documentDirectory</span> <span class="o">=</span> <span class="p">[</span><span class="n">paths</span> <span class="nf">objectAtIndex</span><span class="p">:</span><span class="mi">0</span><span class="p">];</span>
    <span class="n">NSString</span> <span class="o">*</span><span class="n">fileName</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="s">@"NSLog.txt"</span><span class="p">];</span><span class="c1">// 注意不是NSData!</span>
    <span class="n">NSString</span> <span class="o">*</span><span class="n">logFilePath</span> <span class="o">=</span> <span class="p">[</span><span class="n">documentDirectory</span> <span class="nf">stringByAppendingPathComponent</span><span class="p">:</span><span class="n">fileName</span><span class="p">];</span>
    <span class="c1">// 先删除已经存在的文件</span>
    <span class="n">NSFileManager</span> <span class="o">*</span><span class="n">defaultManager</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSFileManager</span> <span class="nf">defaultManager</span><span class="p">];</span>
    <span class="p">[</span><span class="n">defaultManager</span> <span class="nf">removeItemAtPath</span><span class="p">:</span><span class="n">logFilePath</span> <span class="nf">error</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
    <span class="c1">// 将log输入到文件</span>
    <span class="n">freopen</span><span class="p">([</span><span class="n">logFilePath</span> <span class="nf">cStringUsingEncoding</span><span class="p">:</span><span class="n">NSASCIIStringEncoding</span><span class="p">],</span> <span class="s">"a+"</span><span class="p">,</span> <span class="n">stdout</span><span class="p">);</span>
    <span class="n">freopen</span><span class="p">([</span><span class="n">logFilePath</span> <span class="nf">cStringUsingEncoding</span><span class="p">:</span><span class="n">NSASCIIStringEncoding</span><span class="p">],</span> <span class="s">"a+"</span><span class="p">,</span> <span class="n">stderr</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="二十五计时器">二十五、计时器</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="p">[</span><span class="n">self</span> <span class="nf">performSelector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">hideTabBar</span><span class="p">)</span> <span class="nf">withObject</span><span class="p">:</span><span class="nb">nil</span> <span class="n">afterDelay</span><span class="o">:</span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">];</span>
    <span class="p">[</span><span class="n">NSObject</span> <span class="nf">cancelPreviousPerformRequestsWithTarget</span><span class="p">:</span><span class="n">self</span> <span class="nf">selector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">hideTabBar</span><span class="p">)</span> <span class="n">object</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span>
</code></pre></div></div>

<h4 id="二十六有没有安装应用">二十六、有没有安装应用</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#import &lt;Social/SLComposeViewController.h&gt;
#import &lt;Social/SLServiceTypes.h&gt;
</span>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">[</span><span class="n">SLComposeViewController</span> <span class="nf">isAvailableForServiceType</span><span class="p">:</span><span class="n">SLServiceTypeFacebook</span><span class="p">]){</span>
        <span class="p">[</span><span class="n">MBProgressHUD</span> <span class="nf">showError</span><span class="p">:</span><span class="s">@"您手机没有安装FaceBook,无法进行登陆"</span><span class="p">];</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre></div></div>

<h4 id="二十七afn">二十七、AFN</h4>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">session</span><span class="p">.</span><span class="n">responseSerializer</span><span class="p">.</span><span class="n">acceptableContentTypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">session</span><span class="p">.</span><span class="n">responseSerializer</span><span class="p">.</span><span class="n">acceptableContentTypes</span> <span class="nf">setByAddingObject</span><span class="p">:</span><span class="s">@"text/html”];</span><span class="err">
</span></code></pre></div></div>

<h4 id="二十八富文本标签">二十八、富文本+标签</h4>

<p><a href="https://rookie920.github.io/2019/10/25/%E5%AF%8C%E6%96%87%E6%9C%AC/">详情</a></p>

<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">-</span><span class="p">(</span><span class="n">NSMutableAttributedString</span><span class="o">*</span><span class="p">)</span><span class="nf">setFlagWithContentDic</span><span class="p">:(</span><span class="n">NSDictionary</span> <span class="o">*</span><span class="p">)</span><span class="nv">flagDic</span> <span class="nf">title</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">titleStr</span> <span class="nf">font</span><span class="p">:(</span><span class="n">CGFloat</span><span class="p">)</span><span class="nv">tFont</span> <span class="p">{</span>
    
    <span class="n">NSString</span> <span class="o">*</span><span class="n">flagStr</span> <span class="o">=</span> <span class="n">minstr</span><span class="p">([</span><span class="n">flagDic</span> <span class="nf">valueForKey</span><span class="p">:</span><span class="s">@"name"</span><span class="p">]);</span>
    <span class="n">NSString</span> <span class="o">*</span><span class="n">flagColStr</span> <span class="o">=</span> <span class="n">minstr</span><span class="p">([</span><span class="n">flagDic</span> <span class="nf">valueForKey</span><span class="p">:</span><span class="s">@"colour"</span><span class="p">]);</span>
    <span class="n">UIColor</span> <span class="o">*</span><span class="n">flagBgCol</span> <span class="o">=</span> <span class="n">RGB_COLOR</span><span class="p">(</span><span class="n">flagColStr</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    
    <span class="n">NSMutableParagraphStyle</span> <span class="o">*</span><span class="n">paragraph</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSMutableParagraphStyle</span> <span class="nf">alloc</span><span class="p">]</span><span class="nf">init</span><span class="p">];</span>
    <span class="n">paragraph</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">NSTextAlignmentCenter</span><span class="p">;</span>
    <span class="n">paragraph</span><span class="p">.</span><span class="n">lineSpacing</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="n">paragraph</span><span class="p">.</span><span class="n">hyphenationFactor</span> <span class="o">=</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
    
    <span class="n">NSString</span><span class="o">*</span><span class="n">itemName</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="s">@"%@ %@"</span><span class="p">,</span><span class="n">titleStr</span><span class="p">,</span><span class="n">flagStr</span><span class="p">];</span>
    <span class="n">NSMutableAttributedString</span> <span class="o">*</span><span class="n">titleAttrStr</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSMutableAttributedString</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithString</span><span class="p">:</span><span class="n">itemName</span> <span class="nf">attributes</span><span class="p">:@{</span><span class="n">NSFontAttributeName</span><span class="o">:</span><span class="p">[</span><span class="n">UIFont</span> <span class="nf">systemFontOfSize</span><span class="p">:</span><span class="n">tFont</span><span class="p">],</span><span class="n">NSParagraphStyleAttributeName</span><span class="o">:</span> <span class="n">paragraph</span><span class="p">,</span><span class="n">NSForegroundColorAttributeName</span><span class="o">:</span><span class="n">UIColor</span><span class="p">.</span><span class="n">whiteColor</span><span class="p">}];</span>
    <span class="c1">//设置标签的背景色</span>
    <span class="n">YYTextBorder</span> <span class="o">*</span><span class="n">border</span> <span class="o">=</span> <span class="p">[</span><span class="n">YYTextBorder</span> <span class="nf">new</span><span class="p">];</span>
    <span class="n">border</span><span class="p">.</span><span class="n">fillColor</span><span class="o">=</span> <span class="n">flagBgCol</span><span class="p">;</span>
    <span class="c1">//调整Insets更改背景显示位置</span>
    <span class="n">border</span><span class="p">.</span><span class="n">insets</span><span class="o">=</span> <span class="n">UIEdgeInsetsMake</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">border</span><span class="p">.</span><span class="n">cornerRadius</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="p">[</span><span class="n">titleAttrStr</span> <span class="nf">yy_setTextBackgroundBorder</span><span class="p">:</span><span class="n">border</span> <span class="nf">range</span><span class="p">:</span><span class="n">NSMakeRange</span><span class="p">(</span><span class="n">titleStr</span><span class="p">.</span><span class="n">length</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">flagStr</span><span class="p">.</span><span class="n">length</span><span class="p">)];</span>
    <span class="c1">//设置标签的文本颜色</span>
    <span class="p">[</span><span class="n">titleAttrStr</span> <span class="nf">yy_setColor</span><span class="p">:[</span><span class="n">UIColor</span> <span class="nf">whiteColor</span><span class="p">]</span> <span class="nf">range</span><span class="p">:</span><span class="n">NSMakeRange</span><span class="p">(</span><span class="n">titleStr</span><span class="p">.</span><span class="n">length</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">flagStr</span><span class="p">.</span><span class="n">length</span><span class="p">)];</span>
    <span class="c1">//设置标签文本的字号</span>
    <span class="p">[</span><span class="n">titleAttrStr</span> <span class="nf">yy_setFont</span><span class="p">:[</span><span class="n">UIFont</span> <span class="nf">systemFontOfSize</span><span class="p">:(</span><span class="n">tFont</span><span class="o">-</span><span class="mi">4</span><span class="p">)]</span><span class="nf">range</span><span class="p">:</span><span class="n">NSMakeRange</span><span class="p">(</span><span class="n">titleStr</span><span class="p">.</span><span class="n">length</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">flagStr</span><span class="p">.</span><span class="n">length</span><span class="p">)];</span>
    <span class="c1">//小字号偏移</span>
    <span class="p">[</span><span class="n">titleAttrStr</span> <span class="nf">addAttribute</span><span class="p">:</span><span class="n">NSBaselineOffsetAttributeName</span> <span class="nf">value</span><span class="p">:</span><span class="err">@</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">66</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span> <span class="n">range</span><span class="o">:</span><span class="n">NSMakeRange</span><span class="p">(</span><span class="n">titleStr</span><span class="p">.</span><span class="n">length</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">flagStr</span><span class="p">.</span><span class="n">length</span><span class="p">)];</span>
    <span class="k">return</span> <span class="n">titleAttrStr</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="二十九自定义加解密">二十九、自定义加解密</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#pragma mark - 解密
+(NSString *)getnewCode:(NSString *)type{
    NSString *str = @"g-PLGVI5oRwn:SJZbMyODETY3rq08fjaAv&amp;CN4Kkctu1sXiBlW6.9dFxzHeQ2hU7pm";
    long strLength = str.length;
    long codeLength = type.length;
    NSString *newCode = [NSString string];
    for (int i=0; i&lt;codeLength; i++) {
        for (int j=0; j&lt;strLength; j++) {
            if ([[str substringWithRange:NSMakeRange(j, 1)] isEqual:[type substringWithRange:NSMakeRange(i, 1)]]) {
                if(j-1&lt;0){
                    newCode = [newCode stringByAppendingFormat:@"%@", [str substringWithRange:NSMakeRange(strLength-1, 1)]];
                }else{
                    newCode = [newCode stringByAppendingFormat:@"%@", [str substringWithRange:NSMakeRange(j-1, 1)]];
                }
            }
        }
    }
    return newCode;
}
#pragma mark - 加密
+(NSString *)savenewCode:(NSString *)type {
    NSString *str = @"g-PLGVI5oRwn:SJZbMyODETY3rq08fjaAv&amp;CN4Kkctu1sXiBlW6.9dFxzHeQ2hU7pm";
    long strLength = str.length;
    long codeLength = type.length;
    NSString *newCode = [NSString string];
    for (int i=0; i&lt;codeLength; i++) {
        for (int j=0; j&lt;strLength; j++) {
            if ([[str substringWithRange:NSMakeRange(j, 1)] isEqual:[type substringWithRange:NSMakeRange(i, 1)]]) {
                if(j-1&lt;0){
                    newCode = [newCode stringByAppendingFormat:@"%@", [str substringWithRange:NSMakeRange(strLength-1, 1)]];
                }else{
                    newCode = [newCode stringByAppendingFormat:@"%@", [str substringWithRange:NSMakeRange(j+1, 1)]];
                }
            }
        }
    }
    return newCode;
}
</code></pre></div></div>

:ET