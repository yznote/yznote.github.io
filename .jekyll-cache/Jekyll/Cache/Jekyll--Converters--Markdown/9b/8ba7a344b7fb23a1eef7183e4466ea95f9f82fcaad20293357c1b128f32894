I"£V<h4 id="coredata">CoreData</h4>

<h5 id="1coredataæ¦‚è¿°">1.CoreDataæ¦‚è¿°</h5>
<blockquote>
  <p>1.<code class="highlighter-rouge">Core data</code>æ˜¯æ•°æ®æŒä¹…å­˜å‚¨çš„æœ€ä½³æ–¹å¼<br />
2.<code class="highlighter-rouge">Core Data</code> åŸºäº<code class="highlighter-rouge">modelï¼viewï¼controllerï¼ˆmvcï¼‰</code>æ¨¡å¼ä¸‹ï¼Œä¸ºåˆ›å»ºåˆ†è§£çš„<code class="highlighter-rouge">cocoa</code>åº”ç”¨ç¨‹åºæä¾›äº†ä¸€ä¸ªçµæ´»å’Œå¼ºå¤§çš„æ•°æ®æ¨¡å‹æ¡†æ¶ã€‚<br />
3.<code class="highlighter-rouge">Core Data</code>å¯ä»¥æ˜¯ä½ ä»¥å›¾å½¢ç•Œé¢çš„æ–¹å¼å¿«é€Ÿçš„å®šä¹‰appçš„æ•°æ®æ¨¡å‹ï¼ŒåŒæ—¶åœ¨ä½ çš„ä»£ç ä¸­å®¹æ˜“è·å–åˆ°å®ƒã€‚ <code class="highlighter-rouge">Core Data</code>æä¾›äº†åŸºç¡€ç»“æ„å»å¤„ç†å¸¸ç”¨çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š ä¿å­˜ï¼Œæ¢å¤ï¼Œæ’¤é”€å’Œé‡åšï¼Œå…è®¸ä½ åœ¨appä¸­ç»§ç»­åˆ›å»ºæ–°çš„ä»»åŠ¡ã€‚ åœ¨ä½¿ç”¨ <code class="highlighter-rouge">Core Data</code>çš„æ—¶å€™ï¼Œä½ ä¸ç”¨å®‰è£…é¢å¤–çš„æ•°æ®åº“ç³»ç»Ÿï¼Œå› ä¸º <code class="highlighter-rouge">Core Data</code>ä½¿ç”¨å†…ç½®çš„<code class="highlighter-rouge">SQLite</code>æ•°æ®åº“ã€‚ï¼ˆé‡Œé¢è‡ªåŠ¨ç”Ÿæˆä¸‰ä¸ªå­—æ®µï¼‰<br />
4.<code class="highlighter-rouge">Core Data</code>æä¾›äº†ä¸€ä¸ªé€šç”¨çš„æ•°æ®ç®¡ç†è§£å†³æ–¹æ¡ˆæ¥å¤„ç†é‚£äº›æ‰€æœ‰éœ€è¦æ•°æ®æ¨¡å‹çš„appï¼Œappä½¿ç”¨ <code class="highlighter-rouge">Core Data</code>æ¥ç®¡ç†æ•°æ®å¯¹è±¡æ—¶å¾ˆå¤šçš„ç›Šå¤„<br />
5.è‹¹æœçš„å›¾å½¢ç”¨æˆ·ç•Œé¢ç¼–è¯‘å™¨<code class="highlighter-rouge">-interface builderï¼ˆIBï¼‰</code>ï¼Œæä¾›äº†å¯¹<code class="highlighter-rouge">core data controller</code>å¯¹è±¡çš„é¢„æ„å»ºï¼Œä»è€Œæ¥å‡å°‘appçš„ç”¨æˆ·ç•Œé¢å’Œå®ƒçš„æ•°æ®æ¨¡å‹ä¹‹é—´çš„ç²˜æ»ä»£ç ã€‚åœ¨ä½¿ç”¨<code class="highlighter-rouge">core data</code>çš„æ—¶å€™ä½ ä¸éœ€è¦è€ƒè™‘<code class="highlighter-rouge">sql</code>çš„è¯­æ³•é—®é¢˜ï¼Œä¹Ÿä¸éœ€è¦ç®¡ç†ç›¸å…³çš„é€»è¾‘æ ‘å»è¿½è¸ªç”¨æˆ·çš„è¡Œä¸ºï¼Œæ›´ä¸ç”¨å»ºç«‹æ–°çš„æ°¸ä¹…æœºåˆ¶ã€‚å½“ä½ å†™ä½ appçš„ç”¨æˆ·ç•Œé¢åˆ°å®ƒçš„<code class="highlighter-rouge">core data</code>æ¨¡å‹çš„æ—¶å€™ï¼Œå®ƒå·²ç»ä¸ºä½ æŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½åšå¥½äº†ã€‚<br />
6.<code class="highlighter-rouge">core data</code>å°†ä½ appçš„æ¨¡å‹å±‚æ”¾å…¥åˆ°ä¸€ç»„å®šä¹‰åœ¨å†…å­˜ä¸­çš„æ•°æ®å¯¹è±¡ã€‚<code class="highlighter-rouge">core data</code>ä¼šè¿½è¸ªè¿™äº›å¯¹è±¡çš„æ”¹å˜ï¼ŒåŒæ—¶å¯ä»¥æ ¹æ®éœ€è¦åšç›¸åçš„æ”¹å˜ï¼Œä¾‹å¦‚ç”¨æˆ·æ‰§è¡Œæ’¤é”€å‘½ä»¤ã€‚å½“<code class="highlighter-rouge">core data</code>åœ¨å¯¹ä½ appæ•°æ®çš„æ”¹å˜è¿›è¡Œä¿å­˜çš„æ—¶å€™ï¼Œ<code class="highlighter-rouge">core data</code>ä¼šæŠŠè¿™äº›æ•°æ®å½’æ¡£ï¼Œå¹¶æ°¸ä¹…æ€§ä¿å­˜ã€‚å®ƒä¿å­˜çš„æ•°æ®åœ¨ä¸€äº›å¸¸è§„çš„æ–‡ä»¶ï¼Œä½ å¯ä»¥åœ¨<code class="highlighter-rouge">Finder</code>ä¸­å¯ä»¥è¿›è¡Œç®¡ç†ï¼Œç”¨<code class="highlighter-rouge">spotlight</code>è¿›è¡Œæœç´¢ï¼Œå¤‡ä»½åˆ°cdï¼Œå’Œ<code class="highlighter-rouge">email</code>ç»™æœ‹å‹æˆ–è€…å®¶äºº ã€‚<br />
7.åœ¨ä½¿ç”¨<code class="highlighter-rouge">core data</code>æ¡†æ¶çš„æ—¶å€™ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªç®¡ç†å¯¹è±¡çš„æ¨¡å‹ï¼Œè¯¥æ¨¡å‹æä¾›äº†å¯¹æ¨¡å‹å¯¹è±¡çš„æŠ½è±¡å®šä¹‰ï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€çŸ¥é“çš„<code class="highlighter-rouge">entities</code>ï¼Œå®ƒå¯ä»¥åœ¨æˆ‘ä»¬çš„ç¨‹åºä¸­ä½¿ç”¨ã€‚<br />
8.<code class="highlighter-rouge">core data</code>æ˜¯ä¸€ä¸ªå®ä½“-å…³ç³»æ¨¡å‹ ï¼Œè¯¥æ¨¡å‹æ˜¯ä½¿ç”¨Xcodeçš„æ•°æ®æ¨¡å‹è®¾è®¡å·¥å…·æ¥å®šä¹‰çš„ï¼Œå¯¹æ•°æ®å®ä½“ä»¥åŠä»–ä»¬çš„å…³ç³»æä¾›äº†ä¸°å¯Œçš„ç¯å¢ƒã€‚</p>
</blockquote>

<h5 id="2coredataçš„æ„æˆåŠç‰¹ç‚¹">2.CoreDataçš„æ„æˆåŠç‰¹ç‚¹</h5>
<blockquote>
  <p>1.æ•°æ®æœ€ç»ˆçš„å­˜å‚¨ç±»å‹
<code class="highlighter-rouge">SQLite</code>æ•°æ®åº“ï¼Œ<code class="highlighter-rouge">XML</code>ï¼ŒäºŒè¿›åˆ¶ï¼Œå†…å­˜é‡Œï¼Œæˆ–è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼ˆ åœ¨ <code class="highlighter-rouge">Mac OS X 10.5Leopard</code>åŠä»¥åçš„ç‰ˆæœ¬ä¸­ï¼Œå¼€å‘è€…ä¹Ÿå¯ä»¥é€šè¿‡ç»§æ‰¿ <code class="highlighter-rouge">NSPersistentStore</code> ç±»ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„å­˜å‚¨æ ¼å¼ï¼‰<br />
2.å¥½å¤„<br />
èƒ½å¤Ÿåˆç†ç®¡ç†å†…å­˜ï¼Œé¿å…ä½¿ç”¨<code class="highlighter-rouge">sql</code>çš„éº»çƒ¦ï¼Œé«˜æ•ˆ<br />
3.æ„æˆ</p>
  <ol>
    <li><code class="highlighter-rouge">NSManagedObjectContext</code>ï¼ˆè¢«ç®¡ç†çš„æ•°æ®ä¸Šä¸‹æ–‡ï¼‰
  æ“ä½œå®é™…å†…å®¹ï¼ˆæ“ä½œæŒä¹…å±‚ï¼‰
  ä½œç”¨ï¼šæ’å…¥æ•°æ®ï¼ŒæŸ¥è¯¢æ•°æ®ï¼Œåˆ é™¤æ•°æ®</li>
    <li><code class="highlighter-rouge">NSManagedObjectModel</code>ï¼ˆè¢«ç®¡ç†çš„æ•°æ®æ¨¡å‹ï¼‰<br />
  æ•°æ®åº“æ‰€æœ‰è¡¨æ ¼æˆ–æ•°æ®ç»“æ„ï¼ŒåŒ…å«å„å®ä½“çš„å®šä¹‰ä¿¡æ¯<br />
  ä½œç”¨ï¼šæ·»åŠ å®ä½“çš„å±æ€§ï¼Œå»ºç«‹å±æ€§ä¹‹é—´çš„å…³ç³»<br />
  æ“ä½œæ–¹æ³•ï¼šè§†å›¾ç¼–è¾‘å™¨ï¼Œæˆ–ä»£ç </li>
    <li><code class="highlighter-rouge">NSPersistentStoreCoordinator</code>ï¼ˆæŒä¹…åŒ–å­˜å‚¨åŠ©ç†ï¼‰<br />
  ç›¸å½“äºæ•°æ®åº“çš„è¿æ¥å™¨<br />
  ä½œç”¨ï¼šè®¾ç½®æ•°æ®å­˜å‚¨çš„åå­—ï¼Œä½ç½®ï¼Œå­˜å‚¨æ–¹å¼ï¼Œå’Œå­˜å‚¨æ—¶æœº</li>
    <li><code class="highlighter-rouge">NSManagedObject</code>ï¼ˆè¢«ç®¡ç†çš„æ•°æ®è®°å½•ï¼‰<br />
  ç›¸å½“äºæ•°æ®åº“ä¸­çš„è¡¨æ ¼è®°å½•</li>
    <li><code class="highlighter-rouge">NSFetchRequest</code>ï¼ˆè·å–æ•°æ®çš„è¯·æ±‚ï¼‰<br />
  ç›¸å½“äºæŸ¥è¯¢è¯­å¥</li>
    <li><code class="highlighter-rouge">NSEntityDescription</code>ï¼ˆå®ä½“ç»“æ„ï¼‰<br />
  ç›¸å½“äºè¡¨æ ¼ç»“æ„</li>
    <li>åç¼€ä¸º<code class="highlighter-rouge">.xcdatamodeld</code>çš„åŒ…<br />
  é‡Œé¢æ˜¯<code class="highlighter-rouge">.xcdatamodel</code>æ–‡ä»¶ï¼Œç”¨æ•°æ®æ¨¡å‹ç¼–è¾‘å™¨ç¼–è¾‘<br />
  ç¼–è¯‘åä¸º<code class="highlighter-rouge">.momd</code>æˆ–<code class="highlighter-rouge">.mom</code>æ–‡ä»¶</li>
  </ol>

  <p>4.ä¾èµ–å…³ç³»<br />
<img src="/img/noimg.jpeg" alt="æ–°æµªåšå®¢çš„å›¾ç‰‡ä¸¢å¤±äº†" /></p>
</blockquote>
<center style="color: #969696">æ–°æµªåšå®¢çš„åŸå§‹å›¾ç‰‡ä¸¢å¤±äº†</center>

<h5 id="3åŸºäºsqliteæ•°æ®åº“æ—¶core-dataçš„ç®€å•ä½¿ç”¨">3.åŸºäº<code class="highlighter-rouge">SQLite</code>æ•°æ®åº“æ—¶ï¼Œ<code class="highlighter-rouge">Core Data</code>çš„ç®€å•ä½¿ç”¨</h5>

<blockquote>
  <p>å’Œ<code class="highlighter-rouge">SQLite</code>çš„åŒºåˆ«ï¼šåªèƒ½å–å‡ºæ•´ä¸ªå®ä½“è®°å½•ï¼Œç„¶ååˆ†è§£ï¼Œä¹‹åæ‰èƒ½å¾—åˆ°å®ä½“çš„æŸä¸ªå±æ€§</p>
</blockquote>

<blockquote>
  <p>.1 æ„å»ºæµç¨‹  <br />
åŒ…æ‹¬ï¼šåˆ›å»ºæ•°æ®ä¸Šä¸‹æ–‡ï¼Œåˆ›å»ºæ•°æ®æ¨¡å‹ï¼Œåˆ›å»ºæ•°æ®æŒä¹…åŒ–å­˜å‚¨åŠ©ç†</p>
  <ol>
    <li>è‹¥æ˜¯æ–°å»ºçš„å·¥ç¨‹ï¼Œé€‰æ‹©ç©ºç™½åº”ç”¨ç¨‹åºï¼Œ<code class="highlighter-rouge">next</code>  <br />
  <img src="/img/noimg.jpeg" alt="æ–°æµªåšå®¢çš„å›¾ç‰‡ä¸¢å¤±äº†" />
  æ­¤æ—¶ç”Ÿæˆçš„å·¥ç¨‹æ–‡ä»¶AppDelegateä¸­ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆè¢«ç®¡ç†çš„æ•°æ®ä¸Šä¸‹æ–‡ç­‰ç›¸å…³ä»£ç </li>
    <li>æ¯”å¦‚<code class="highlighter-rouge">AppDelegate.h</code>æ–‡ä»¶ä¸­ï¼Œè‡ªåŠ¨ç”Ÿæˆ
      <div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">@property</span> <span class="p">(</span> <span class="n">readonly</span> <span class="p">,</span> <span class="n">strong</span><span class="p">,</span> <span class="n">nonatomic</span><span class="p">)</span> <span class="n">NSManagedObjectContext</span> <span class="o">*</span><span class="n">managedObjectContext</span><span class="p">;</span>
  <span class="k">@property</span> <span class="p">(</span> <span class="n">readonly</span> <span class="p">,</span> <span class="n">strong</span><span class="p">,</span> <span class="n">nonatomic</span><span class="p">)</span> <span class="n">NSManagedObjectModel</span> <span class="o">*</span><span class="n">managedObjectModel</span><span class="p">;</span>
  <span class="k">@property</span> <span class="p">(</span> <span class="n">readonly</span> <span class="p">,</span> <span class="n">strong</span><span class="p">,</span> <span class="n">nonatomic</span><span class="p">)</span> <span class="n">NSPersistentStoreCoordinator</span> <span class="o">*</span><span class="n">persistentStoreCoordinator</span><span class="p">;</span>
  <span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">saveContext</span><span class="p">;</span>
  <span class="k">-</span> <span class="p">(</span><span class="n">NSURL</span> <span class="o">*</span><span class="p">)</span><span class="n">applicationDocumentsDirectory</span><span class="p">;</span>
  <span class="c1">//æ–¹æ³•`saveContext`è¡¨ç¤ºï¼šä¿å­˜æ•°æ®åˆ°æŒä¹…å±‚ï¼ˆæ•°æ®åº“ï¼‰  </span>
  <span class="c1">//æ–¹æ³•`applicationDocumentsDirectory`è¡¨ç¤ºï¼šåº”ç”¨ç¨‹åºæ²™ç®±ä¸‹çš„`Documents`ç›®å½•è·¯å¾„</span>
  <span class="c1">//( ä¾‹å¦‚/var/mobile/Applications/5FG80A45-DFB5-4087-A1B1-41342A977E21/Documents/ )</span>
</code></pre></div>      </div>
    </li>
    <li>æ¯”å¦‚AppDelegate.hæ–‡ä»¶ä¸­ï¼Œè‡ªåŠ¨ç”Ÿæˆ
      <div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">@synthesize</span> <span class="n">managedObjectContext</span> <span class="o">=</span> <span class="n">__managedObjectContext</span><span class="p">;</span>
  <span class="k">@synthesize</span> <span class="n">managedObjectModel</span> <span class="o">=</span> <span class="n">__managedObjectModel</span><span class="p">;</span>
  <span class="k">@synthesize</span> <span class="n">persistentStoreCoordinator</span> <span class="o">=</span> <span class="n">__persistentStoreCoordinator</span><span class="p">;</span>
  <span class="c1">//ä¿å­˜æ•°æ®åˆ°æŒä¹…å±‚</span>
  <span class="k">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">applicationWillTerminate</span><span class="p">:(</span><span class="n">UIApplication</span> <span class="o">*</span><span class="p">)</span><span class="nv">application</span><span class="p">{</span>
    	<span class="p">[</span><span class="n">self</span> <span class="nf">saveContext</span><span class="p">];</span>
  <span class="p">}</span>
</code></pre></div>      </div>
      <p><img src="/img/noimg.jpeg" alt="æ–°æµªåšå®¢çš„å›¾ç‰‡ä¸¢å¤±äº†" /></p>
      <div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">-</span> <span class="p">(</span> <span class="kt">void</span> <span class="p">)</span><span class="n">saveContext</span>  <span class="p">{</span>
    <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
    <span class="n">NSManagedObjectContext</span> <span class="o">*</span><span class="n">managedObjectContext</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">managedObjectContext</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">managedObjectContext</span> <span class="o">!=</span> <span class="nb">nil</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">if</span> <span class="p">([</span><span class="n">managedObjectContext</span> <span class="nf">hasChanges</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">[</span><span class="n">managedObjectContext</span> <span class="nf">save</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">])</span> <span class="p">{</span>
       <span class="n">NSLog</span><span class="p">(</span> <span class="s">@"Unresolved error %@, %@"</span> <span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="p">[</span><span class="n">error</span> <span class="nf">userInfo</span><span class="p">]);</span>
       <span class="n">abort</span><span class="p">();</span>
   <span class="p">}</span> 
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div>      </div>
      <p><img src="/img/noimg.jpeg" alt="æ–°æµªåšå®¢çš„å›¾ç‰‡ä¸¢å¤±äº†" /></p>
      <div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">//Documentsç›®å½•è·¯å¾„</span>
  <span class="k">-</span> <span class="p">(</span><span class="n">NSURL</span> <span class="o">*</span><span class="p">)</span><span class="n">applicationDocumentsDirectory</span> <span class="p">{</span>
 <span class="k">return</span> <span class="p">[[[</span><span class="n">NSFileManager</span> <span class="nf">defaultManager</span><span class="p">]</span> <span class="nf">URLsForDirectory</span><span class="p">:</span><span class="n">NSDocumentDirectory</span> <span class="nf">inDomains</span><span class="p">:</span><span class="nf">NSUserDomainMask</span><span class="p">]</span> <span class="n">lastObject</span><span class="p">];</span>
  <span class="p">}</span>
</code></pre></div>      </div>
      <p><img src="/img/noimg.jpeg" alt="æ–°æµªåšå®¢çš„å›¾ç‰‡ä¸¢å¤±äº†" /></p>
      <div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">//è¢«ç®¡ç†çš„æ•°æ®ä¸Šä¸‹æ–‡</span>
  <span class="c1">//åˆå§‹åŒ–çš„åï¼Œå¿…é¡»è®¾ç½®æŒä¹…åŒ–å­˜å‚¨åŠ©ç†</span>
  <span class="k">-</span> <span class="p">(</span><span class="n">NSManagedObjectContext</span> <span class="o">*</span><span class="p">)</span><span class="n">managedObjectContext</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">__managedObjectContext</span> <span class="o">!=</span> <span class="nb">nil</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">return</span> <span class="n">__managedObjectContext</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">NSPersistentStoreCoordinator</span> <span class="o">*</span><span class="n">coordinator</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span> <span class="nf">persistentStoreCoordinator</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">coordinator</span> <span class="o">!=</span> <span class="nb">nil</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">__managedObjectContext</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSManagedObjectContext</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
   <span class="p">[</span><span class="n">__managedObjectContext</span> <span class="nf">setPersistentStoreCoordinator</span><span class="p">:</span><span class="n">coordinator</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">__managedObjectContext</span><span class="p">;</span>
  <span class="p">}</span>
</code></pre></div>      </div>
      <p><img src="/img/noimg.jpeg" alt="æ–°æµªåšå®¢çš„å›¾ç‰‡ä¸¢å¤±äº†" /></p>
      <div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">//è¢«ç®¡ç†çš„æ•°æ®æ¨¡å‹</span>
  <span class="c1">//åˆå§‹åŒ–å¿…é¡»ä¾èµ–.momdæ–‡ä»¶è·¯å¾„ï¼Œè€Œ.momdæ–‡ä»¶ç”±.xcdatamodeldæ–‡ä»¶ç¼–è¯‘è€Œæ¥</span>
  <span class="k">-</span> <span class="p">(</span><span class="n">NSManagedObjectModel</span> <span class="o">*</span><span class="p">)</span><span class="n">managedObjectModel</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">__managedObjectModel</span> <span class="o">!=</span> <span class="nb">nil</span><span class="p">)</span> <span class="p">{</span>
    	<span class="k">return</span> <span class="n">__managedObjectModel</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">NSURL</span> <span class="o">*</span><span class="n">modelURL</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSBundle</span> <span class="nf">mainBundle</span><span class="p">]</span> <span class="nf">URLForResource</span><span class="p">:</span> <span class="s">@"TestApp"</span><span class="nf">withExtension</span><span class="p">:</span> <span class="s">@"momd"</span> <span class="p">];</span>
    <span class="n">__managedObjectModel</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSManagedObjectModel</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithContentsOfURL</span><span class="p">:</span><span class="n">modelURL</span><span class="p">];</span>
    <span class="k">return</span> <span class="n">__managedObjectModel</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">//æŒä¹…åŒ–å­˜å‚¨åŠ©ç†</span>
  <span class="c1">//åˆå§‹åŒ–å¿…é¡»ä¾èµ–NSManagedObjectModelï¼Œä¹‹åè¦æŒ‡å®šæŒä¹…åŒ–å­˜å‚¨çš„æ•°æ®ç±»å‹ï¼Œé»˜è®¤çš„æ˜¯NSSQLiteStoreTypeï¼Œå³SQLiteæ•°æ®åº“ï¼›å¹¶æŒ‡å®šå­˜å‚¨è·¯å¾„ä¸ºDocumentsç›®å½•ä¸‹ï¼Œä»¥åŠæ•°æ®åº“åç§°</span>
  <span class="k">-</span> <span class="p">(</span><span class="n">NSPersistentStoreCoordinator</span> <span class="o">*</span><span class="p">)</span><span class="n">persistentStoreCoordinator</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">__persistentStoreCoordinator</span> <span class="o">!=</span> <span class="nb">nil</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">return</span> <span class="n">__persistentStoreCoordinator</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">NSURL</span> <span class="o">*</span><span class="n">storeURL</span> <span class="o">=</span> <span class="p">[[</span><span class="n">self</span> <span class="nf">applicationDocumentsDirectory</span><span class="p">]</span> <span class="nf">URLByAppendingPathComponent</span><span class="p">:</span> <span class="s">@"TestApp.SQLite"</span> <span class="p">];</span>
    <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
    <span class="n">__persistentStoreCoordinator</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSPersistentStoreCoordinator</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithManagedObjectModel</span><span class="p">:[</span><span class="n">self</span> <span class="nf">managedObjectModel</span><span class="p">]];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">[</span><span class="n">__persistentStoreCoordinator</span> <span class="nf">addPersistentStoreWithType</span><span class="p">:</span><span class="n">NSSQLiteStoreType</span> <span class="nf">configuration</span><span class="p">:</span><span class="nb">nil</span> <span class="n">URL</span><span class="o">:</span><span class="n">storeURL</span> <span class="n">options</span><span class="o">:</span><span class="nb">nil</span> <span class="n">error</span><span class="o">:&amp;</span><span class="n">error</span><span class="p">])</span> <span class="p">{</span>
   <span class="n">NSLog</span><span class="p">(</span> <span class="s">@"Unresolved error %@, %@"</span> <span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="p">[</span><span class="n">error</span> <span class="nf">userInfo</span><span class="p">]);</span>
   <span class="n">abort</span><span class="p">();</span>
    <span class="p">}</span>  
    <span class="k">return</span> <span class="n">__persistentStoreCoordinator</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">//å¦‚æœä¸æ˜¯æ–°å·¥ç¨‹ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å†™å…¥ç›¸å…³ä»£ç </span>
</code></pre></div>      </div>
    </li>
    <li>æ­¤å¤–è¿˜ç”Ÿæˆäº†<code class="highlighter-rouge">TestApp.xcdatamodeld</code>æ–‡ä»¶</li>
    <li>è¿˜è‡ªåŠ¨é“¾æ¥äº†<code class="highlighter-rouge">CoreData.framework</code></li>
    <li>åœ¨é¢„ç¼–è¯‘å¤´.pchæ–‡ä»¶ä¸­ï¼ŒåŠ å…¥å¯¼å…¥äº†CoreData.hå¤´æ–‡ä»¶</li>
  </ol>

  <p>2.åˆ›å»ºæ•°æ®æ¨¡å‹ï¼ˆæ•°æ®æ¨¡å‹ç¼–è¾‘å™¨æ“ä½œï¼‰</p>
  <ol>
    <li>åˆ›å»ºå®ä½“ï¼ˆæ•°æ®åº“è¡¨ï¼‰å’Œå®ä½“é—´çš„å…³ç³»<br />
  é€‰ä¸­<code class="highlighter-rouge">.xcodedatamodel</code>å¯¹è±¡<br />
  åœ¨å·¦ä¸‹è„šç‚¹å‡»<code class="highlighter-rouge">Add Entity</code>æ·»åŠ å®ä½“<br />
  é€‰ä¸­æ–°æ·»åŠ çš„å±æ€§ï¼Œå¯¹å±æ€§è¿›è¡Œå‘½åï¼Œå¹¶è®¾ç½®å±æ€§çš„æ•°æ®ç±»å‹<code class="highlighter-rouge">Attribute Type</code><br />
  é€‰ä¸­ä¸€ä¸ªå®ä½“ï¼Œåœ¨åº•éƒ¨å·¥å…·æ ç‚¹å‡»<code class="highlighter-rouge">Add Relationship</code>æ·»åŠ å…³ç³»<br />
  <img src="/img/noimg.jpeg" alt="æ–°æµªåšå®¢çš„å›¾ç‰‡ä¸¢å¤±äº†" /></li>
    <li>è‡ªåŠ¨ç”Ÿæˆæ¨¡å‹ç±»
  <img src="/img/noimg.jpeg" alt="æ–°æµªåšå®¢çš„å›¾ç‰‡ä¸¢å¤±äº†" />
  é€‰æ‹©ä½ è¦åˆ›å»ºçš„æ•°æ®å¯¹è±¡
  <img src="/img/noimg.jpeg" alt="æ–°æµªåšå®¢çš„å›¾ç‰‡ä¸¢å¤±äº†" /></li>
  </ol>

  <p>3.æ•°æ®æ¨¡ç‰ˆ<br />
ä¸ºæ¯ä¸ªå®ä½“ç”Ÿæˆä¸€ä¸ª<code class="highlighter-rouge">NSManagedObject</code>å­ç±»<br />
ä¸Šé¢è®¾ç½®æ•°æ®å’Œè·å–æ•°æ®æ—¶ï¼Œä½¿ç”¨çš„æ˜¯<code class="highlighter-rouge">Key-Value</code>æ–¹å¼ï¼Œæ›´å¥½çš„æ–¹æ³•æ˜¯é€šè¿‡ç”Ÿæˆå¼ºç±»å‹çš„<code class="highlighter-rouge">NSManagedObject</code>çš„å­ç±»ï¼Œé€šè¿‡ç±»çš„æˆå‘˜å±æ€§æ¥è®¿é—®å’Œè·å–æ•°æ®</p>
  <ol>
    <li>åœ¨æ•°æ®ç¼–è¾‘å™¨è§†å›¾ä¸­é€‰ä¸­å®ä½“å¯¹è±¡<br />
  é€‰åˆ™<code class="highlighter-rouge">file</code>èœå•ï¼Œç‚¹å‡»<code class="highlighter-rouge">new</code>ï¼Œç‚¹å‡»<code class="highlighter-rouge">file...</code>ï¼Œé€‰æ‹©<code class="highlighter-rouge">Core Data</code>é¡¹ï¼Œé€‰æ‹©<code class="highlighter-rouge">NSManagedObject subclass</code>ï¼Œç”Ÿæˆè¯¥å®ä½“åŒåçš„ç±»ï¼Œ<br />
  ç»§æ‰¿äº<code class="highlighter-rouge">NSManagedObject</code><br />
  ç”Ÿæˆå¯¹åº”çš„<code class="highlighter-rouge">.h</code>æ–‡ä»¶
  <img src="/img/noimg.jpeg" alt="æ–°æµªåšå®¢çš„å›¾ç‰‡ä¸¢å¤±äº†" />
  ç”Ÿæˆå¯¹åº”çš„<code class="highlighter-rouge">.m</code>æ–‡ä»¶
  <img src="/img/noimg.jpeg" alt="æ–°æµªåšå®¢çš„å›¾ç‰‡ä¸¢å¤±äº†" />
  å…¶ä¸­ï¼Œ<code class="highlighter-rouge">@dynamic</code>å‘Šè¯‰ç¼–è¯‘å™¨ä¸åšå¤„ç†ï¼Œä½¿ç¼–è¯‘é€šè¿‡ï¼Œå…¶<code class="highlighter-rouge">getter</code>å’Œ<code class="highlighter-rouge">setter</code>æ–¹æ³•ä¼šåœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ›å»ºï¼Œç”±<code class="highlighter-rouge">Core Data</code>æ¡†æ¶ä¸ºæ­¤ç±»å±æ€§ç”Ÿæˆå­˜å–æ–¹æ³•</li>
  </ol>

  <p>4.æ’å…¥æ•°æ®<br />
åœ¨<code class="highlighter-rouge">AppDelegate.m</code>çš„<code class="highlighter-rouge">application:didFinishLaunchingWithOptions:</code>æ–¹æ³•é‡Œï¼Œè°ƒç”¨è‡ªå®šä¹‰æ–¹æ³•
<code class="highlighter-rouge">insertCoreData</code>æ’å…¥æ•°æ®ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
  <div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span> <span class="kt">void</span> <span class="p">)</span><span class="n">insertCoreData</span> <span class="p">{</span>
    <span class="n">NSManagedObjectContext</span> <span class="o">*</span><span class="n">context</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span> <span class="nf">managedObjectContext</span><span class="p">];</span>
    <span class="n">NSManagedObject</span> <span class="o">*</span><span class="n">contactInfo</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSEntityDescription</span> <span class="nf">insertNewObjectForEntityForName</span><span class="p">:</span> <span class="s">@"School"</span> <span class="nf">inManagedObjectContext</span><span class="p">:</span><span class="n">context</span><span class="p">];</span>
    <span class="p">[</span><span class="n">contactInfo</span> <span class="nf">setValue</span><span class="p">:</span> <span class="s">@"name B"</span> <span class="nf">forKey</span><span class="p">:</span> <span class="s">@"name"</span> <span class="p">];</span>
    <span class="p">[</span><span class="n">contactInfo</span> <span class="nf">setValue</span><span class="p">:</span> <span class="s">@"classID 1"</span> <span class="nf">forKey</span><span class="p">:</span> <span class="s">@"classID"</span> <span class="p">];</span>
    <span class="p">[</span><span class="n">contactInfo</span> <span class="nf">setValue</span><span class="p">:</span> <span class="s">@"persons 20"</span> <span class="nf">forKey</span><span class="p">:</span> <span class="s">@"pensons"</span> <span class="p">];</span>
    <span class="n">NSManagedObject</span> <span class="o">*</span><span class="n">contactDetailInfo</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSEntityDescription</span> <span class="nf">insertNewObjectForEntityForName</span><span class="p">:</span> <span class="s">@"ContactDetailInfo"</span><span class="nf">inManagedObjectContext</span><span class="p">:</span><span class="n">context</span><span class="p">];</span>
    <span class="p">[</span><span class="n">contactDetailInfo</span> <span class="nf">setValue</span><span class="p">:</span> <span class="s">@"age 22"</span> <span class="nf">forKey</span><span class="p">:</span> <span class="s">@"age"</span> <span class="p">];</span>
    <span class="p">[</span><span class="n">contactDetailInfo</span> <span class="nf">setValue</span><span class="p">:</span> <span class="s">@"name B"</span> <span class="nf">forKey</span><span class="p">:</span> <span class="s">@"name"</span> <span class="p">];</span>
    <span class="p">[</span><span class="n">contactDetailInfo</span> <span class="nf">setValue</span><span class="p">:</span> <span class="s">@"classID 1"</span> <span class="nf">forKey</span><span class="p">:</span> <span class="s">@"classID"</span> <span class="p">];</span>
    <span class="p">[</span><span class="n">contactDetailInfo</span> <span class="nf">setValue</span><span class="p">:</span><span class="n">contactInfo</span> <span class="nf">forKey</span><span class="p">:</span> <span class="s">@"name"</span> <span class="p">];</span>
    <span class="p">[</span><span class="n">contactInfo</span> <span class="nf">setValue</span><span class="p">:</span><span class="n">contactDetailInfo</span> <span class="nf">forKey</span><span class="p">:</span> <span class="s">@"classID"</span> <span class="p">];</span>
    <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">[</span><span class="n">context</span> <span class="nf">save</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">])</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span> <span class="s">@"ä¸èƒ½ä¿å­˜ï¼š%@"</span> <span class="p">,[</span><span class="n">error</span> <span class="nf">localizedDescription</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>  </div>
  <p>åˆ›å»ºæ•°æ®ä¸Šä¸‹æ–‡ï¼Œè°ƒç”¨<code class="highlighter-rouge">insertNewObjectForName</code>æ–¹æ³•ï¼Œåˆ›å»ºä¸¤ä¸ªæ•°æ®è®°å½•<code class="highlighter-rouge">NSManagedObject</code>ï¼Œç„¶åå°±å¯ä»¥å¯¹ä¹‹å‰æ•°æ®æ¨¡å‹ç¼–è¾‘è§†å›¾ä¸­å®šä¹‰çš„å±æ€§è¿›è¡Œèµ‹å€¼ã€‚æ­¤æ—¶çš„æ•°æ®åªåœ¨å†…å­˜ä¸­è¢«ä¿®æ”¹ï¼Œæœ€åè°ƒç”¨æ•°æ®ä¸Šä¸‹æ–‡çš„<code class="highlighter-rouge">save</code>æ–¹æ³•ï¼Œä¿å­˜åˆ°æŒä¹…å±‚<br />
5.æŸ¥è¯¢æ•°æ®<br />
åœ¨è°ƒç”¨äº†<code class="highlighter-rouge">insertCoreData</code>ä¹‹åï¼Œå¯ä»¥è°ƒç”¨è‡ªå®šçš„æŸ¥è¯¢æ–¹æ³•<code class="highlighter-rouge">dataFetchRequest</code>æ¥æŸ¥è¯¢æ’å…¥çš„æ•°æ®</p>
  <div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span> <span class="kt">void</span> <span class="p">)</span><span class="n">dataFetchRequest</span> <span class="p">{</span>
	<span class="n">NSManagedObjectContext</span> <span class="o">*</span><span class="n">context</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span> <span class="nf">managedObjectContext</span><span class="p">];</span>
	<span class="n">NSFetchRequest</span> <span class="o">*</span><span class="n">fetchRequest</span> <span class="o">=</span> <span class="p">[[[</span><span class="n">NSFetchRequest</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">]</span> <span class="nf">autorelease</span><span class="p">];</span>
    <span class="n">NSEntityDescription</span> <span class="o">*</span><span class="n">entity</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSEntityDescription</span> <span class="nf">entityForName</span><span class="p">:</span><span class="s">@"ContactInfo"</span> <span class="nf">inManagedObjectContext</span><span class="p">:</span><span class="n">context</span><span class="p">];</span>
	<span class="p">[</span><span class="n">fetchRequest</span> <span class="nf">setEntity</span><span class="p">:</span><span class="n">entity</span><span class="p">];</span>
	<span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">;</span>
	<span class="n">NSArray</span> <span class="o">*</span><span class="n">fetchedObjects</span> <span class="o">=</span> <span class="p">[</span><span class="n">context</span> <span class="nf">executeFetchRequest</span><span class="p">:</span><span class="n">fetchRequest</span> <span class="nf">error</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">NSManagedObject</span> <span class="o">*</span><span class="n">info</span> <span class="k">in</span> <span class="n">fetchedObjects</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span> <span class="s">@"classID:%d"</span> <span class="p">,</span> <span class="p">[</span><span class="n">info</span> <span class="nf">valueForKey</span><span class="p">:</span> <span class="s">@"classID"</span> <span class="p">]);</span>
        <span class="n">NSLog</span><span class="p">(</span> <span class="s">@"persons:%d"</span> <span class="p">,</span> <span class="p">[</span><span class="n">info</span> <span class="nf">valueForKey</span><span class="p">:</span> <span class="s">@"persons"</span> <span class="p">]);</span>
        <span class="n">NSLog</span><span class="p">(</span> <span class="s">@"name:%@"</span> <span class="p">,</span> <span class="p">[</span><span class="n">info</span> <span class="nf">valueForKey</span><span class="p">:</span> <span class="s">@"name"</span> <span class="p">]);</span>
        <span class="n">NSManagedObject</span> <span class="o">*</span><span class="n">details</span> <span class="o">=</span> <span class="p">[</span><span class="n">info</span> <span class="nf">valueForKey</span><span class="p">:</span> <span class="s">@"name"</span> <span class="p">];</span>
        <span class="n">NSLog</span><span class="p">(</span> <span class="s">@"age:%d"</span> <span class="p">,</span> <span class="p">[</span><span class="n">details</span> <span class="nf">valueForKey</span><span class="p">:</span> <span class="s">@"age"</span> <span class="p">]);</span>
        <span class="n">NSLog</span><span class="p">(</span> <span class="s">@"classID:%d"</span> <span class="p">,</span> <span class="p">[</span><span class="n">details</span> <span class="nf">valueForKey</span><span class="p">:</span> <span class="s">@"classID"</span> <span class="p">]);</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div>  </div>
  <p><code class="highlighter-rouge">fetchRequest</code>ç›¸å½“äº<code class="highlighter-rouge">sql</code>æŸ¥è¯¢è¯­å¥çš„åŒ…è£…ç±»ï¼Œéœ€è¦ç”¨<code class="highlighter-rouge">setEntity</code>æ–¹æ³•ï¼Œæ¥æŒ‡å®šå…·ä½“æŸ¥è¯¢çš„å®ä½“ç»“æ„ï¼ˆè¡¨ç»“æ„ï¼‰é€šè¿‡<code class="highlighter-rouge">NSEntityDescriptionçš„entityForName</code>æ–¹æ³•æ¥ï¼Œè¿”å›æŒ‡å‘è¯¥å…·ä½“å®ä½“ç»“æ„çš„æŒ‡é’ˆç„¶åè°ƒç”¨<code class="highlighter-rouge">executeFetchRequest:error:</code>æ–¹æ³•ï¼Œæ¥æ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼Œå¦‚æœæ“ä½œæˆåŠŸï¼Œåˆ™è¿”å›å¯¹åº”çš„æ•°æ®è®°å½•æ•°ç»„.<br />
å…¶ä¸­ï¼Œå¯ä»¥é€šè¿‡<code class="highlighter-rouge">NSManagedObject</code>æ•°æ®è®°å½•å¯¹è±¡é‡Œå…³è”çš„å±æ€§ï¼ŒæŸ¥è¯¢å¦ä¸€ä¸ªæ•°æ®è®°å½•å¯¹è±¡é‡Œçš„å±æ€§ä¹‹å‰ç”¨<code class="highlighter-rouge">Key-Value</code>çš„ä»£ç å°±å¯ä»¥ä¿®æ”¹ä¸ºï¼š</p>
  <div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#import "School.h"
#import "Student.h"
</span><span class="k">-</span> <span class="p">(</span> <span class="kt">void</span> <span class="p">)</span><span class="n">insertCoreData</span> <span class="p">{</span>
	<span class="n">NSManagedObjectContext</span> <span class="o">*</span><span class="n">context</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span> <span class="nf">managedObjectContext</span><span class="p">];</span>
    <span class="n">ContactInfo</span> <span class="o">*</span><span class="n">contactInfo</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSEntityDescription</span> <span class="nf">insertNewObjectForEntityForName</span><span class="p">:</span> <span class="s">@"School"</span> <span class="nf">inManagedObjectContext</span><span class="p">:</span><span class="n">context</span><span class="p">];</span>
    <span class="n">contactInfo</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">@"name B"</span> <span class="p">;</span>
    <span class="n">contactInfo</span><span class="p">.</span><span class="n">birthday</span> <span class="o">=</span> <span class="s">@"classID 0"</span> <span class="p">;</span>
    <span class="n">contactInfo</span><span class="p">.</span><span class="n">age</span> <span class="o">=</span> <span class="s">@"persons 20"</span> <span class="p">;</span>
    <span class="n">ContactDetailInfo</span> <span class="o">*</span><span class="n">contactDetailInfo</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSEntityDescription</span> <span class="nf">insertNewObjectForEntityForName</span><span class="p">:</span> <span class="s">@"Student"</span> <span class="nf">inManagedObjectContext</span><span class="p">:</span><span class="n">context</span><span class="p">];</span>
    <span class="n">contactDetailInfo</span><span class="p">.</span><span class="n">address</span> <span class="o">=</span> <span class="s">@"age 22"</span> <span class="p">;</span>
    <span class="n">contactDetailInfo</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">@"name B"</span> <span class="p">;</span>
    <span class="n">contactDetailInfo</span><span class="p">.</span><span class="n">telephone</span> <span class="o">=</span> <span class="s">@"classID 1"</span> <span class="p">;</span>
	<span class="n">contactDetailInfo</span><span class="p">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">contactInfo</span><span class="p">;</span>
	<span class="n">contactInfo</span><span class="p">.</span><span class="n">details</span> <span class="o">=</span> <span class="n">contactDetailInfo</span><span class="p">;</span>
	<span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">[</span><span class="n">context</span> <span class="nf">save</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">])</span>  <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span> <span class="s">@"ä¸èƒ½ä¿å­˜ï¼š%@"</span> <span class="p">,[</span><span class="n">error</span> <span class="nf">localizedDescription</span><span class="p">]);</span>
	<span class="p">}</span>
<span class="p">}</span>
<span class="k">-</span> <span class="p">(</span> <span class="kt">void</span> <span class="p">)</span><span class="n">dataFetchRequest</span> <span class="p">{</span>
	<span class="n">NSManagedObjectContext</span> <span class="o">*</span><span class="n">context</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span> <span class="nf">managedObjectContext</span><span class="p">];</span>
	<span class="n">NSFetchRequest</span> <span class="o">*</span><span class="n">fetchRequest</span> <span class="o">=</span> <span class="p">[[[</span><span class="n">NSFetchRequest</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">]</span> <span class="nf">autorelease</span><span class="p">];</span>
    <span class="n">NSEntityDescription</span> <span class="o">*</span><span class="n">entity</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSEntityDescription</span> <span class="nf">entityForName</span><span class="p">:</span><span class="s">@"ContactInfo"</span> <span class="nf">inManagedObjectContext</span><span class="p">:</span><span class="n">context</span><span class="p">];</span>
	<span class="p">[</span><span class="n">fetchRequest</span> <span class="nf">setEntity</span><span class="p">:</span><span class="n">entity</span><span class="p">];</span>
	<span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">;</span>
	<span class="n">NSArray</span> <span class="o">*</span><span class="n">fetchedObjects</span> <span class="o">=</span> <span class="p">[</span><span class="n">context</span> <span class="nf">executeFetchRequest</span><span class="p">:</span><span class="n">fetchRequest</span> <span class="nf">error</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">Student</span> <span class="o">*</span><span class="n">info</span> <span class="k">in</span> <span class="n">fetchedObjects</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span> <span class="s">@"name:%@"</span> <span class="p">,</span> <span class="n">info</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
        <span class="n">NSLog</span><span class="p">(</span> <span class="s">@"age:%d"</span> <span class="p">,</span> <span class="n">info</span><span class="p">.</span><span class="n">age</span><span class="p">);</span>
        <span class="n">NSLog</span><span class="p">(</span> <span class="s">@"classID:%@"</span> <span class="p">,</span> <span class="n">classID</span> <span class="p">);</span>
		<span class="n">School</span> <span class="o">*</span><span class="n">details</span> <span class="o">=</span> <span class="n">info</span><span class="p">.</span><span class="n">details</span><span class="p">;</span>
        <span class="n">NSLog</span><span class="p">(</span> <span class="s">@" persons :%d"</span> <span class="p">,</span> <span class="n">details</span><span class="p">.</span><span class="n">persons</span><span class="p">);</span>
        <span class="n">NSLog</span><span class="p">(</span> <span class="s">@" classID :%d"</span> <span class="p">,</span> <span class="n">details</span><span class="p">.</span><span class="n">classID</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div>  </div>
  <p>6.æ•°æ®åº“ç›¸å…³</p>
  <ol>
    <li>æ‰“å°éšè—çš„<code class="highlighter-rouge">sql</code>è¯­å¥ï¼š<br />
  åœ¨<code class="highlighter-rouge">Edit Scheme</code>ä¸­é€‰æ‹©<code class="highlighter-rouge">Run</code>ï¼Œä¹‹åè¿›å…¥<code class="highlighter-rouge">Arguments</code>æ ‡ç­¾ï¼Œæ·»åŠ å‚æ•°ï¼š<code class="highlighter-rouge">-com.apple.CoreData.SQLDebug 1</code></li>
    <li>ä½¿ç”¨<code class="highlighter-rouge">SQLite</code>å­˜å‚¨æ—¶ï¼Œæ•°æ®åº“ç»“æ„<br />
  å­˜å‚¨çš„<code class="highlighter-rouge">SQLite</code>æ•°æ®åº“è¡¨åç§°ï¼šå¤§å†™<code class="highlighter-rouge">Z</code>åŠ ä¸Šå®ä½“åç§°å¤§å†™ï¼Œä¸€ä¸ªå®ä½“ç›¸å½“äºä¸€å¼ è¡¨<br />
  å…·ä½“çš„å­—æ®µåç§°ï¼šå¤§å†™<code class="highlighter-rouge">Z</code>åŠ ä¸Šå®ä½“å±æ€§åç§°å¤§å†™</li>
  </ol>
</blockquote>

<h4 id="sqlite">SQLite</h4>
<p><code class="highlighter-rouge">mac os x</code>ä¸­<code class="highlighter-rouge">SQLite</code>åº“ï¼Œå®ƒæ˜¯ä¸€ä¸ªè½»é‡çº§åŠŸèƒ½å¼ºå¤§çš„å…³ç³»æ•°æ®å¼•æ“ï¼Œä¹Ÿå¾ˆå®¹æ˜“åµŒå…¥åˆ°åº”ç”¨ç¨‹åºã€‚å¯ä»¥åœ¨å¤šä¸ªå¹³å°ä½¿ç”¨ï¼Œ<code class="highlighter-rouge">SQLite</code>æ˜¯ä¸€ä¸ªè½»é‡çº§çš„åµŒå…¥å¼<code class="highlighter-rouge">sql</code>æ•°æ®åº“ç¼–ç¨‹ã€‚ä¸<code class="highlighter-rouge">core data</code>æ¡†æ¶ä¸åŒçš„æ˜¯ï¼Œ <code class="highlighter-rouge">SQLite</code>æ˜¯ä½¿ç”¨ç¨‹åºå¼çš„ï¼Œ<code class="highlighter-rouge">sql</code>çš„ä¸»è¦çš„<code class="highlighter-rouge">API</code>æ¥ç›´æ¥æ“ä½œæ•°æ®è¡¨ã€‚<br />
<code class="highlighter-rouge">SQLite3</code>æ˜¯ä¸€ä¸ªéå¸¸çµæ´»çš„æ•°æ®åº“ç³»ç»Ÿï¼Œæ²¡æœ‰æ•°æ®åº“æœåŠ¡å™¨çš„æ¦‚å¿µï¼Œè¿™åº”è¯¥ç®—æ˜¯å›å½’äº†æ¯”è¾ƒä¼ ç»Ÿçš„æ•°æ®åº“è®¾è®¡ã€‚<br />
æ—©æœŸæˆ‘ä»¬çš„æ•°æ®éƒ½æ˜¯ç›´æ¥å­˜æ”¾åœ¨æ–‡ä»¶ç³»ç»Ÿï¼Œç”±äºç®€å•çš„æ–‡ä»¶ç³»ç»Ÿå­˜åœ¨æ•°æ®å†—ä½™ã€ä¸ä¸€è‡´ã€è¯»å–æ“ä½œç¹çï¼ˆæ¯ä¸ªæ•°æ®ç»“æ„éƒ½å¯èƒ½è¦ç¼–å†™è‡ªå·±çš„è¯»å†™ç¨‹åºï¼‰ç­‰ï¼Œæ…¢æ…¢å½¢æˆäº†æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œä¸€å¥—å®Œæ•´çš„æ•°æ®åº“ç†è®ºã€‚<br />
ç›®å‰è¾ƒä¸ºæµè¡Œçš„<code class="highlighter-rouge">Oracle, SqlServer</code>, <code class="highlighter-rouge">MySql</code>ç­‰æ•°æ®åº“ç³»ç»Ÿå‡æ˜¯æœåŠ¡å™¨-å®¢æˆ·ç«¯çš„æ¦‚å¿µï¼Œæ•°æ®åº“æœåŠ¡å™¨è´Ÿè´£æ‰€æœ‰çš„æ•°æ®ç®¡ç†ã€æƒé™ç®¡ç†ç­‰ï¼Œå®¢æˆ·ç«¯æŒ‰ç…§ä¸€å®šæ ¼å¼å‘å‡ºè¯·æ±‚å³å¯ã€‚<br />
<code class="highlighter-rouge">sql</code>åˆ™æ˜¯è¾ƒä¸ºæµè¡Œçš„ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼Œä¸ºä¼—å¤šä¸Šå±‚åº”ç”¨æä¾›ç®€å•æ–¹ä¾¿çš„æ•°æ®åº“è¯»å†™æ“ä½œç­‰ã€‚<br />
ä½†æ˜¯å¯æƒ³è€ŒçŸ¥ï¼ŒæœåŠ¡å™¨ç«¯å¿…å®šæ˜¯éœ€è¦å¯¹<code class="highlighter-rouge">sql</code>è¯·æ±‚è¿›è¡Œè§£æç„¶åæ‰§è¡Œçš„ï¼Œé‚£ä¹ˆè¿™äº›æ‰§è¡Œç¨‹åºè¿˜å¾—å›å½’æ›´åº•å±‚çš„è¯­è¨€ï¼Œæ¯”å¦‚<code class="highlighter-rouge">C</code>&amp;<code class="highlighter-rouge">C++</code>çš„å®ç°ã€‚</p>
<blockquote>
  <p>æ³¨æ„ï¼š<br />
ç¬¬1ä»£è¯­è¨€ æœºå™¨è¯­è¨€ï¼ˆæŒ‡ä»¤ç³»ç»Ÿï¼‰å…¶æŒ‡ä»¤ä¸ºäºŒè¿›åˆ¶ä»£ç (0ã€1)ï¼Œç›´æ¥å¯¹åº”èŠ¯ç‰‡ä¸Šçš„è¿ç®—äº†<br />
ç¬¬2ä»£è¯­è¨€ æ±‡ç¼–è¯­è¨€ ç”¨â€œåŠ©è®°ç¬¦â€ä»£æ›¿äºŒè¿›åˆ¶ä»£ç ï¼Œå¦‚ç”¨ADD A,Bè¡¨ç¤ºä¸¤æ•°ç›¸åŠ ã€‚<br />
ç¬¬3ä»£è¯­è¨€ é«˜çº§è¯­è¨€ï¼ˆé¢å‘è¿‡ç¨‹ï¼‰ä¾‹å¦‚ï¼š<code class="highlighter-rouge">C</code>ã€<code class="highlighter-rouge">JAVA</code>ã€<code class="highlighter-rouge">C++</code>ã€‚<br />
ç¬¬4ä»£è¯­è¨€ï¼ˆéè¿‡ç¨‹åŒ–è¯­è¨€ï¼‰  ä¾‹å¦‚ï¼š<code class="highlighter-rouge">SQL</code>è¯­è¨€ã€‚<br />
ç¬¬5ä»£è¯­è¨€ï¼ˆæ™ºèƒ½åŒ–è¯­è¨€ï¼‰ ä¾‹å¦‚ï¼š<code class="highlighter-rouge">Prolog</code>è¯­è¨€ï¼‰</p>
</blockquote>

<p>è€Œ<code class="highlighter-rouge">SQLite3</code>ä»åŠŸèƒ½ä¸Šæ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªæ•°æ®åº“ç³»ç»Ÿï¼Œå…¶æœ¬è´¨ä¸Šæ˜¯ç”±ä¸€å¥—ç”¨<code class="highlighter-rouge">C</code>è¯­è¨€å®ç°çš„å¯¹æ•°æ®åº“æ–‡ä»¶çš„è¯»å†™æ¥å£ã€‚æ­¤ç±»æ¥å£æ”¯æŒ<code class="highlighter-rouge">sql</code>è¯­è¨€ã€‚æ‰€ä»¥ï¼Œè¿™ä¸éœ€è¦ä»€ä¹ˆæœåŠ¡å™¨ï¼Œä¹Ÿæ²¡æœ‰æ•°æ®åº“æƒé™ç®¡ç†ã€‚åœ¨ç¨‹åºä¸­å¯ä»¥éšæ—¶è°ƒç”¨<code class="highlighter-rouge">API</code>åˆ›å»ºä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ï¼Œè¿›è¡Œæ•°æ®å­˜å‚¨ï¼Œéå¸¸çµæ´»æ˜“ç”¨ã€‚</p>

<h5 id="å»ºç«‹sqlite30æ•°æ®åº“">å»ºç«‹<code class="highlighter-rouge">SQLite3.0</code>æ•°æ®åº“</h5>
<p>åœ¨<code class="highlighter-rouge">Firefox</code>ä¸­æ‰“å¼€<code class="highlighter-rouge">SQLite3</code>ï¼ˆå¦‚æœæ²¡æœ‰ï¼Œé€‰æ‹©å·¥å…·-&gt;é™„åŠ ç»„ä»¶ï¼Œæ·»åŠ å³å¯ï¼‰æ–°å»º<code class="highlighter-rouge">SQLite3</code>æ•°æ®åº“,<code class="highlighter-rouge">Contacts</code>,
å»ºç«‹ä¸€ä¸ª<code class="highlighter-rouge">members</code>è¡¨ï¼Œå­—æ®µ <code class="highlighter-rouge">id</code>,<code class="highlighter-rouge">integer</code>,ä¸»é”®ï¼Œè‡ªå¢;<code class="highlighter-rouge">name</code>,<code class="highlighter-rouge">varchar</code>;<code class="highlighter-rouge">email</code>,<code class="highlighter-rouge">varchar</code>,<code class="highlighter-rouge">null</code>;<code class="highlighter-rouge">birthday</code>,<code class="highlighter-rouge">datetime</code>,<code class="highlighter-rouge">null</code>ã€‚<br />
å‘è¡¨ä¸­æ·»åŠ ä¸€äº›æ•°æ®ï¼š<br />
<img src="/img/noimg.jpeg" alt="æ–°æµªåšå®¢çš„å›¾ç‰‡ä¸¢å¤±äº†" /></p>
<h5 id="sqliteä½¿ç”¨ä»£ç "><code class="highlighter-rouge">SQLite</code>ä½¿ç”¨ä»£ç </h5>
<p>æ–°å»º<code class="highlighter-rouge">Empty Appliation</code>ï¼Œæ·»åŠ ä¸€ä¸ª<code class="highlighter-rouge">HomeViewController</code>ï¼Œå’Œä¸€ä¸ªç»„ä»¶<code class="highlighter-rouge">libSQLite3.dylib</code>,æ¥æ”¯æŒå¯¹<code class="highlighter-rouge">SQLite3</code>çš„è¿æ¥ï¼Œå…³é—­ï¼Œå¢åˆ æ”¹æŸ¥ç­‰æ“ä½œã€‚</p>
<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//HomeViewController.hä»£ç ï¼š</span>
<span class="cp">#import
#import "SQLite3.h"
</span><span class="k">@interface</span> <span class="nc">HomeViewController</span> <span class="p">:</span> <span class="nc">UIViewController</span><span class="p">{</span>
	<span class="n">SQLite3</span> <span class="o">*</span><span class="n">db</span><span class="p">;</span> <span class="c1">//å£°æ˜ä¸€ä¸ªSQLite3æ•°æ®åº“</span>
<span class="p">}</span>
<span class="k">-</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">filePath</span><span class="p">;</span><span class="c1">//æ•°æ®åº“æ–‡ä»¶çš„è·¯å¾„ã€‚ä¸€èˆ¬åœ¨æ²™ç®±çš„Documentsé‡Œè¾¹æ“ä½œ</span>
<span class="k">@end</span>
<span class="c1">//HomeViewController.mä»£ç ï¼š</span>
<span class="cp">#import "HomeViewController.h"
</span><span class="k">@interface</span> <span class="nc">HomeViewController</span> <span class="p">()</span>

<span class="k">@end</span>
<span class="k">@implementation</span> <span class="nc">HomeViewController</span>

<span class="c1">//è¯¥æ–¹æ³•ç”¨äºè¿”å›æ•°æ®åº“åœ¨Documentsæ–‡ä»¶å¤¹ä¸­çš„å…¨è·¯å¾„ä¿¡æ¯</span>
<span class="k">-</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">filePath</span><span class="p">{</span>
	<span class="n">NSArray</span> <span class="o">*</span><span class="n">paths</span> <span class="o">=</span> <span class="n">NSSearchPathForDirectoriesInDomains</span><span class="p">(</span><span class="n">NSDocumentDirectory</span><span class="p">,</span> <span class="n">NSUserDomainMask</span><span class="p">,</span> <span class="nb">YES</span><span class="p">);</span>
	<span class="n">NSString</span> <span class="o">*</span><span class="n">documentsDir</span> <span class="o">=</span> <span class="p">[</span><span class="n">paths</span> <span class="nf">objectAtIndex</span><span class="p">:</span><span class="mi">0</span><span class="p">];</span>
	<span class="k">return</span> <span class="p">[</span><span class="n">documentsDir</span> <span class="nf">stringByAppendingPathComponent</span><span class="p">:</span><span class="s">@"Contacts.SQLite"</span><span class="p">];</span>
<span class="p">}</span>
<span class="c1">//æ‰“å¼€æ•°æ®åº“çš„æ–¹æ³•</span>
<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">openDB</span><span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">SQLite3_open</span><span class="p">([[</span><span class="n">self</span> <span class="nf">filePath</span><span class="p">]</span> <span class="nf">UTF8String</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">db</span><span class="p">)</span> <span class="o">!=</span> <span class="n">SQLite_OK</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">SQLite3_close</span><span class="p">(</span><span class="n">db</span><span class="p">);</span>
	<span class="n">NSAssert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">@"æ•°æ®åº“æ‰“å¼€å¤±è´¥ã€‚"</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
<span class="c1">//æ’å…¥æ•°æ®æ–¹æ³•</span>
<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">insertRecordIntoTableName</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">tableName</span> <span class="nf">withField1</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">field1</span> <span class="nf">field1Value</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">field1Value</span> <span class="nf">andField2</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">field2</span> <span class="nf">field2Value</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">field2Value</span> <span class="nf">andField3</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">field3</span> <span class="nf">field3Value</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">field3Value</span><span class="p">{</span>

    <span class="c1">//æ–¹æ³•2ï¼šå˜é‡çš„ç»‘å®šæ–¹æ³• </span>
    <span class="n">NSString</span> <span class="o">*</span><span class="n">sql</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="s">@"INSERT INTO '%@' ('%@', '%@', '%@') VALUES (?, ?, ?)"</span><span class="p">,</span><span class="n">tableName</span><span class="p">,</span> <span class="n">field1</span><span class="p">,</span> <span class="n">field2</span><span class="p">,</span> <span class="n">field3</span><span class="p">];</span>
	<span class="n">SQLite3_stmt</span> <span class="o">*</span><span class="n">statement</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">SQLite3_prepare_v2</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="p">[</span><span class="n">sql</span> <span class="nf">UTF8String</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">statement</span><span class="p">,</span> <span class="nb">nil</span><span class="p">)</span> <span class="o">==</span> <span class="n">SQLite_OK</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">SQLite3_bind_text</span><span class="p">(</span><span class="n">statement</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">field1Value</span> <span class="nf">UTF8String</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">NULL</span><span class="p">);</span>
		<span class="n">SQLite3_bind_text</span><span class="p">(</span><span class="n">statement</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">field2Value</span> <span class="nf">UTF8String</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">NULL</span><span class="p">);</span>
		<span class="n">SQLite3_bind_text</span><span class="p">(</span><span class="n">statement</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">field3Value</span> <span class="nf">UTF8String</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">NULL</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">SQLite3_step</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span> <span class="o">!=</span> <span class="n">SQLite_DONE</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">NSAssert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">@"æ’å…¥æ•°æ®å¤±è´¥ï¼"</span><span class="p">);</span>
		<span class="n">SQLite3_finalize</span><span class="p">(</span><span class="n">statement</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="c1">//æŸ¥è¯¢æ•°æ®</span>
<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">getAllContacts</span><span class="p">{</span>

	<span class="n">NSString</span> <span class="o">*</span><span class="n">sql</span> <span class="o">=</span> <span class="s">@"SELECT * FROM members"</span><span class="p">;</span>
	<span class="n">SQLite3_stmt</span> <span class="o">*</span><span class="n">statement</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">SQLite3_prepare_v2</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="p">[</span><span class="n">sql</span> <span class="nf">UTF8String</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">statement</span><span class="p">,</span> <span class="nb">nil</span><span class="p">)</span> <span class="o">==</span> <span class="n">SQLite_OK</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">while</span> <span class="p">(</span><span class="n">SQLite3_step</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span> <span class="o">==</span> <span class="n">SQLite_ROW</span><span class="p">)</span> <span class="p">{</span>
			<span class="kt">char</span> <span class="o">*</span><span class="n">name</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">SQLite3_column_text</span><span class="p">(</span><span class="n">statement</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
			<span class="n">NSString</span> <span class="o">*</span><span class="n">nameStr</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSString</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithUTF8String</span><span class="p">:</span><span class="n">name</span><span class="p">];</span>
			<span class="kt">char</span> <span class="o">*</span><span class="n">email</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">SQLite3_column_text</span><span class="p">(</span><span class="n">statement</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">NSString</span> <span class="o">*</span><span class="n">emailStr</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSString</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithUTF8String</span><span class="p">:</span><span class="n">email</span><span class="p">];</span>
			<span class="kt">char</span> <span class="o">*</span><span class="n">birthday</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">SQLite3_column_text</span><span class="p">(</span><span class="n">statement</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
			<span class="n">NSString</span> <span class="o">*</span><span class="n">birthdayStr</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSString</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithUTF8String</span><span class="p">:</span><span class="n">birthday</span><span class="p">];</span>
			<span class="n">NSString</span> <span class="o">*</span><span class="n">info</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSString</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithFormat</span><span class="p">:</span><span class="s">@"%@ - %@ - %@"</span><span class="p">,</span>
			<span class="n">nameStr</span><span class="p">,</span> <span class="n">emailStr</span><span class="p">,</span> <span class="n">birthdayStr</span><span class="p">];</span>
			<span class="n">NSLog</span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
			<span class="p">[</span><span class="n">nameStr</span> <span class="nf">release</span><span class="p">];</span>
			<span class="p">[</span><span class="n">emailStr</span> <span class="nf">release</span><span class="p">];</span>
			<span class="p">[</span><span class="n">birthdayStr</span> <span class="nf">release</span><span class="p">];</span>
			<span class="p">[</span><span class="n">info</span> <span class="nf">release</span><span class="p">];</span>
		<span class="p">}</span>
		<span class="n">SQLite3_finalize</span><span class="p">(</span><span class="n">statement</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">viewDidLoad</span>  <span class="p">{</span>

    <span class="p">[</span><span class="n">self</span> <span class="nf">openDB</span><span class="p">];</span>
    <span class="p">[</span><span class="n">self</span> <span class="nf">insertRecordIntoTableName</span><span class="p">:</span><span class="s">@"members"</span> <span class="nf">withField1</span><span class="p">:</span><span class="s">@"name"</span> <span class="n">field1Value</span><span class="o">:</span><span class="s">@"æ1"</span> <span class="n">andField2</span><span class="o">:</span><span class="s">@"email"</span> <span class="n">field2Value</span><span class="o">:</span><span class="s">@" df@qq.com "</span> <span class="n">andField3</span><span class="o">:</span><span class="s">@"birthday"</span> <span class="n">field3Value</span><span class="o">:</span><span class="s">@"12-45-78"</span><span class="p">];</span>
    <span class="p">[</span><span class="n">self</span> <span class="nf">insertRecordIntoTableName</span><span class="p">:</span><span class="s">@"members"</span> <span class="nf">withField1</span><span class="p">:</span><span class="s">@"name"</span> <span class="n">field1Value</span><span class="o">:</span><span class="s">@"æ2"</span> <span class="n">andField2</span><span class="o">:</span><span class="s">@"email"</span> <span class="n">field2Value</span><span class="o">:</span><span class="s">@" df@qq.com "</span> <span class="n">andField3</span><span class="o">:</span><span class="s">@"birthday"</span> <span class="n">field3Value</span><span class="o">:</span><span class="s">@"12-45-78"</span><span class="p">];</span>
    <span class="p">[</span><span class="n">self</span> <span class="nf">insertRecordIntoTableName</span><span class="p">:</span><span class="s">@"members"</span> <span class="nf">withField1</span><span class="p">:</span><span class="s">@"name"</span> <span class="n">field1Value</span><span class="o">:</span><span class="s">@"æ3"</span> <span class="n">andField2</span><span class="o">:</span><span class="s">@"email"</span> <span class="n">field2Value</span><span class="o">:</span><span class="s">@" df@qq.com "</span> <span class="n">andField3</span><span class="o">:</span><span class="s">@"birthday"</span> <span class="n">field3Value</span><span class="o">:</span><span class="s">@"12-45-78"</span><span class="p">];</span>
    <span class="p">[</span><span class="n">self</span> <span class="nf">getAllContacts</span><span class="p">];</span>
	<span class="n">SQLite3_close</span><span class="p">(</span><span class="n">db</span><span class="p">);</span>
	<span class="p">[</span><span class="n">super</span> <span class="nf">viewDidLoad</span><span class="p">];</span>
<span class="p">}</span>
<span class="k">@end</span>
</code></pre></div></div>
<p>æ’å…¥æ•°æ®åçš„æ•ˆæœï¼š<br />
<img src="/img/noimg.jpeg" alt="æ–°æµªåšå®¢çš„å›¾ç‰‡ä¸¢å¤±äº†" />
æŸ¥è¯¢çš„æ•ˆæœï¼š
<img src="/img/noimg.jpeg" alt="æ–°æµªåšå®¢çš„å›¾ç‰‡ä¸¢å¤±äº†" /></p>

<h5 id="å°ç»“">å°ç»“ï¼š</h5>
<p>æ•°æ®æŸ¥è¯¢ï¼š<code class="highlighter-rouge">SQLite3_exec()</code>å‡½æ•°æ‰§è¡Œ<code class="highlighter-rouge">sql</code>è¯­å¥ï¼Œåœ¨æ²¡æœ‰è¿”å›å€¼çš„æƒ…å†µä¸‹ï¼ˆæ¯”å¦‚åˆ›å»ºè¡¨æ ¼ã€æ’å…¥è®°å½•ã€åˆ é™¤è®°å½•ç­‰æ“ä½œä¸­ï¼‰å¾ˆå¥½ç”¨ã€‚
ä¹Ÿä¼šç”¨åˆ°<code class="highlighter-rouge">SQLite3_stat</code>ç»“æ„ã€<code class="highlighter-rouge">SQLite3_prepare_v2()</code>å‡½æ•°ã€<code class="highlighter-rouge">sqlte3_step()</code>å‡½æ•°å’Œ<code class="highlighter-rouge">SQLite3_finalize()</code>å‡½æ•°ã€‚
æŸ¥è¯¢åˆ†ä¸‰ä¸ªé˜¶æ®µï¼š<br />
  å‡†å¤‡é˜¶æ®µï¼š<code class="highlighter-rouge">SQLite3_stat</code>ã€<code class="highlighter-rouge">SQLite3_prepare_v2()</code><br />
  æ‰§è¡Œé˜¶æ®µï¼š<code class="highlighter-rouge">sqlte3_step()</code><br />
  ç»ˆæ­¢é˜¶æ®µï¼š <code class="highlighter-rouge">SQLite3_finalize()</code></p>

<h4 id="fmdb">FMDB</h4>

<p><code class="highlighter-rouge">FMDB</code>æ¡†æ¶å…¶å®åªæ˜¯ä¸€å±‚å¾ˆè–„çš„å°è£…ï¼Œä¸»è¦çš„ç±»ä¹Ÿå°±ä¸¤ä¸ªï¼š<code class="highlighter-rouge">FMDatabaseå’ŒFMResultSet</code>ã€‚åœ¨ä½¿ç”¨<code class="highlighter-rouge">FMDB</code>çš„æ—¶å€™è¿˜éœ€è¦å¯¼å…¥<code class="highlighter-rouge">libSQLite3.0.dylib</code>ã€‚<br />
<code class="highlighter-rouge">iOS</code>ä¸­åŸç”Ÿçš„<code class="highlighter-rouge">SQLite API</code>åœ¨ä½¿ç”¨ä¸Šç›¸å½“ä¸å‹å¥½ï¼Œåœ¨ä½¿ç”¨æ—¶ï¼Œéå¸¸ä¸ä¾¿ã€‚äºæ˜¯ï¼Œå°±å‡ºç°äº†ä¸€ç³»åˆ—å°†<code class="highlighter-rouge">SQLite API</code>è¿›è¡Œå°è£…çš„åº“ï¼Œä¾‹å¦‚<code class="highlighter-rouge">FMDB</code>ã€ <code class="highlighter-rouge">PlausibleDatabase</code>ã€<code class="highlighter-rouge">SQLitepersistentobjects</code>ç­‰ï¼Œ <a href="https://github.com/ccgus/FMDB">FMDB</a>æ˜¯ä¸€æ¬¾ç®€æ´ã€æ˜“ç”¨çš„å°è£…åº“ï¼Œè¿™ä¸€ç¯‡æ–‡ç« ç®€å•ä»‹ç»ä¸‹<code class="highlighter-rouge">FMDB</code>çš„ä½¿ç”¨ã€‚<br />
åœ¨<code class="highlighter-rouge">FMDB</code>ä¸‹è½½æ–‡ä»¶åï¼Œå·¥ç¨‹ä¸­å¿…é¡»å¯¼å…¥å¦‚ä¸‹æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ <code class="highlighter-rouge">libSQLite3.dylib</code> ä¾èµ–åŒ…ã€‚<br />
<img src="/img/noimg.jpeg" alt="æ–°æµªåšå®¢çš„å›¾ç‰‡ä¸¢å¤±äº†" />
<code class="highlighter-rouge">FMDB</code>åŒæ—¶å…¼å®¹<code class="highlighter-rouge">AR</code>Cå’Œ<code class="highlighter-rouge">éARC</code>å·¥ç¨‹ï¼Œä¼šè‡ªåŠ¨æ ¹æ®å·¥ç¨‹é…ç½®æ¥è°ƒæ•´ç›¸å…³çš„å†…å­˜ç®¡ç†ä»£ç ã€‚</p>
<blockquote>
  <p><code class="highlighter-rouge">FMDB</code>å¸¸ç”¨ç±»ï¼š<br />
<code class="highlighter-rouge">FMDatabase</code> ï¼š ä¸€ä¸ªå•ä¸€çš„<code class="highlighter-rouge">SQLite</code>æ•°æ®åº“ï¼Œç”¨äºæ‰§è¡Œ<code class="highlighter-rouge">SQL</code>è¯­å¥ã€‚<br />
<code class="highlighter-rouge">FMResultSet</code> ï¼šæ‰§è¡ŒæŸ¥è¯¢ä¸€ä¸ª<code class="highlighter-rouge">FMDatabase</code>ç»“æœé›†ï¼Œè¿™ä¸ªå’Œ<code class="highlighter-rouge">android</code>çš„<code class="highlighter-rouge">Cursor</code>ç±»ä¼¼ã€‚<br />
<code class="highlighter-rouge">FMDatabaseQueue</code> ï¼šåœ¨å¤šä¸ªçº¿ç¨‹æ¥æ‰§è¡ŒæŸ¥è¯¢å’Œæ›´æ–°æ—¶ä¼šä½¿ç”¨è¿™ä¸ªç±»ã€‚</p>
</blockquote>

<h5 id="æ•°æ®åŸºæœ¬æ“ä½œ">æ•°æ®åŸºæœ¬æ“ä½œ</h5>
<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//åˆ›å»ºæ•°æ®åº“ï¼š</span>
	<span class="c1">//å½“æ•°æ®åº“æ–‡ä»¶ä¸å­˜åœ¨æ—¶ï¼ŒFMDBä¼šè‡ªå·±åˆ›å»ºä¸€ä¸ªã€‚</span>
	<span class="c1">//å¦‚æœä½ ä¼ å…¥çš„å‚æ•°æ˜¯ç©ºä¸²ï¼š@"" ï¼Œåˆ™FMDBä¼šåœ¨ä¸´æ—¶æ–‡ä»¶ç›®å½•ä¸‹åˆ›å»ºè¿™ä¸ªæ•°æ®åº“ï¼Œæ•°æ®åº“æ–­å¼€è¿æ¥æ—¶ï¼Œæ•°æ®åº“æ–‡ä»¶è¢«åˆ é™¤ã€‚</span>
	<span class="c1">//å¦‚æœä½ ä¼ å…¥çš„å‚æ•°æ˜¯ NULLï¼Œåˆ™å®ƒä¼šå»ºç«‹ä¸€ä¸ªåœ¨å†…å­˜ä¸­çš„æ•°æ®åº“ï¼Œæ•°æ®åº“æ–­å¼€è¿æ¥æ—¶ï¼Œæ•°æ®åº“æ–‡ä»¶è¢«åˆ é™¤ã€‚</span>

<span class="n">db</span><span class="o">=</span> <span class="p">[</span><span class="n">FMDatabase</span> <span class="nf">databaseWithPath</span><span class="p">:</span><span class="n">database_path</span><span class="p">];</span> 

<span class="c1">//æ‰“å¼€æ•°æ®åº“ï¼šè¿”å›BOOLå‹ã€‚</span>
<span class="p">[</span><span class="n">db</span> <span class="nf">open</span><span class="p">];</span>

<span class="c1">//å…³é—­æ•°æ®åº“ï¼š</span>
<span class="p">[</span><span class="n">db</span> <span class="nf">close</span><span class="p">];</span> 
</code></pre></div></div>
<h5 id="æ•°æ®åº“å¢åˆ æ”¹ç­‰æ“ä½œ">æ•°æ®åº“å¢åˆ æ”¹ç­‰æ“ä½œï¼š</h5>

<p>é™¤äº†æŸ¥è¯¢æ“ä½œï¼Œ<code class="highlighter-rouge">FMDB</code>æ•°æ®åº“æ“ä½œéƒ½æ‰§è¡Œ<code class="highlighter-rouge">executeUpdate</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›<code class="highlighter-rouge">BOOL</code>å‹ã€‚
çœ‹ä¸€ä¸‹ä¾‹å­ï¼š</p>
<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//1.åˆ›å»ºè¡¨ï¼š</span>
<span class="k">if</span> <span class="p">([</span><span class="n">db</span> <span class="nf">open</span><span class="p">])</span> <span class="p">{</span> 
	<span class="n">NSString</span> <span class="o">*</span><span class="n">sqlCreateTable</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="s">@"CREATE TABLE IF NOT EXISTS '%@' ('%@' INTEGER PRIMARY KEY AUTOINCREMENT, '%@' TEXT, '%@' INTEGER, '%@' TEXT)"</span><span class="p">,</span><span class="n">TABLENAME</span><span class="p">,</span><span class="n">ID</span><span class="p">,</span><span class="n">NAME</span><span class="p">,</span><span class="n">AGE</span><span class="p">,</span><span class="n">ADDRESS</span><span class="p">];</span>
	<span class="n">BOOL</span> <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">db</span> <span class="nf">executeUpdate</span><span class="p">:</span><span class="n">sqlCreateTable</span><span class="p">];</span> 
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">res</span><span class="p">)</span> <span class="p">{</span> 
		<span class="n">NSLog</span><span class="p">(</span><span class="err">@</span> <span class="s">"error when creating db table"</span> <span class="p">);</span>
	<span class="p">}</span>  <span class="k">else</span> <span class="p">{</span> 
		<span class="n">NSLog</span><span class="p">(</span><span class="err">@</span> <span class="s">"success to creating db table"</span> <span class="p">);</span>  
	<span class="p">}</span> 
	<span class="p">[</span><span class="n">db</span> <span class="nf">close</span><span class="p">];</span> 
<span class="p">}</span>

<span class="c1">//2.æ·»åŠ æ•°æ®ï¼š</span>
<span class="k">if</span> <span class="p">([</span><span class="n">db</span> <span class="nf">open</span><span class="p">])</span> <span class="p">{</span> 

	<span class="n">NSString</span> <span class="o">*</span><span class="n">insertSql1</span><span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span> 
	<span class="s">@"INSERT INTO '%@' ('%@', '%@', '%@') VALUES ('%@', '%@', '%@')"</span><span class="p">,</span> <span class="n">TABLENAME</span><span class="p">,</span> <span class="n">NAME</span><span class="p">,</span> <span class="n">AGE</span><span class="p">,</span> <span class="n">ADDRESS</span><span class="p">,</span> <span class="err">@</span> <span class="s">"å¼ ä¸‰"</span> <span class="p">,</span> <span class="err">@</span> <span class="s">"13"</span> <span class="p">,</span> <span class="err">@</span> <span class="s">"æµå—"</span> <span class="p">];</span> 
	<span class="n">BOOL</span> <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">db</span> <span class="nf">executeUpdate</span><span class="p">:</span><span class="n">insertSql1</span><span class="p">];</span> 
	<span class="n">NSString</span> <span class="o">*</span><span class="n">insertSql2</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span> 
	<span class="s">@"INSERT INTO '%@' ('%@', '%@', '%@') VALUES ('%@', '%@', '%@')"</span><span class="p">,</span><span class="n">TABLENAME</span><span class="p">,</span> <span class="n">NAME</span><span class="p">,</span> <span class="n">AGE</span><span class="p">,</span> <span class="n">ADDRESS</span><span class="p">,</span> <span class="err">@</span> <span class="s">"æå››"</span> <span class="p">,</span> <span class="err">@</span> <span class="s">"12"</span> <span class="p">,</span> <span class="err">@</span> <span class="s">"æµå—"</span> <span class="p">];</span> 
	<span class="n">BOOL</span> <span class="n">res2</span> <span class="o">=</span> <span class="p">[</span><span class="n">db</span> <span class="nf">executeUpdate</span><span class="p">:</span><span class="n">insertSql2</span><span class="p">];</span> 
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">res</span><span class="p">)</span> <span class="p">{</span> 
		<span class="n">NSLog</span><span class="p">(</span><span class="s">@"error when insert db table"</span><span class="p">);</span> 
	<span class="p">}</span>  <span class="k">else</span> <span class="p">{</span> 
		<span class="n">NSLog</span><span class="p">(</span><span class="s">@"success to insert db table"</span><span class="p">);</span> 
	<span class="p">}</span> 
	<span class="p">[</span><span class="n">db</span> <span class="nf">close</span><span class="p">];</span> 
<span class="p">}</span>

<span class="c1">//3.ä¿®æ”¹æ•°æ®ï¼š</span>
<span class="k">if</span> <span class="p">([</span><span class="n">db</span> <span class="nf">open</span><span class="p">])</span> <span class="p">{</span> 

	<span class="n">NSString</span> <span class="o">*</span><span class="n">updateSql</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span> 
	<span class="s">@"UPDATE '%@' SET '%@' = '%@' WHERE '%@' = '%@'"</span><span class="p">,</span><span class="n">TABLENAME</span><span class="p">,</span> <span class="n">AGE</span><span class="p">,</span> <span class="s">@"15"</span> <span class="p">,</span><span class="n">AGE</span><span class="p">,</span> <span class="err">@</span> <span class="s">"13"</span> <span class="p">];</span> 
	<span class="n">BOOL</span> <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">db</span> <span class="nf">executeUpdate</span><span class="p">:</span><span class="n">updateSql</span><span class="p">];</span> 
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">res</span><span class="p">)</span> <span class="p">{</span> 
		<span class="n">NSLog</span><span class="p">(</span><span class="s">@"error when update db table"</span><span class="p">);</span> 
	<span class="p">}</span>  <span class="k">else</span> <span class="p">{</span> 
		<span class="n">NSLog</span><span class="p">(</span><span class="s">@"success to update db table"</span><span class="p">);</span> 
	<span class="p">}</span> 
	<span class="p">[</span><span class="n">db</span> <span class="nf">close</span><span class="p">];</span> 

<span class="p">}</span> 

<span class="c1">//4.åˆ é™¤æ•°æ®ï¼š</span>
<span class="k">if</span> <span class="p">([</span><span class="n">db</span> <span class="nf">open</span><span class="p">])</span> <span class="p">{</span> 
	<span class="n">NSString</span> <span class="o">*</span><span class="n">deleteSql</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span> <span class="err">@</span> <span class="s">"delete from %@ where %@ = '%@'"</span> <span class="p">,</span> <span class="n">TABLENAME</span><span class="p">,</span> <span class="n">NAME</span><span class="p">,</span> <span class="err">@</span> <span class="s">"å¼ ä¸‰"</span> <span class="p">];</span> 
	<span class="n">BOOL</span> <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">db</span> <span class="nf">executeUpdate</span><span class="p">:</span><span class="n">deleteSql</span><span class="p">];</span> 
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">res</span><span class="p">)</span> <span class="p">{</span> 
		<span class="n">NSLog</span><span class="p">(</span><span class="s">@"error when delete db table"</span><span class="p">);</span> 
	<span class="p">}</span>  <span class="k">else</span> <span class="p">{</span> 
		<span class="n">NSLog</span><span class="p">(</span><span class="s">@"success to delete db table"</span><span class="p">);</span> 
	<span class="p">}</span> 
	<span class="p">[</span><span class="n">db</span> <span class="nf">close</span><span class="p">];</span> 
<span class="p">}</span> 

<span class="c1">//5.æ•°æ®åº“æŸ¥è¯¢æ“ä½œï¼šæŸ¥è¯¢æ“ä½œä½¿ç”¨äº†executeQueryï¼Œå¹¶æ¶‰åŠåˆ° FMResultSetã€‚FMDBçš„FMResultSetæä¾›äº†å¤šä¸ªæ–¹æ³•æ¥è·å–ä¸åŒç±»å‹çš„æ•°æ®ï¼š</span>
<span class="k">if</span> <span class="p">([</span><span class="n">db</span> <span class="nf">open</span><span class="p">])</span> <span class="p">{</span> 

	<span class="n">NSString</span> <span class="o">*</span> <span class="n">sql</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span> <span class="err">@</span> <span class="s">"SELECT * FROM %@"</span> <span class="p">,</span><span class="n">TABLENAME</span><span class="p">];</span> 
	<span class="n">FMResultSet</span> <span class="o">*</span> <span class="n">rs</span> <span class="o">=</span> <span class="p">[</span><span class="n">db</span> <span class="nf">executeQuery</span><span class="p">:</span><span class="n">sql</span><span class="p">];</span> 
	<span class="k">while</span> <span class="p">([</span><span class="n">rs</span> <span class="nf">next</span><span class="p">])</span> <span class="p">{</span> 
		<span class="kt">int</span> <span class="n">Id</span> <span class="o">=</span> <span class="p">[</span><span class="n">rs</span> <span class="nf">intForColumn</span><span class="p">:</span><span class="n">ID</span><span class="p">];</span> 
		<span class="n">NSString</span> <span class="o">*</span> <span class="n">name</span> <span class="o">=</span> <span class="p">[</span><span class="n">rs</span> <span class="nf">stringForColumn</span><span class="p">:</span><span class="n">NAME</span><span class="p">];</span> 
		<span class="n">NSString</span> <span class="o">*</span> <span class="n">age</span> <span class="o">=</span> <span class="p">[</span><span class="n">rs</span> <span class="nf">stringForColumn</span><span class="p">:</span><span class="n">AGE</span><span class="p">];</span> 
		<span class="n">NSString</span> <span class="o">*</span> <span class="n">address</span> <span class="o">=</span> <span class="p">[</span><span class="n">rs</span> <span class="nf">stringForColumn</span><span class="p">:</span><span class="n">ADDRESS</span><span class="p">];</span> 
		<span class="n">NSLog</span><span class="p">(</span><span class="s">@"id = %d, name = %@, age = %@ address = %@"</span><span class="p">,</span> <span class="n">Id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">address</span><span class="p">);</span> 
	<span class="p">}</span> 
	<span class="p">[</span><span class="n">db</span> <span class="nf">close</span><span class="p">];</span> 
<span class="p">}</span> 
</code></pre></div></div>
<h5 id="æ•°æ®åº“å¤šçº¿ç¨‹æ“ä½œ">æ•°æ®åº“å¤šçº¿ç¨‹æ“ä½œï¼š</h5>

<p>å¦‚æœåº”ç”¨ä¸­ä½¿ç”¨äº†å¤šçº¿ç¨‹æ“ä½œæ•°æ®åº“ï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨<code class="highlighter-rouge">FMDatabaseQueue</code>æ¥ä¿è¯çº¿ç¨‹å®‰å…¨äº†ã€‚åº”ç”¨ä¸­ä¸å¯åœ¨å¤šä¸ªçº¿ç¨‹ä¸­å…±åŒä½¿ç”¨ä¸€ä¸ª<code class="highlighter-rouge">FMDatabase</code>å¯¹è±¡æ“ä½œæ•°æ®åº“ï¼Œè¿™æ ·ä¼šå¼•èµ·æ•°æ®åº“æ•°æ®æ··ä¹±ã€‚ ä¸ºäº†å¤šçº¿ç¨‹æ“ä½œæ•°æ®åº“å®‰å…¨ï¼Œ<code class="highlighter-rouge">FMDB</code>ä½¿ç”¨äº†<code class="highlighter-rouge">FMDatabaseQueue</code>ï¼Œä½¿ç”¨<code class="highlighter-rouge">FMDatabaseQueue</code>å¾ˆç®€å•ï¼Œé¦–å…ˆç”¨ä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶åœ°å€æ¥åˆä½¿åŒ–<code class="highlighter-rouge">FMDatabaseQueue</code>ï¼Œç„¶åå°±å¯ä»¥å°†ä¸€ä¸ª<code class="highlighter-rouge">é—­åŒ…(block)</code>ä¼ å…¥<code class="highlighter-rouge">inDatabase</code>æ–¹æ³•ä¸­ã€‚ åœ¨é—­åŒ…ä¸­æ“ä½œæ•°æ®åº“ï¼Œè€Œä¸ç›´æ¥å‚ä¸<code class="highlighter-rouge">FMDatabase</code>çš„ç®¡ç†ã€‚</p>
<div class="language-obj-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">FMDatabaseQueue</span><span class="o">*</span> <span class="n">queue</span> <span class="o">=</span> <span class="p">[</span><span class="n">FMDatabaseQueue</span> <span class="nf">databaseQueueWithPath</span><span class="p">:</span><span class="n">database_path</span><span class="p">];</span> 
<span class="n">dispatch_queue_t</span> <span class="n">q1</span> <span class="o">=</span> <span class="n">dispatch_queue_create</span><span class="p">(</span> <span class="s">"queue1"</span> <span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span> 
<span class="n">dispatch_queue_t</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">dispatch_queue_create</span><span class="p">(</span> <span class="s">"queue2"</span> <span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span> 
<span class="n">dispatch_async</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="o">^</span><span class="p">{</span> 
	<span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span> 
		<span class="p">[</span><span class="n">queue</span> <span class="nf">inDatabase</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">FMDatabase</span> <span class="o">*</span><span class="n">db2</span><span class="p">)</span> <span class="p">{</span> 
			<span class="n">NSString</span> <span class="o">*</span><span class="n">insertSql1</span><span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="err">@</span> <span class="s">"INSERT INTO '%@' ('%@', '%@', '%@') VALUES (?, ?, ?)"</span> <span class="p">,</span><span class="n">TABLENAME</span><span class="p">,</span> <span class="n">NAME</span><span class="p">,</span><span class="n">AGE</span><span class="p">,</span> <span class="n">ADDRESS</span><span class="p">];</span> 
			<span class="n">NSString</span> <span class="o">*</span> <span class="n">name</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="err">@</span> <span class="s">"jack %d"</span> <span class="p">,</span> <span class="n">i</span><span class="p">];</span> 
			<span class="n">NSString</span> <span class="o">*</span> <span class="n">age</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="err">@</span> <span class="s">"%d"</span> <span class="p">,</span> <span class="mi">10</span><span class="o">+</span><span class="n">i</span><span class="p">];</span> 
			<span class="n">BOOL</span> <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">db2</span> <span class="nf">executeUpdate</span><span class="p">:</span><span class="n">insertSql1</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span><span class="err">@</span> <span class="s">"æµå—"</span> <span class="p">];</span> 
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">res</span><span class="p">)</span> <span class="p">{</span> 
				<span class="n">NSLog</span><span class="p">(</span><span class="err">@</span> <span class="s">"error to inster data: %@"</span> <span class="p">,</span> <span class="n">name</span><span class="p">);</span> 
				<span class="p">}</span>  <span class="k">else</span> <span class="p">{</span> 
				<span class="n">NSLog</span><span class="p">(</span><span class="err">@</span> <span class="s">"succ to inster data: %@"</span> <span class="p">,</span> <span class="n">name</span><span class="p">);</span> 
				<span class="p">}</span> 
		<span class="p">}];</span> 
	<span class="p">}</span> 
<span class="p">});</span> 
<span class="n">dispatch_async</span><span class="p">(</span><span class="n">q2</span><span class="p">,</span> <span class="o">^</span><span class="p">{</span> 
	<span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span> 
		<span class="p">[</span><span class="n">queue</span> <span class="nf">inDatabase</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">FMDatabase</span> <span class="o">*</span><span class="n">db2</span><span class="p">)</span> <span class="p">{</span> 
			<span class="n">NSString</span> <span class="o">*</span><span class="n">insertSql2</span><span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="err">@</span> <span class="s">"INSERT INTO '%@' ('%@', '%@', '%@') VALUES (?, ?, ?)"</span> <span class="p">,</span><span class="n">TABLENAME</span><span class="p">,</span> <span class="n">NAME</span><span class="p">,</span> <span class="n">AGE</span><span class="p">,</span> <span class="n">ADDRESS</span><span class="p">];</span> 
			<span class="n">NSString</span> <span class="o">*</span> <span class="n">name</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="err">@</span> <span class="s">"lilei %d"</span> <span class="p">,</span> <span class="n">i</span><span class="p">];</span> 
			<span class="n">NSString</span> <span class="o">*</span> <span class="n">age</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSString</span> <span class="nf">stringWithFormat</span><span class="p">:</span><span class="err">@</span> <span class="s">"%d"</span> <span class="p">,</span> <span class="mi">10</span><span class="o">+</span><span class="n">i</span><span class="p">];</span> 
			<span class="n">BOOL</span> <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">db2</span> <span class="nf">executeUpdate</span><span class="p">:</span><span class="n">insertSql2</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span><span class="err">@</span> <span class="s">"åŒ—äº¬"</span> <span class="p">];</span> 
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">res</span><span class="p">)</span> <span class="p">{</span> 
				<span class="n">NSLog</span><span class="p">(</span><span class="err">@</span> <span class="s">"error to inster data: %@"</span> <span class="p">,</span> <span class="n">name</span><span class="p">);</span> 
			<span class="p">}</span>  <span class="k">else</span> <span class="p">{</span> 
				<span class="n">NSLog</span><span class="p">(</span><span class="err">@</span> <span class="s">"succ to inster data: %@"</span> <span class="p">,</span> <span class="n">name</span><span class="p">);</span> 
			<span class="p">}</span>
		<span class="p">}];</span> 
	<span class="p">}</span> 
<span class="p">});</span> 
</code></pre></div></div>
<h4 id="æ€»ç»“">æ€»ç»“</h4>

<p><code class="highlighter-rouge">CoreData</code>å…è®¸ç”¨æˆ·ä½¿ç”¨ä»£è¡¨å®ä½“å’Œå®ä½“é—´å…³ç³»çš„é«˜å±‚å¯¹è±¡æ¥æ“ä½œæ•°æ®ã€‚å®ƒä¹Ÿå¯ä»¥ç®¡ç†ä¸²è¡ŒåŒ–çš„æ•°æ®ï¼Œæä¾›å¯¹è±¡ç”Ÿå­˜æœŸç®¡ç†ä¸<code class="highlighter-rouge">object_graph</code> ç®¡ç†ï¼ŒåŒ…æ‹¬å­˜å‚¨ã€‚<code class="highlighter-rouge">Core Data</code>ç›´æ¥ä¸ <code class="highlighter-rouge">SQLite</code> äº¤äº’ï¼Œé¿å…å¼€å‘è€…ä½¿ç”¨åŸæœ¬çš„ <code class="highlighter-rouge">SQL</code> è¯­å¥.
ä¸Šé¢çš„ä¸‰ç§ï¼Œéƒ½æ˜¯åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨å‘¢ï¼Ÿå¤§å¤šæ•°äººè‚¯å®šæ˜¯æ ¹æ®è‡ªå·±ä½¿ç”¨æŸé¡¹æŠ€æœ¯çš„æ—¶é—´ä¹Ÿå°±æ˜¯æŒæ¡çš„ç†Ÿç»ƒç¨‹åº¦æ¥å†³å®šï¼Œä¾‹å¦‚ä»¥å‰æ²¡ç”¨è¿‡<code class="highlighter-rouge">CoreData</code>ï¼Œåœ¨ç¼–å†™<code class="highlighter-rouge">iOS</code>ç¨‹åºçš„æ—¶å€™è¿˜æ˜¯ä½¿ç”¨è‡ªå·±æ¯”è¾ƒæ‹¿æ‰‹çš„<code class="highlighter-rouge">SQLite</code>ï¼Œæˆ–è€…å¯èƒ½ä¼šè€ƒè™‘åˆ°åœ¨ä½¿ç”¨<code class="highlighter-rouge">coredata</code>è‡ªå·±è¿˜è¦èŠ±è´¹é¢å¤–çš„æ—¶å€™å»å­¦ä¹ ã€‚ä½†æ˜¯ä»”ç»†æƒ³ä¸€æƒ³ï¼Œ<code class="highlighter-rouge">CoreData</code>æ˜¯è‹¹æœè‡ªå·±å¼„çš„æ¡†æ¶ï¼Œå®ƒå…¶å®è¿˜æ˜¯å’Œ<code class="highlighter-rouge">SQLite</code>è¿›è¡Œäº¤äº’çš„ï¼Œåªæ˜¯åœ¨äº¤äº’çš„æ—¶å€™æˆ–è€…å¤„ç†æ•°æ®çš„æ—¶å€™è¿›è¡Œäº†å¾ˆå¤šçš„ä¼˜åŒ–ï¼Œ<code class="highlighter-rouge">CoreData</code>å¯ä»¥ç¼©å°ä½ çš„ä»£ç é‡ï¼Œè€Œä¸”<code class="highlighter-rouge">CoreData</code>å·²ç»ä¼˜åŒ–è¿‡å¾ˆå¤šä¸ªç‰ˆæœ¬ï¼Œè¿˜æä¾›äº†å‡ºè‰²çš„å®‰å…¨æ€§å’Œé”™è¯¯å¤„ç†ä¹‹å¤–ï¼Œè¿˜æä¾›äº†å¯¹ä»»ä½•ç«äº‰æ€§æ–¹æ¡ˆçš„æœ€å¥½çš„å†…å­˜å¯æ‰©å±•æ€§ã€‚æ¢å¥è¯è¯´å°±æ˜¯ï¼Œä½ å¯èƒ½èŠ±è´¹äº†å¾ˆé•¿æ—¶é—´ä¸ºæŸä¸ªé—®é¢˜è¿›è¡Œä¼˜åŒ–ç²¾å¿ƒåˆ¶ä½œäº†ä¸€ä¸ªæ–¹æ¡ˆï¼Œä½†æ˜¯åœ¨æ€§èƒ½ä¸Šçš„ä¼˜åŠ¿å’Œ<code class="highlighter-rouge">CoreData</code>ç›¸æ¯”ï¼Œè¿˜æ˜¯ç›¸å·®æ·±è¿œçš„ã€‚
å¦å¤–å°±æ˜¯<code class="highlighter-rouge">CoreData</code>ä¸<code class="highlighter-rouge">Mac OS X</code>çš„é›†æˆéå¸¸çš„å¥½ï¼Œ<code class="highlighter-rouge">CoreData</code>ä¹Ÿå’Œ<code class="highlighter-rouge">IB</code>è¿›è¡Œäº†ç»“åˆï¼Œå…è®¸ä½ åˆ›å»ºç”¨æˆ·ç•Œé¢ï¼Œè¿™æ ·å¯ä»¥å¸®åŠ©ä½ ç¼©çŸ­åº”ç”¨ç¨‹åºçš„è®¾è®¡ï¼Œå®æ–½ä»¥åŠè°ƒè¯•å‘¨æœŸã€‚æ‰€ä»¥åœ¨ç¼–å†™ç¨‹åºçš„æ—¶å€™å°½é‡ä½¿ç”¨<code class="highlighter-rouge">CoreData</code>ï¼Œè¿™æ ·æ‰æ˜¯æœ€ä¼˜çš„é€‰æ‹©ã€‚åªæœ‰åœ¨<code class="highlighter-rouge">Core Data is available on iOS 3.0 and later</code>æ‰èƒ½ä½¿ç”¨<code class="highlighter-rouge">CoreData</code>ã€‚
è‡³äº<code class="highlighter-rouge">SQLite</code>å’Œ<code class="highlighter-rouge">FMDB</code>çš„ä½¿ç”¨æƒ…å†µï¼Œè¿™ä¸ªçœ‹ä¸ªäººå–œå¥½äº†ï¼Œä¸ªäººè§‰å¾—æ²¡ä»€ä¹ˆæ ‡å‡†ã€‚<code class="highlighter-rouge">FMDB</code>å°±æ˜¯å¯¹<code class="highlighter-rouge">SQLite</code>çš„å°è£…ï¼Œä½¿ç”¨èµ·æ¥æœ‰æ–¹ä¾¿çš„æ¥å£ï¼Œæ²¡é‚£ä¹ˆéº»çƒ¦è€Œå·²ã€‚</p>

:ET